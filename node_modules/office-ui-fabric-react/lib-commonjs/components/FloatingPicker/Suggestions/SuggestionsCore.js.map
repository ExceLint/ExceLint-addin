{"version":3,"file":"SuggestionsCore.js","sourceRoot":"../src/","sources":["components/FloatingPicker/Suggestions/SuggestionsCore.tsx"],"names":[],"mappings":"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","sourcesContent":["import * as React from 'react';\r\nimport { BaseComponent, css, autobind } from '../../../Utilities';\r\nimport { ISuggestionItemProps, SuggestionsItem, ISuggestionModel } from '../../../Pickers';\r\nimport { ISuggestionsCoreProps } from './Suggestions.types';\r\nimport * as stylesImport from './SuggestionsCore.scss';\r\n// tslint:disable-next-line:no-any\r\nconst styles: any = stylesImport;\r\n\r\n/**\r\n * Class when used with SuggestionsStore, renders a basic suggestions control\r\n */\r\nexport class SuggestionsCore<T> extends BaseComponent<ISuggestionsCoreProps<T>, {}> {\r\n  public currentIndex: number;\r\n  public currentSuggestion: ISuggestionModel<T> | undefined;\r\n  protected _selectedElement: HTMLDivElement;\r\n  private SuggestionsItemOfProperType: new (props: ISuggestionItemProps<T>) => SuggestionsItem<T> = SuggestionsItem;\r\n\r\n  constructor(suggestionsProps: ISuggestionsCoreProps<T>) {\r\n    super(suggestionsProps);\r\n    this.currentIndex = -1;\r\n  }\r\n\r\n  /**\r\n   * Increments the selected suggestion index\r\n   */\r\n  public nextSuggestion(): boolean {\r\n    const { suggestions } = this.props;\r\n\r\n    if (suggestions && suggestions.length > 0) {\r\n      if (this.currentIndex === -1) {\r\n        this.setSelectedSuggestion(0);\r\n        return true;\r\n      } else if (this.currentIndex < suggestions.length - 1) {\r\n        this.setSelectedSuggestion(this.currentIndex + 1);\r\n        return true;\r\n      } else if (this.props.shouldLoopSelection && this.currentIndex === suggestions.length - 1) {\r\n        this.setSelectedSuggestion(0);\r\n        return true;\r\n      }\r\n    }\r\n\r\n    return false;\r\n  }\r\n\r\n  /**\r\n   * Decrements the selected suggestion index\r\n   */\r\n  public previousSuggestion(): boolean {\r\n    const { suggestions } = this.props;\r\n\r\n    if (suggestions && suggestions.length > 0) {\r\n      if (this.currentIndex === -1) {\r\n        this.setSelectedSuggestion(suggestions.length - 1);\r\n        return true;\r\n      } else if (this.currentIndex > 0) {\r\n        this.setSelectedSuggestion(this.currentIndex - 1);\r\n        return true;\r\n      } else if (this.props.shouldLoopSelection && this.currentIndex === 0) {\r\n        this.setSelectedSuggestion(suggestions.length - 1);\r\n        return true;\r\n      }\r\n    }\r\n\r\n    return false;\r\n  }\r\n\r\n  public get selectedElement(): HTMLDivElement | undefined {\r\n    return this._selectedElement;\r\n  }\r\n\r\n  public getCurrentItem(): ISuggestionModel<T> {\r\n    return this.props.suggestions[this.currentIndex];\r\n  }\r\n\r\n  public getSuggestionAtIndex(index: number): ISuggestionModel<T> {\r\n    return this.props.suggestions[index];\r\n  }\r\n\r\n  public hasSuggestionSelected(): boolean {\r\n    return this.currentIndex !== -1 && this.currentIndex < this.props.suggestions.length;\r\n  }\r\n\r\n  public removeSuggestion(index: number): void {\r\n    this.props.suggestions.splice(index, 1);\r\n  }\r\n\r\n  public deselectAllSuggestions(): void {\r\n    if (this.currentIndex > -1 && this.props.suggestions[this.currentIndex]) {\r\n      this.props.suggestions[this.currentIndex].selected = false;\r\n      this.currentIndex = -1;\r\n      this.forceUpdate();\r\n    }\r\n  }\r\n\r\n  public setSelectedSuggestion(index: number): void {\r\n    const { suggestions } = this.props;\r\n\r\n    if (index > suggestions.length - 1 || index < 0) {\r\n      this.currentIndex = 0;\r\n      this.currentSuggestion!.selected = false;\r\n      this.currentSuggestion = suggestions[0];\r\n      this.currentSuggestion.selected = true;\r\n    } else {\r\n      if (this.currentIndex > -1 && suggestions[this.currentIndex]) {\r\n        suggestions[this.currentIndex].selected = false;\r\n      }\r\n      suggestions[index].selected = true;\r\n      this.currentIndex = index;\r\n      this.currentSuggestion = suggestions[index];\r\n    }\r\n\r\n    this.forceUpdate();\r\n  }\r\n\r\n  public componentDidUpdate(): void {\r\n    this.scrollSelected();\r\n  }\r\n\r\n  public render(): JSX.Element {\r\n    const {\r\n      onRenderSuggestion,\r\n      suggestionsItemClassName,\r\n      resultsMaximumNumber,\r\n      showRemoveButtons,\r\n      suggestionsContainerAriaLabel\r\n    } = this.props;\r\n    const TypedSuggestionsItem = this.SuggestionsItemOfProperType;\r\n    let { suggestions } = this.props;\r\n\r\n    if (resultsMaximumNumber) {\r\n      suggestions = suggestions.slice(0, resultsMaximumNumber);\r\n    }\r\n\r\n    return (\r\n      <div\r\n        className={css('ms-Suggestions-container', styles.suggestionsContainer)}\r\n        id=\"suggestion-list\"\r\n        role=\"list\"\r\n        aria-label={suggestionsContainerAriaLabel}\r\n      >\r\n        {suggestions.map((suggestion: ISuggestionModel<T>, index: number) => (\r\n          <div\r\n            ref={this._resolveRef(suggestion.selected || index === this.currentIndex ? '_selectedElement' : '')}\r\n            // tslint:disable\r\n            key={(suggestion.item as any)['key'] ? (suggestion.item as any)['key'] : index}\r\n            // tslint:enable\r\n            id={'sug-' + index}\r\n            role=\"listitem\"\r\n            aria-label={suggestion.ariaLabel}\r\n          >\r\n            <TypedSuggestionsItem\r\n              id={'sug-item' + index}\r\n              suggestionModel={suggestion}\r\n              // tslint:disable-next-line:no-any\r\n              RenderSuggestion={onRenderSuggestion as any}\r\n              onClick={this._onClickTypedSuggestionsItem(suggestion.item, index)}\r\n              className={suggestionsItemClassName}\r\n              showRemoveButton={showRemoveButtons}\r\n              onRemoveItem={this._onRemoveTypedSuggestionsItem(suggestion.item, index)}\r\n              isSelectedOverride={index === this.currentIndex}\r\n            />\r\n          </div>\r\n        ))}\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // TODO get the element to scroll into view properly regardless of direction.\r\n  public scrollSelected(): void {\r\n    if (this._selectedElement && this._selectedElement.scrollIntoView !== undefined) {\r\n      this._selectedElement.scrollIntoView(false);\r\n    }\r\n  }\r\n\r\n  @autobind\r\n  private _onClickTypedSuggestionsItem(item: T, index: number): (ev: React.MouseEvent<HTMLElement>) => void {\r\n    return (ev: React.MouseEvent<HTMLElement>): void => {\r\n      this.props.onSuggestionClick(ev, item, index);\r\n    };\r\n  }\r\n\r\n  @autobind\r\n  private _onRemoveTypedSuggestionsItem(item: T, index: number): (ev: React.MouseEvent<HTMLElement>) => void {\r\n    return (ev: React.MouseEvent<HTMLElement>): void => {\r\n      const onSuggestionRemove = this.props.onSuggestionRemove!;\r\n      onSuggestionRemove(ev, item, index);\r\n      ev.stopPropagation();\r\n    };\r\n  }\r\n}\r\n"]}