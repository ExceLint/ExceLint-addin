{"version":3,"file":"ChoiceGroup.base.js","sourceRoot":"../src/","sources":["components/ChoiceGroup/ChoiceGroup.base.tsx"],"names":[],"mappings":";;;AAAA,6BAA+B;AAE/B,qCAAoC;AACpC,6CAUyB;AAQzB,mDAAuF;AAEvF,IAAM,aAAa,GAAG,8BAAkB,EAA8C,CAAC;AAiBvF;;GAEG;AACH;IAAqC,2CAAqD;IAMxF,yBAAY,KAAwB;QAApC,YACE,kBAAM,KAAK,CAAC,SAuBb;QA3BO,qBAAe,GAA0D,EAAE,CAAC;QAC5E,sBAAgB,GAAyD,EAAE,CAAC;QAyI5E,aAAO,GAAG,UAAC,EAAiC,EAAE,MAA0B;YAC9E,KAAI,CAAC,QAAQ,CAAC;gBACZ,UAAU,EAAE,SAAS;aACtB,CAAC,CAAC;QACL,CAAC,CAAC;QAxIA,kCAAsB,CAAC,KAAI,CAAC,CAAC;QAE7B,IAAI,OAAO,CAAC,GAAG,CAAC,QAAQ,KAAK,YAAY,EAAE;YACzC,4BAAgB,CAAC,aAAa,EAAE,KAAK,EAAE,EAAE,SAAS,EAAE,UAAU,EAAE,CAAC,CAAC;YAClE,iCAAqB,CAAC,aAAa,EAAE,KAAK,EAAE;gBAC1C,WAAW,EAAE,oBAAoB;aAClC,CAAC,CAAC;SACJ;QAEO,IAAA,6CAAkB,EAAE,kBAAY,EAAZ,iCAAY,CAAW;QACnD,IAAM,uBAAuB,GAC3B,CAAC,aAAa,CAAC,KAAK,CAAC;YACrB,kBAAkB,KAAK,SAAS;YAChC,OAAO,CAAC,IAAI,CAAC,UAAA,MAAM,IAAI,OAAA,MAAM,CAAC,GAAG,KAAK,kBAAkB,EAAjC,CAAiC,CAAC,CAAC;QAE5D,KAAI,CAAC,KAAK,GAAG;YACX,UAAU,EAAE,uBAAuB,CAAC,CAAC,CAAC,kBAAkB,CAAC,CAAC,CAAC,KAAI,CAAC,cAAc,CAAC,KAAK,CAAC;SACtF,CAAC;QAEF,KAAI,CAAC,GAAG,GAAG,iBAAK,CAAC,aAAa,CAAC,CAAC;QAChC,KAAI,CAAC,QAAQ,GAAG,iBAAK,CAAC,kBAAkB,CAAC,CAAC;;IAC5C,CAAC;IAKD,sBAAW,0CAAa;QAHxB;;WAEG;aACH;YAAA,iBAGC;YAFS,IAAA,uBAAY,EAAZ,iCAAY,CAAgB;YACpC,OAAO,gBAAI,CAAC,OAAO,EAAE,UAAC,KAAyB,IAAK,OAAA,KAAK,CAAC,GAAG,KAAK,KAAI,CAAC,KAAK,CAAC,UAAU,EAAnC,CAAmC,CAAC,CAAC;QAC3F,CAAC;;;OAAA;IAEM,4CAAkB,GAAzB,UAA0B,SAA4B,EAAE,SAA4B;QAClF,wFAAwF;QACxF,IAAI,SAAS,KAAK,IAAI,CAAC,KAAK,EAAE;YAC5B,IAAM,aAAa,GAAG,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;YACtD,IAAM,aAAa,GAAG,IAAI,CAAC,cAAc,CAAC,SAAS,CAAC,CAAC;YAErD,IAAI,aAAa,KAAK,aAAa,EAAE;gBACnC,IAAI,CAAC,QAAQ,CAAC;oBACZ,UAAU,EAAE,aAAa;iBAC1B,CAAC,CAAC;aACJ;SACF;IACH,CAAC;IAEM,gCAAM,GAAb;QAAA,iBA6DC;QA5DO,IAAA,eAAwF,EAAtF,wBAAS,EAAE,gBAAK,EAAE,kBAAM,EAAE,eAAY,EAAZ,iCAAY,EAAE,gBAAK,EAAE,sBAAQ,EAAE,sBAAQ,EAAE,cAAmB,CAAC;QACzF,IAAA,eAAuC,EAArC,0BAAU,EAAE,0BAAyB,CAAC;QAE9C,IAAM,QAAQ,GAAG,0BAAc,CAAuC,IAAI,CAAC,KAAK,EAAE,yBAAa,EAAE;YAC/F,UAAU;YACV,WAAW;YACX,UAAU;SACX,CAAC,CAAC;QAEH,IAAM,UAAU,GAAG,aAAa,CAAC,MAAO,EAAE;YACxC,KAAK,EAAE,KAAM;YACb,SAAS,WAAA;YACT,yBAAyB,EAAE,OAAO,CAAC,IAAI,CAAC,UAAA,MAAM,IAAI,OAAA,CAAC,CAAC,CAAC,MAAM,CAAC,SAAS,IAAI,MAAM,CAAC,QAAQ,CAAC,EAAvC,CAAuC,CAAC;SAC3F,CAAC,CAAC;QAEH,IAAM,OAAO,GAAG,IAAI,CAAC,GAAG,GAAG,QAAQ,CAAC;QACpC,IAAM,cAAc,GAAG,IAAI,CAAC,KAAK,CAAC,cAAc,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,iBAAiB,CAAC,CAAC,CAAC;QAEtG,qFAAqF;QACrF,kFAAkF;QAClF,OAAO;QACL,mDAAmD;QACnD,8CAAK,SAAS,EAAE,UAAU,CAAC,eAAe,IAAM,QAAQ;YACtD,8CACE,SAAS,EAAE,UAAU,CAAC,IAAI,EAC1B,IAAI,EAAC,YAAY,IACb,CAAC,cAAc,IAAI,EAAE,iBAAiB,EAAE,cAAc,EAAE,CAAC;gBAE5D,KAAK,IAAI,CACR,oBAAC,aAAK,IAAC,SAAS,EAAE,UAAU,CAAC,KAAK,EAAE,QAAQ,EAAE,QAAQ,EAAE,EAAE,EAAE,OAAO,EAAE,QAAQ,EAAE,QAAQ,IACpF,KAAK,CACA,CACT;gBACD,6BAAK,SAAS,EAAE,UAAU,CAAC,aAAa,IACrC,OAAO,CAAC,GAAG,CAAC,UAAC,MAA0B;oBACtC,IAAM,gBAAgB,yCACjB,MAAM,KACT,OAAO,EAAE,MAAM,CAAC,GAAG,KAAK,UAAU,EAClC,OAAO,EAAE,MAAM,CAAC,GAAG,KAAK,UAAU,EAClC,QAAQ,EAAE,MAAM,CAAC,QAAQ,IAAI,QAAQ,EACrC,EAAE,EAAE,KAAI,CAAC,YAAY,CAAC,MAAM,CAAC,EAC7B,OAAO,EAAE,KAAI,CAAC,iBAAiB,CAAC,MAAM,CAAC,EACvC,IAAI,EAAE,IAAI,IAAI,KAAI,CAAC,GAAG,EACtB,QAAQ,UAAA,GACT,CAAC;oBAEF,OAAO,CACL,oBAAC,yBAAiB,qBAChB,GAAG,EAAE,MAAM,CAAC,GAAG,EACf,MAAM,EAAE,KAAI,CAAC,OAAO,EACpB,OAAO,EAAE,KAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,GAAG,CAAC,EAClC,QAAQ,EAAE,KAAI,CAAC,SAAS,CAAC,MAAM,CAAC,GAAG,CAAC,IAChC,gBAAgB,EACpB,CACH,CAAC;gBACJ,CAAC,CAAC,CACE,CACF,CACF,CACP,CAAC;IACJ,CAAC;IAEM,+BAAK,GAAZ;QACU,IAAA,uBAAY,EAAZ,iCAAY,CAAgB;QACpC,IAAM,aAAa,GAAG,IAAI,CAAC,aAAa,IAAI,OAAO,CAAC,MAAM,CAAC,UAAA,MAAM,IAAI,OAAA,CAAC,MAAM,CAAC,QAAQ,EAAhB,CAAgB,CAAC,CAAC,CAAC,CAAC,CAAC;QAC1F,IAAM,cAAc,GAAG,aAAa,IAAI,QAAQ,CAAC,cAAc,CAAC,IAAI,CAAC,YAAY,CAAC,aAAa,CAAC,CAAC,CAAC;QAClG,IAAI,cAAc,EAAE;YAClB,cAAc,CAAC,KAAK,EAAE,CAAC;SACxB;IACH,CAAC;IAEO,kCAAQ,GAAhB,UAAiB,GAAW;QAA5B,iBAaC;QAZC,oGAAoG;QACpG,IAAI,CAAC,IAAI,CAAC,eAAe,CAAC,GAAG,CAAC,EAAE;YAC9B,IAAI,CAAC,eAAe,CAAC,GAAG,CAAC,GAAG,UAC1B,EAAoD,EACpD,MAA0B;gBAE1B,KAAI,CAAC,QAAQ,CAAC;oBACZ,UAAU,EAAE,GAAG;iBAChB,CAAC,CAAC;YACL,CAAC,CAAC;SACH;QACD,OAAO,IAAI,CAAC,eAAe,CAAC,GAAG,CAAC,CAAC;IACnC,CAAC;IAQO,mCAAS,GAAjB,UAAkB,GAAW;QAA7B,iBA6BC;QA5BC,oGAAoG;QACpG,IAAI,CAAC,IAAI,CAAC,gBAAgB,CAAC,GAAG,CAAC,EAAE;YAC/B,IAAI,CAAC,gBAAgB,CAAC,GAAG,CAAC,GAAG,UAC3B,GAAoD,EACpD,MAA0B;gBAE1B,mDAAmD;gBAC7C,IAAA,gBAAoC,EAAlC,wBAAS,EAAE,sBAAuB,CAAC;gBAE3C,+CAA+C;gBAC/C,IAAI,CAAC,aAAa,CAAC,KAAI,CAAC,KAAK,CAAC,EAAE;oBAC9B,KAAI,CAAC,QAAQ,CAAC;wBACZ,UAAU,EAAE,GAAG;qBAChB,CAAC,CAAC;iBACJ;gBAED,yDAAyD;gBACzD,IAAM,cAAc,GAAG,gBAAI,CAAC,KAAI,CAAC,KAAK,CAAC,OAAO,IAAI,EAAE,EAAE,UAAC,KAAyB,IAAK,OAAA,KAAK,CAAC,GAAG,KAAK,GAAG,EAAjB,CAAiB,CAAC,CAAC;gBAExG,+FAA+F;gBAC/F,IAAI,QAAQ,EAAE;oBACZ,QAAQ,CAAC,GAAG,EAAE,cAAc,CAAC,CAAC;iBAC/B;qBAAM,IAAI,SAAS,EAAE;oBACpB,SAAS,CAAC,cAAe,EAAE,GAAG,CAAC,CAAC;iBACjC;YACH,CAAC,CAAC;SACH;QACD,OAAO,IAAI,CAAC,gBAAgB,CAAC,GAAG,CAAC,CAAC;IACpC,CAAC;IAED;;OAEG;IACK,wCAAc,GAAtB,UAAuB,KAAwB;QAC7C,IAAI,KAAK,CAAC,WAAW,KAAK,SAAS,EAAE;YACnC,OAAO,KAAK,CAAC,WAAW,CAAC;SAC1B;QAEO,IAAA,kBAAY,EAAZ,iCAAY,CAAW;QAC/B,mDAAmD;QACnD,IAAM,cAAc,GAAG,OAAO,CAAC,MAAM,CAAC,UAAC,MAA0B,IAAK,OAAA,MAAM,CAAC,OAAO,EAAd,CAAc,CAAC,CAAC;QACtF,OAAO,cAAc,CAAC,CAAC,CAAC,IAAI,cAAc,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC;IACpD,CAAC;IAEO,sCAAY,GAApB,UAAqB,MAA0B;QAC7C,OAAO,MAAM,CAAC,EAAE,IAAO,IAAI,CAAC,GAAG,SAAI,MAAM,CAAC,GAAK,CAAC;IAClD,CAAC;IAEO,2CAAiB,GAAzB,UAA0B,MAA0B;QAClD,OAAO,MAAM,CAAC,OAAO,IAAO,IAAI,CAAC,QAAQ,SAAI,MAAM,CAAC,GAAK,CAAC;IAC5D,CAAC;IACH,sBAAC;AAAD,CAAC,AAvMD,CAAqC,KAAK,CAAC,SAAS,GAuMnD;AAvMY,0CAAe;AAyM5B,SAAS,aAAa,CAAC,KAAwB;IAC7C,OAAO,wBAAY,CAAC,KAAK,EAAE,aAAa,CAAC,CAAC;AAC5C,CAAC","sourcesContent":["import * as React from 'react';\n\nimport { Label } from '../../Label';\nimport {\n  initializeComponentRef,\n  warnDeprecations,\n  warnMutuallyExclusive,\n  classNamesFunction,\n  find,\n  getId,\n  isControlled,\n  getNativeProps,\n  divProperties,\n} from '../../Utilities';\nimport {\n  IChoiceGroup,\n  IChoiceGroupOption,\n  IChoiceGroupProps,\n  IChoiceGroupStyleProps,\n  IChoiceGroupStyles,\n} from './ChoiceGroup.types';\nimport { ChoiceGroupOption, IChoiceGroupOptionProps } from './ChoiceGroupOption/index';\n\nconst getClassNames = classNamesFunction<IChoiceGroupStyleProps, IChoiceGroupStyles>();\n\nexport interface IChoiceGroupState {\n  /**\n   * Current selected option, for **internal use only**.\n   * External users should access `IChoiceGroup.checkedOption` instead.\n   */\n  // TODO (Fabric 8?) - once we removed the checked property from individual options,\n  // we can probably store only the uncontrolled value in the state (right now it tracks\n  // the value regardless of controlled/uncontrolled--though if controlled, it only updates\n  // the value in state when the selectedKey prop updates)\n  keyChecked?: string | number;\n\n  /** Is set when the control has focus. */\n  keyFocused?: string | number;\n}\n\n/**\n * {@docCategory ChoiceGroup}\n */\nexport class ChoiceGroupBase extends React.Component<IChoiceGroupProps, IChoiceGroupState> implements IChoiceGroup {\n  private _id: string;\n  private _labelId: string;\n  private _focusCallbacks: { [key: string]: IChoiceGroupOptionProps['onFocus'] } = {};\n  private _changeCallbacks: { [key: string]: IChoiceGroupOptionProps['onBlur'] } = {};\n\n  constructor(props: IChoiceGroupProps) {\n    super(props);\n\n    initializeComponentRef(this);\n\n    if (process.env.NODE_ENV !== 'production') {\n      warnDeprecations('ChoiceGroup', props, { onChanged: 'onChange' });\n      warnMutuallyExclusive('ChoiceGroup', props, {\n        selectedKey: 'defaultSelectedKey',\n      });\n    }\n\n    const { defaultSelectedKey, options = [] } = props;\n    const validDefaultSelectedKey =\n      !_isControlled(props) &&\n      defaultSelectedKey !== undefined &&\n      options.some(option => option.key === defaultSelectedKey);\n\n    this.state = {\n      keyChecked: validDefaultSelectedKey ? defaultSelectedKey : this._getKeyChecked(props),\n    };\n\n    this._id = getId('ChoiceGroup');\n    this._labelId = getId('ChoiceGroupLabel');\n  }\n\n  /**\n   * Gets the current checked option.\n   */\n  public get checkedOption(): IChoiceGroupOption | undefined {\n    const { options = [] } = this.props;\n    return find(options, (value: IChoiceGroupOption) => value.key === this.state.keyChecked);\n  }\n\n  public componentDidUpdate(prevProps: IChoiceGroupProps, prevState: IChoiceGroupState): void {\n    // Only update if a new props object has been passed in (don't care about state updates)\n    if (prevProps !== this.props) {\n      const newKeyChecked = this._getKeyChecked(this.props);\n      const oldKeyChecked = this._getKeyChecked(prevProps);\n\n      if (newKeyChecked !== oldKeyChecked) {\n        this.setState({\n          keyChecked: newKeyChecked,\n        });\n      }\n    }\n  }\n\n  public render(): JSX.Element {\n    const { className, theme, styles, options = [], label, required, disabled, name } = this.props;\n    const { keyChecked, keyFocused } = this.state;\n\n    const divProps = getNativeProps<React.HTMLAttributes<HTMLDivElement>>(this.props, divProperties, [\n      'onChange',\n      'className',\n      'required',\n    ]);\n\n    const classNames = getClassNames(styles!, {\n      theme: theme!,\n      className,\n      optionsContainIconOrImage: options.some(option => !!(option.iconProps || option.imageSrc)),\n    });\n\n    const labelId = this._id + '-label';\n    const ariaLabelledBy = this.props.ariaLabelledBy || (label ? labelId : this.props['aria-labelledby']);\n\n    // TODO (Fabric 8?) - if possible, move `root` class to the actual root and eliminate\n    // `applicationRole` class (but the div structure will stay the same by necessity)\n    return (\n      // eslint-disable-next-line deprecation/deprecation\n      <div className={classNames.applicationRole} {...divProps}>\n        <div\n          className={classNames.root}\n          role=\"radiogroup\"\n          {...(ariaLabelledBy && { 'aria-labelledby': ariaLabelledBy })}\n        >\n          {label && (\n            <Label className={classNames.label} required={required} id={labelId} disabled={disabled}>\n              {label}\n            </Label>\n          )}\n          <div className={classNames.flexContainer}>\n            {options.map((option: IChoiceGroupOption) => {\n              const innerOptionProps = {\n                ...option,\n                focused: option.key === keyFocused,\n                checked: option.key === keyChecked,\n                disabled: option.disabled || disabled,\n                id: this._getOptionId(option),\n                labelId: this._getOptionLabelId(option),\n                name: name || this._id,\n                required,\n              };\n\n              return (\n                <ChoiceGroupOption\n                  key={option.key}\n                  onBlur={this._onBlur}\n                  onFocus={this._onFocus(option.key)}\n                  onChange={this._onChange(option.key)}\n                  {...innerOptionProps}\n                />\n              );\n            })}\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  public focus() {\n    const { options = [] } = this.props;\n    const optionToFocus = this.checkedOption || options.filter(option => !option.disabled)[0];\n    const elementToFocus = optionToFocus && document.getElementById(this._getOptionId(optionToFocus));\n    if (elementToFocus) {\n      elementToFocus.focus();\n    }\n  }\n\n  private _onFocus(key: string) {\n    // This extra mess is necessary because React won't pass the `key` prop through to ChoiceGroupOption\n    if (!this._focusCallbacks[key]) {\n      this._focusCallbacks[key] = (\n        ev: React.FocusEvent<HTMLElement | HTMLInputElement>,\n        option: IChoiceGroupOption,\n      ) => {\n        this.setState({\n          keyFocused: key,\n        });\n      };\n    }\n    return this._focusCallbacks[key];\n  }\n\n  private _onBlur = (ev: React.FocusEvent<HTMLElement>, option: IChoiceGroupOption) => {\n    this.setState({\n      keyFocused: undefined,\n    });\n  };\n\n  private _onChange(key: string) {\n    // This extra mess is necessary because React won't pass the `key` prop through to ChoiceGroupOption\n    if (!this._changeCallbacks[key]) {\n      this._changeCallbacks[key] = (\n        evt: React.FormEvent<HTMLElement | HTMLInputElement>,\n        option: IChoiceGroupOption,\n      ) => {\n        // eslint-disable-next-line deprecation/deprecation\n        const { onChanged, onChange } = this.props;\n\n        // Only manage state in uncontrolled scenarios.\n        if (!_isControlled(this.props)) {\n          this.setState({\n            keyChecked: key,\n          });\n        }\n\n        // Get the original option without the `key` prop removed\n        const originalOption = find(this.props.options || [], (value: IChoiceGroupOption) => value.key === key);\n\n        // TODO: onChanged deprecated, remove else if after 07/17/2017 when onChanged has been removed.\n        if (onChange) {\n          onChange(evt, originalOption);\n        } else if (onChanged) {\n          onChanged(originalOption!, evt);\n        }\n      };\n    }\n    return this._changeCallbacks[key];\n  }\n\n  /**\n   * Returns `selectedKey` if provided, or the key of the first option with the `checked` prop set.\n   */\n  private _getKeyChecked(props: IChoiceGroupProps): string | number | undefined {\n    if (props.selectedKey !== undefined) {\n      return props.selectedKey;\n    }\n\n    const { options = [] } = props;\n    // eslint-disable-next-line deprecation/deprecation\n    const optionsChecked = options.filter((option: IChoiceGroupOption) => option.checked);\n    return optionsChecked[0] && optionsChecked[0].key;\n  }\n\n  private _getOptionId(option: IChoiceGroupOption): string {\n    return option.id || `${this._id}-${option.key}`;\n  }\n\n  private _getOptionLabelId(option: IChoiceGroupOption): string {\n    return option.labelId || `${this._labelId}-${option.key}`;\n  }\n}\n\nfunction _isControlled(props: IChoiceGroupProps): boolean {\n  return isControlled(props, 'selectedKey');\n}\n"]}