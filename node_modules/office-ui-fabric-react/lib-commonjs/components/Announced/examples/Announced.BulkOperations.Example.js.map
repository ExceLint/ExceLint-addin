{"version":3,"file":"Announced.BulkOperations.Example.js","sourceRoot":"../src/","sources":["components/Announced/examples/Announced.BulkOperations.Example.tsx"],"names":[],"mappings":"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","sourcesContent":["import * as React from 'react';\r\nimport { Announced } from '../Announced';\r\nimport { Link } from 'office-ui-fabric-react/lib/Link';\r\nimport { DetailsList, Selection } from 'office-ui-fabric-react/lib/DetailsList';\r\nimport { MarqueeSelection } from 'office-ui-fabric-react/lib/MarqueeSelection';\r\nimport { IColumn } from 'office-ui-fabric-react/lib/DetailsList';\r\nimport { Text } from 'office-ui-fabric-react/lib/Text';\r\nimport { IStackTokens, Stack } from 'office-ui-fabric-react/lib/Stack';\r\nimport { IDragDropEvents, IDragDropContext } from 'office-ui-fabric-react/lib/utilities/dragdrop/interfaces';\r\nimport { mergeStyles, getTheme } from 'office-ui-fabric-react/lib/Styling';\r\nimport './Announced.Example.scss';\r\n\r\nconst _items: IFileExampleItem[] = [];\r\n\r\nconst theme = getTheme();\r\nconst dragEnterClass = mergeStyles({\r\n  backgroundColor: theme.palette.neutralLight\r\n});\r\n\r\nconst _columns: IColumn[] = [\r\n  {\r\n    key: 'name',\r\n    name: 'Name',\r\n    fieldName: 'name',\r\n    minWidth: 100,\r\n    maxWidth: 200,\r\n    isResizable: true,\r\n    ariaLabel: 'Operations for name'\r\n  },\r\n  {\r\n    key: 'modified',\r\n    name: 'Modified',\r\n    fieldName: 'modified',\r\n    minWidth: 100,\r\n    maxWidth: 200,\r\n    isResizable: true,\r\n    ariaLabel: 'Operations for modified'\r\n  },\r\n  {\r\n    key: 'modifiedby',\r\n    name: 'Modified By',\r\n    fieldName: 'modifiedby',\r\n    minWidth: 100,\r\n    maxWidth: 200,\r\n    isResizable: true,\r\n    ariaLabel: 'Operations for modifiedby'\r\n  },\r\n  {\r\n    key: 'filesize',\r\n    name: 'File Size',\r\n    fieldName: 'filesize',\r\n    minWidth: 100,\r\n    maxWidth: 200,\r\n    isResizable: true,\r\n    ariaLabel: 'Operations for filesize'\r\n  }\r\n];\r\n\r\nconst _names: string[] = [\r\n  'Annie Lindqvist',\r\n  'Aaron Reid',\r\n  'Alex Lundberg',\r\n  'Roko Kolar',\r\n  'Christian Bergqvist',\r\n  'Valentina Lovric',\r\n  'Makenzie Sharett'\r\n];\r\n\r\nfunction generateRandomDate(): string {\r\n  return new Date(new Date(2010, 0, 1).getTime() + Math.random() * (new Date().getTime() - new Date(2010, 0, 1).getTime())).toDateString();\r\n}\r\n\r\nexport interface IFileExampleItem {\r\n  key: string;\r\n  name: string;\r\n  modified: string;\r\n  modifiedby: string;\r\n  filesize: string;\r\n}\r\n\r\nexport class AnnouncedBulkOperationsExample extends React.Component<\r\n  {},\r\n  {\r\n    items: IFileExampleItem[];\r\n    columns: IColumn[];\r\n    numberOfItems: number;\r\n  }\r\n> {\r\n  private _selection: Selection;\r\n  private _dragDropEvents: IDragDropEvents;\r\n  private _draggedItem: IFileExampleItem | undefined;\r\n  private _draggedIndex: number;\r\n\r\n  constructor(props: {}) {\r\n    super(props);\r\n\r\n    this._selection = new Selection();\r\n    this._dragDropEvents = this._getDragDropEvents();\r\n    this._draggedIndex = -1;\r\n\r\n    this._onRenderItemColumn = this._onRenderItemColumn.bind(this);\r\n    this._renderAnnounced = this._renderAnnounced.bind(this);\r\n\r\n    if (_items.length === 0) {\r\n      for (let i = 0; i < 20; i++) {\r\n        _items.push({\r\n          key: 'item-' + i,\r\n          name: 'Item ' + i,\r\n          modified: generateRandomDate(),\r\n          modifiedby: _names[Math.floor(Math.random() * _names.length)],\r\n          filesize: Math.floor(Math.random() * 30).toString() + ' MB'\r\n        });\r\n      }\r\n    }\r\n\r\n    this.state = {\r\n      items: _items,\r\n      columns: _columns,\r\n      numberOfItems: 0\r\n    };\r\n  }\r\n\r\n  public render(): JSX.Element {\r\n    const { items, columns } = this.state;\r\n    const stackTokens: IStackTokens = { childrenGap: 10 };\r\n\r\n    return (\r\n      <Stack tokens={stackTokens}>\r\n        <Text>Turn on Narrator and drag and drop the items.</Text>\r\n        <Text>\r\n          Note: This example is to showcase the concept of copying, uploading, or moving many items and not fully illustrative of the real\r\n          world scenario.\r\n        </Text>\r\n        {this._renderAnnounced()}\r\n        <MarqueeSelection selection={this._selection}>\r\n          <DetailsList\r\n            setKey={'items'}\r\n            items={items}\r\n            columns={columns}\r\n            selection={this._selection}\r\n            selectionPreservedOnEmptyClick={true}\r\n            onItemInvoked={this._onItemInvoked}\r\n            onRenderItemColumn={this._onRenderItemColumn}\r\n            dragDropEvents={this._dragDropEvents}\r\n            ariaLabelForSelectionColumn=\"Toggle selection\"\r\n            ariaLabelForSelectAllCheckbox=\"Toggle selection for all items\"\r\n          />\r\n        </MarqueeSelection>\r\n      </Stack>\r\n    );\r\n  }\r\n\r\n  private _renderAnnounced(): JSX.Element | undefined {\r\n    const { numberOfItems } = this.state;\r\n\r\n    if (numberOfItems > 0) {\r\n      return <Announced message={numberOfItems === 1 ? `${numberOfItems} item moved` : `${numberOfItems} items moved`} />;\r\n    }\r\n    return;\r\n  }\r\n\r\n  private _getDragDropEvents(): IDragDropEvents {\r\n    return {\r\n      canDrop: (dropContext?: IDragDropContext, dragContext?: IDragDropContext) => {\r\n        return true;\r\n      },\r\n      canDrag: (item?: any) => {\r\n        return true;\r\n      },\r\n      onDragEnter: (item?: any, event?: DragEvent) => {\r\n        // return string is the css classes that will be added to the entering element.\r\n        return dragEnterClass;\r\n      },\r\n      onDragLeave: (item?: any, event?: DragEvent) => {\r\n        return;\r\n      },\r\n      onDrop: (item?: any, event?: DragEvent) => {\r\n        if (this._draggedItem) {\r\n          this._insertBeforeItem(item);\r\n        }\r\n      },\r\n      onDragStart: (item?: any, itemIndex?: number, selectedItems?: any[], event?: MouseEvent) => {\r\n        this._draggedItem = item;\r\n        this._draggedIndex = itemIndex!;\r\n      },\r\n      onDragEnd: (item?: any, event?: DragEvent) => {\r\n        this._draggedItem = undefined;\r\n        this._draggedIndex = -1;\r\n      }\r\n    };\r\n  }\r\n\r\n  private _onItemInvoked(item: any): void {\r\n    alert(`Item invoked: ${item.name}`);\r\n  }\r\n\r\n  private _onRenderItemColumn(item: any, index: number, column: IColumn): JSX.Element {\r\n    if (column.key === 'name') {\r\n      return <Link data-selection-invoke={true}>{item[column.key]}</Link>;\r\n    }\r\n\r\n    return item[column.key];\r\n  }\r\n\r\n  private _insertBeforeItem(item: IFileExampleItem): void {\r\n    const draggedItems = this._selection.isIndexSelected(this._draggedIndex)\r\n      ? (this._selection.getSelection() as IFileExampleItem[])\r\n      : [this._draggedItem!];\r\n\r\n    const items = this.state.items.filter(currentItem => draggedItems.indexOf(currentItem) === -1);\r\n    let insertIndex = items.indexOf(item);\r\n\r\n    // if dragging/dropping on itself, index will be 0.\r\n    if (insertIndex === -1) {\r\n      insertIndex = 0;\r\n    }\r\n\r\n    items.splice(insertIndex, 0, ...draggedItems);\r\n\r\n    this.setState({ items: items, numberOfItems: draggedItems.length });\r\n  }\r\n}\r\n"]}