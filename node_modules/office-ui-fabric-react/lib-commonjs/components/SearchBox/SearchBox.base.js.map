{"version":3,"file":"SearchBox.base.js","sourceRoot":"../src/","sources":["components/SearchBox/SearchBox.base.tsx"],"names":[],"mappings":"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","sourcesContent":["import * as React from 'react';\nimport { ISearchBoxProps, ISearchBoxStyleProps, ISearchBoxStyles } from './SearchBox.types';\nimport {\n  initializeComponentRef,\n  warnDeprecations,\n  getId,\n  KeyCodes,\n  classNamesFunction,\n  getNativeProps,\n  inputProperties,\n} from '../../Utilities';\n\nimport { IconButton } from '../../Button';\nimport { Icon } from '../../Icon';\n\nconst getClassNames = classNamesFunction<ISearchBoxStyleProps, ISearchBoxStyles>();\nconst COMPONENT_NAME = 'SearchBox';\n\nexport interface ISearchBoxState {\n  value?: string;\n  hasFocus?: boolean;\n}\n\nexport class SearchBoxBase extends React.Component<ISearchBoxProps, ISearchBoxState> {\n  public static defaultProps: Pick<ISearchBoxProps, 'disableAnimation' | 'clearButtonProps'> = {\n    disableAnimation: false,\n    clearButtonProps: { ariaLabel: 'Clear text' },\n  };\n\n  private _rootElement = React.createRef<HTMLDivElement>();\n  private _inputElement = React.createRef<HTMLInputElement>();\n  private _latestValue: string;\n  private _fallbackId: string;\n\n  public constructor(props: ISearchBoxProps) {\n    super(props);\n\n    initializeComponentRef(this);\n\n    warnDeprecations(COMPONENT_NAME, props, {\n      labelText: 'placeholder',\n      defaultValue: 'value',\n    });\n\n    this._latestValue = props.value || '';\n    this._fallbackId = getId(COMPONENT_NAME);\n\n    this.state = {\n      value: this._latestValue,\n      hasFocus: false,\n    };\n  }\n\n  public UNSAFE_componentWillReceiveProps(newProps: ISearchBoxProps): void {\n    if (newProps.value !== undefined) {\n      this._latestValue = newProps.value;\n      // If the user passes in null, substitute an empty string\n      // (passing null is not allowed per typings, but users might do it anyway)\n      this.setState({\n        value: newProps.value || '',\n      });\n    }\n  }\n\n  public render() {\n    const {\n      ariaLabel,\n      placeholder,\n      className,\n      disabled,\n      underlined,\n      styles,\n      // eslint-disable-next-line deprecation/deprecation\n      labelText,\n      theme,\n      clearButtonProps,\n      disableAnimation,\n      iconProps,\n      role,\n      id = this._fallbackId,\n    } = this.props;\n    const { value, hasFocus } = this.state;\n    const placeholderValue = placeholder !== undefined ? placeholder : labelText;\n\n    const classNames = getClassNames(styles!, {\n      theme: theme!,\n      className,\n      underlined,\n      hasFocus,\n      disabled,\n      hasInput: value!.length > 0,\n      disableAnimation,\n    });\n\n    const nativeProps = getNativeProps<React.InputHTMLAttributes<HTMLInputElement>>(this.props, inputProperties, [\n      'className',\n      'placeholder',\n      'onFocus',\n      'onBlur',\n      'value',\n      'role',\n    ]);\n\n    return (\n      <div role={role} ref={this._rootElement} className={classNames.root} onFocusCapture={this._onFocusCapture}>\n        <div className={classNames.iconContainer} onClick={this._onClickFocus} aria-hidden={true}>\n          <Icon iconName=\"Search\" {...iconProps} className={classNames.icon} />\n        </div>\n        <input\n          {...nativeProps}\n          id={id}\n          className={classNames.field}\n          placeholder={placeholderValue}\n          onChange={this._onInputChange}\n          onInput={this._onInputChange}\n          onBlur={this._onBlur}\n          onKeyDown={this._onKeyDown}\n          value={value}\n          disabled={disabled}\n          role=\"searchbox\"\n          aria-label={ariaLabel}\n          ref={this._inputElement}\n        />\n        {value!.length > 0 && (\n          <div className={classNames.clearButton}>\n            <IconButton\n              onBlur={this._onBlur}\n              styles={{ root: { height: 'auto' }, icon: { fontSize: '12px' } }}\n              iconProps={{ iconName: 'Clear' }}\n              {...clearButtonProps}\n              onClick={this._onClearClick}\n            />\n          </div>\n        )}\n      </div>\n    );\n  }\n\n  /**\n   * Sets focus to the search box input field\n   */\n  public focus() {\n    if (this._inputElement.current) {\n      this._inputElement.current.focus();\n    }\n  }\n\n  /**\n   * Returns whether or not the SearchBox has focus\n   */\n  public hasFocus(): boolean {\n    return !!this.state.hasFocus;\n  }\n\n  private _onClear(ev: React.MouseEvent<HTMLAnchorElement | HTMLButtonElement> | React.KeyboardEvent<HTMLElement>) {\n    this.props.onClear && this.props.onClear(ev);\n    if (!ev.defaultPrevented) {\n      this._latestValue = '';\n      this.setState({\n        value: '',\n      });\n      this._callOnChange(undefined, '');\n      ev.stopPropagation();\n      ev.preventDefault();\n\n      this.focus();\n    }\n  }\n\n  private _onClickFocus = () => {\n    const inputElement = this._inputElement.current;\n    if (inputElement) {\n      this.focus();\n      inputElement.selectionStart = inputElement.selectionEnd = 0;\n    }\n  };\n\n  private _onFocusCapture = (ev: React.FocusEvent<HTMLElement>) => {\n    this.setState({\n      hasFocus: true,\n    });\n\n    if (this.props.onFocus) {\n      this.props.onFocus(ev as React.FocusEvent<HTMLInputElement>);\n    }\n  };\n\n  private _onClearClick = (ev: React.MouseEvent<HTMLAnchorElement | HTMLButtonElement>) => {\n    const { clearButtonProps } = this.props;\n\n    if (clearButtonProps && clearButtonProps.onClick) {\n      clearButtonProps.onClick(ev);\n    }\n\n    if (!ev.defaultPrevented) {\n      this._onClear(ev);\n    }\n  };\n\n  private _onKeyDown = (ev: React.KeyboardEvent<HTMLInputElement>) => {\n    switch (ev.which) {\n      case KeyCodes.escape:\n        this.props.onEscape && this.props.onEscape(ev);\n        // Only call onClear if the search box has a value to clear. Otherwise, allow the Esc key\n        // to propagate from the empty search box to a parent element such as a dialog, etc.\n        if (this.state.value && !ev.defaultPrevented) {\n          this._onClear(ev);\n        }\n        break;\n\n      case KeyCodes.enter:\n        if (this.props.onSearch) {\n          this.props.onSearch(this.state.value);\n          ev.preventDefault();\n          ev.stopPropagation();\n        }\n        break;\n\n      default:\n        this.props.onKeyDown && this.props.onKeyDown(ev);\n        if (ev.defaultPrevented) {\n          ev.stopPropagation();\n        }\n        break;\n    }\n  };\n\n  private _onBlur = (ev: React.FocusEvent<HTMLInputElement>): void => {\n    this.setState({\n      hasFocus: false,\n    });\n\n    if (this.props.onBlur) {\n      this.props.onBlur(ev);\n    }\n  };\n\n  private _onInputChange = (ev: React.ChangeEvent<HTMLInputElement>) => {\n    const value = ev.target.value;\n\n    if (value === this._latestValue) {\n      return;\n    }\n    this._latestValue = value;\n\n    this.setState({ value });\n    this._callOnChange(ev, value);\n  };\n\n  private _callOnChange(ev?: React.ChangeEvent<HTMLInputElement>, newValue?: string): void {\n    // eslint-disable-next-line deprecation/deprecation\n    const { onChange, onChanged } = this.props;\n\n    // Call @deprecated method.\n    if (onChanged) {\n      onChanged(newValue);\n    }\n\n    if (onChange) {\n      onChange(ev, newValue);\n    }\n  }\n}\n"]}