{"version":3,"file":"ResizeGroup.OverflowSet.Example.js","sourceRoot":"../src/","sources":["components/ResizeGroup/examples/ResizeGroup.OverflowSet.Example.tsx"],"names":[],"mappings":";AAAA,OAAO,KAAK,KAAK,MAAM,OAAO,CAAC;AAC/B,OAAO,EAAE,aAAa,EAAE,MAAM,sCAAsC,CAAC;AACrE,OAAO,EAAE,gBAAgB,EAAE,MAAM,mCAAmC,CAAC;AACrE,OAAO,EAAE,WAAW,EAAE,MAAM,wCAAwC,CAAC;AACrE,OAAO,EAAE,WAAW,EAAE,MAAM,wCAAwC,CAAC;AACrE,OAAO,EAAE,QAAQ,EAAE,MAAM,qCAAqC,CAAC;AAE/D,OAAO,EAAE,QAAQ,EAAmB,MAAM,qCAAqC,CAAC;AAEhF,OAAO,KAAK,YAAY,MAAM,4BAA4B,CAAC;AAC3D,IAAM,MAAM,GAAQ,YAAY,CAAC;AAQjC,sBAAsB,KAAa,EAAE,cAAuB,EAAE,OAAgB;IAC5E,IAAM,KAAK,GAAG,CAAC,KAAK,EAAE,OAAO,EAAE,QAAQ,CAAC,CAAC;IACzC,IAAM,SAAS,GAAG,EAAE,CAAC;IACrB,IAAI,QAAQ,GAAG,EAAE,CAAC;IAClB,KAAK,IAAI,KAAK,GAAG,CAAC,EAAE,KAAK,GAAG,KAAK,EAAE,KAAK,EAAE,EAAE;QAC1C,IAAM,IAAI,GAAG;YACX,GAAG,EAAE,SAAO,KAAO;YACnB,IAAI,EAAE,UAAQ,KAAO;YACrB,IAAI,EAAE,KAAK,CAAC,KAAK,GAAG,KAAK,CAAC,MAAM,CAAC;YACjC,OAAO,EAAE,OAAO;SACjB,CAAC;QAEF,QAAQ,GAAG,QAAQ,GAAG,IAAI,CAAC,GAAG,CAAC;QAC/B,SAAS,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;KACtB;IAED,IAAI,MAAM,GAAkB;QAC1B,OAAO,EAAE,SAAS;QAClB,QAAQ,EAAE,EAAW;KACtB,CAAC;IAEF,IAAI,cAAc,EAAE;QAClB,MAAM,wBAAQ,MAAM,IAAE,QAAQ,UAAA,GAAE,CAAC;KAClC;IAED,OAAO,MAAM,CAAC;AAChB,CAAC;AAUD,yBAAyB,eAAsC;IAC7D,OAAO,eAAe,CAAC,MAAM,CAAC,UAAC,GAAG,EAAE,OAAO,IAAK,OAAA,GAAG,GAAG,OAAO,CAAC,GAAG,EAAjB,CAAiB,EAAE,EAAE,CAAC,CAAC;AACzE,CAAC;AAED;IAAmD,yDAAsD;IACvG,uCAAY,KAAS;QAArB,YACE,kBAAM,KAAK,CAAC,SAQb;QAyDO,mBAAa,GAAG,UAAC,WAAgB;YACvC,IAAI,WAAW,CAAC,OAAO,CAAC,MAAM,KAAK,CAAC,EAAE;gBACpC,OAAO,SAAS,CAAC;aAClB;YAED,IAAM,QAAQ,GAAO,WAAW,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,QAAK,WAAW,CAAC,QAAQ,CAAC,CAAC;YAC7E,IAAM,OAAO,GAAG,WAAW,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;YAEjD,IAAI,QAAQ,GAAG,SAAS,CAAC;YACzB,IAAI,KAAI,CAAC,KAAK,CAAC,cAAc,EAAE;gBAC7B,QAAQ,GAAG,eAAe,CAAC,OAAO,CAAC,CAAC;aACrC;YACD,OAAO,EAAE,OAAO,SAAA,EAAE,QAAQ,UAAA,EAAE,QAAQ,UAAA,EAAE,CAAC;QACzC,CAAC,CAAC;QAEM,iBAAW,GAAG,UAAC,WAAgB;YACrC,IAAI,WAAW,CAAC,QAAQ,CAAC,MAAM,KAAK,CAAC,EAAE;gBACrC,OAAO,SAAS,CAAC;aAClB;YAED,IAAM,QAAQ,GAAG,WAAW,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;YAC/C,IAAM,OAAO,GAAO,WAAW,CAAC,OAAO,QAAK,WAAW,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;YAE9E,IAAI,QAAQ,GAAG,SAAS,CAAC;YACzB,IAAI,KAAI,CAAC,KAAK,CAAC,cAAc,EAAE;gBAC7B,QAAQ,GAAG,eAAe,CAAC,OAAO,CAAC,CAAC;aACrC;YACD,OAAO,EAAE,OAAO,SAAA,EAAE,QAAQ,UAAA,EAAE,QAAQ,UAAA,EAAE,CAAC;QACzC,CAAC,CAAC;QAEM,8BAAwB,GAAG,UAAC,CAAkD,EAAE,OAAgB;YACtG,KAAI,CAAC,QAAQ,CAAC,EAAE,cAAc,EAAE,OAAO,EAAE,CAAC,CAAC;QAC7C,CAAC,CAAC;QAEM,+BAAyB,GAAG,UAAC,CAAkD,EAAE,OAAgB;YACvG,KAAI,CAAC,QAAQ,CAAC,EAAE,iBAAiB,EAAE,OAAO,EAAE,CAAC,CAAC;QAChD,CAAC,CAAC;QAEM,8BAAwB,GAAG,UAAC,CAAkD,EAAE,OAAgB;YACtG,KAAI,CAAC,QAAQ,CAAC,EAAE,cAAc,EAAE,OAAO,EAAE,CAAC,CAAC;QAC7C,CAAC,CAAC;QAEM,6BAAuB,GAAG,UAAC,KAAsC,EAAE,MAAuB;YAChG,KAAI,CAAC,QAAQ,CAAC,EAAE,aAAa,EAAE,QAAQ,CAAC,MAAM,CAAC,IAAI,EAAE,EAAE,CAAC,EAAE,CAAC,CAAC;QAC9D,CAAC,CAAC;QA5GA,KAAI,CAAC,KAAK,GAAG;YACX,KAAK,EAAE,KAAK;YACZ,cAAc,EAAE,KAAK;YACrB,cAAc,EAAE,KAAK;YACrB,iBAAiB,EAAE,KAAK;YACxB,aAAa,EAAE,EAAE;SAClB,CAAC;;IACJ,CAAC;IAEM,8CAAM,GAAb;QACQ,IAAA,eAAwF,EAAtF,gCAAa,EAAE,kCAAc,EAAE,kCAAc,EAAE,gBAAK,EAAE,wCAAiB,CAAgB;QAC/F,IAAM,YAAY,GAAG,YAAY,CAAC,aAAa,EAAE,cAAc,EAAE,cAAc,CAAC,CAAC;QACjF,OAAO,CACL,6BAAK,SAAS,EAAE,KAAK,CAAC,CAAC,CAAC,MAAM,CAAC,aAAa,CAAC,CAAC,CAAC,YAAY;YACzD,oBAAC,WAAW,IACV,IAAI,EAAC,UAAU,gBACJ,mCAAmC,EAC9C,IAAI,EAAE,YAAY,EAClB,YAAY,EAAE,IAAI,CAAC,aAAa,EAChC,UAAU,EAAE,iBAAiB,CAAC,CAAC,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC,CAAC,SAAS;gBAC5D,yCAAyC;gBACzC,YAAY,EAAE,UAAA,IAAI;oBAChB,OAAO,CACL,oBAAC,WAAW,IACV,KAAK,EAAE,IAAI,CAAC,OAAO,EACnB,aAAa,EAAE,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC,IAAI,EAC1D,YAAY,EAAE,UAAA,IAAI;4BAChB,OAAO,CACL,oBAAC,gBAAgB,IAAC,IAAI,EAAE,IAAI,CAAC,IAAI,EAAE,SAAS,EAAE,EAAE,QAAQ,EAAE,IAAI,CAAC,IAAI,EAAE,EAAE,OAAO,EAAE,IAAI,CAAC,OAAO,EAAE,OAAO,EAAE,IAAI,CAAC,OAAO,GAAI,CACxH,CAAC;wBACJ,CAAC,EACD,sBAAsB,EAAE,UAAA,aAAa;4BACnC,OAAO,oBAAC,gBAAgB,IAAC,SAAS,EAAE,EAAE,KAAK,EAAE,aAAc,EAAE,GAAI,CAAC;wBACpE,CAAC,EACD,MAAM,EAAE,EAAE,IAAI,EAAE,EAAE,MAAM,EAAE,EAAE,EAAE,EAAE,GAChC,CACH,CAAC;gBACJ,CAAC,GACD;YACF,6BAAK,SAAS,EAAE,MAAM,CAAC,aAAa;gBAClC,oBAAC,QAAQ,IAAC,KAAK,EAAC,gBAAgB,EAAC,QAAQ,EAAE,IAAI,CAAC,wBAAwB,EAAE,OAAO,EAAE,cAAc,GAAI;gBACrG,oBAAC,QAAQ,IAAC,KAAK,EAAC,gBAAgB,EAAC,QAAQ,EAAE,IAAI,CAAC,yBAAyB,EAAE,OAAO,EAAE,iBAAiB,GAAI;gBACzG,oBAAC,QAAQ,IAAC,KAAK,EAAC,iBAAiB,EAAC,QAAQ,EAAE,IAAI,CAAC,wBAAwB,EAAE,OAAO,EAAE,cAAc,GAAI;gBACtG,6BAAK,SAAS,EAAE,MAAM,CAAC,iBAAiB;oBACtC,oBAAC,QAAQ,IACP,KAAK,EAAC,2BAA2B,EACjC,WAAW,EAAE,aAAa,CAAC,QAAQ,EAAE,EACrC,QAAQ,EAAE,IAAI,CAAC,uBAAuB,EACtC,OAAO,EAAE;4BACP,EAAE,GAAG,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE;4BACzB,EAAE,GAAG,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE;4BACzB,EAAE,GAAG,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE;4BACzB,EAAE,GAAG,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE;4BACzB,EAAE,GAAG,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE;4BACzB,EAAE,GAAG,EAAE,KAAK,EAAE,IAAI,EAAE,KAAK,EAAE;4BAC3B,EAAE,GAAG,EAAE,KAAK,EAAE,IAAI,EAAE,KAAK,EAAE;yBAC5B,GACD,CACE,CACF,CACF,CACP,CAAC;IACJ,CAAC;IA+CH,oCAAC;AAAD,CAAC,AAhHD,CAAmD,aAAa,GAgH/D","sourcesContent":["import * as React from 'react';\r\nimport { BaseComponent } from 'office-ui-fabric-react/lib/Utilities';\r\nimport { CommandBarButton } from 'office-ui-fabric-react/lib/Button';\r\nimport { ResizeGroup } from 'office-ui-fabric-react/lib/ResizeGroup';\r\nimport { OverflowSet } from 'office-ui-fabric-react/lib/OverflowSet';\r\nimport { Checkbox } from 'office-ui-fabric-react/lib/Checkbox';\r\nimport { IContextualMenuItem } from 'office-ui-fabric-react/lib/ContextualMenu';\r\nimport { Dropdown, IDropdownOption } from 'office-ui-fabric-react/lib/Dropdown';\r\n\r\nimport * as stylesImport from './ResizeGroup.Example.scss';\r\nconst styles: any = stylesImport;\r\n\r\nexport interface IOverflowData {\r\n  primary: IContextualMenuItem[];\r\n  overflow: IContextualMenuItem[];\r\n  cacheKey?: string;\r\n}\r\n\r\nfunction generateData(count: number, cachingEnabled: boolean, checked: boolean): IOverflowData {\r\n  const icons = ['Add', 'Share', 'Upload'];\r\n  const dataItems = [];\r\n  let cacheKey = '';\r\n  for (let index = 0; index < count; index++) {\r\n    const item = {\r\n      key: `item${index}`,\r\n      name: `Item ${index}`,\r\n      icon: icons[index % icons.length],\r\n      checked: checked\r\n    };\r\n\r\n    cacheKey = cacheKey + item.key;\r\n    dataItems.push(item);\r\n  }\r\n\r\n  let result: IOverflowData = {\r\n    primary: dataItems,\r\n    overflow: [] as any[]\r\n  };\r\n\r\n  if (cachingEnabled) {\r\n    result = { ...result, cacheKey };\r\n  }\r\n\r\n  return result;\r\n}\r\n\r\nexport interface IResizeGroupOverflowSetExampleState {\r\n  short: boolean;\r\n  numberOfItems: number;\r\n  buttonsChecked: boolean;\r\n  cachingEnabled: boolean;\r\n  onGrowDataEnabled: boolean;\r\n}\r\n\r\nfunction computeCacheKey(primaryControls: IContextualMenuItem[]): string {\r\n  return primaryControls.reduce((acc, current) => acc + current.key, '');\r\n}\r\n\r\nexport class ResizeGroupOverflowSetExample extends BaseComponent<{}, IResizeGroupOverflowSetExampleState> {\r\n  constructor(props: {}) {\r\n    super(props);\r\n    this.state = {\r\n      short: false,\r\n      buttonsChecked: false,\r\n      cachingEnabled: false,\r\n      onGrowDataEnabled: false,\r\n      numberOfItems: 20\r\n    };\r\n  }\r\n\r\n  public render(): JSX.Element {\r\n    const { numberOfItems, cachingEnabled, buttonsChecked, short, onGrowDataEnabled } = this.state;\r\n    const dataToRender = generateData(numberOfItems, cachingEnabled, buttonsChecked);\r\n    return (\r\n      <div className={short ? styles.resizeIsShort : 'notResized'}>\r\n        <ResizeGroup\r\n          role=\"tabpanel\"\r\n          aria-label=\"Resize Group with an Overflow Set\"\r\n          data={dataToRender}\r\n          onReduceData={this._onReduceData}\r\n          onGrowData={onGrowDataEnabled ? this._onGrowData : undefined}\r\n          // tslint:disable-next-line:jsx-no-lambda\r\n          onRenderData={data => {\r\n            return (\r\n              <OverflowSet\r\n                items={data.primary}\r\n                overflowItems={data.overflow.length ? data.overflow : null}\r\n                onRenderItem={item => {\r\n                  return (\r\n                    <CommandBarButton text={item.name} iconProps={{ iconName: item.icon }} onClick={item.onClick} checked={item.checked} />\r\n                  );\r\n                }}\r\n                onRenderOverflowButton={overflowItems => {\r\n                  return <CommandBarButton menuProps={{ items: overflowItems! }} />;\r\n                }}\r\n                styles={{ root: { height: 40 } }}\r\n              />\r\n            );\r\n          }}\r\n        />\r\n        <div className={styles.settingsGroup}>\r\n          <Checkbox label=\"Enable caching\" onChange={this._onCachingEnabledChanged} checked={cachingEnabled} />\r\n          <Checkbox label=\"Set onGrowData\" onChange={this._onGrowDataEnabledChanged} checked={onGrowDataEnabled} />\r\n          <Checkbox label=\"Buttons checked\" onChange={this._onButtonsCheckedChanged} checked={buttonsChecked} />\r\n          <div className={styles.itemCountDropdown}>\r\n            <Dropdown\r\n              label=\"Number of items to render\"\r\n              selectedKey={numberOfItems.toString()}\r\n              onChange={this._onNumberOfItemsChanged}\r\n              options={[\r\n                { key: '20', text: '20' },\r\n                { key: '30', text: '30' },\r\n                { key: '40', text: '40' },\r\n                { key: '50', text: '50' },\r\n                { key: '75', text: '75' },\r\n                { key: '100', text: '100' },\r\n                { key: '200', text: '200' }\r\n              ]}\r\n            />\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  private _onReduceData = (currentData: any): any => {\r\n    if (currentData.primary.length === 0) {\r\n      return undefined;\r\n    }\r\n\r\n    const overflow = [...currentData.primary.slice(-1), ...currentData.overflow];\r\n    const primary = currentData.primary.slice(0, -1);\r\n\r\n    let cacheKey = undefined;\r\n    if (this.state.cachingEnabled) {\r\n      cacheKey = computeCacheKey(primary);\r\n    }\r\n    return { primary, overflow, cacheKey };\r\n  };\r\n\r\n  private _onGrowData = (currentData: any): any => {\r\n    if (currentData.overflow.length === 0) {\r\n      return undefined;\r\n    }\r\n\r\n    const overflow = currentData.overflow.slice(1);\r\n    const primary = [...currentData.primary, ...currentData.overflow.slice(0, 1)];\r\n\r\n    let cacheKey = undefined;\r\n    if (this.state.cachingEnabled) {\r\n      cacheKey = computeCacheKey(primary);\r\n    }\r\n    return { primary, overflow, cacheKey };\r\n  };\r\n\r\n  private _onCachingEnabledChanged = (_: React.FormEvent<HTMLElement | HTMLInputElement>, checked: boolean): void => {\r\n    this.setState({ cachingEnabled: checked });\r\n  };\r\n\r\n  private _onGrowDataEnabledChanged = (_: React.FormEvent<HTMLElement | HTMLInputElement>, checked: boolean): void => {\r\n    this.setState({ onGrowDataEnabled: checked });\r\n  };\r\n\r\n  private _onButtonsCheckedChanged = (_: React.FormEvent<HTMLElement | HTMLInputElement>, checked: boolean): void => {\r\n    this.setState({ buttonsChecked: checked });\r\n  };\r\n\r\n  private _onNumberOfItemsChanged = (event: React.FormEvent<HTMLDivElement>, option: IDropdownOption): void => {\r\n    this.setState({ numberOfItems: parseInt(option.text, 10) });\r\n  };\r\n}\r\n"]}