{"version":3,"file":"ComboBox.Controlled.Example.js","sourceRoot":"../src/","sources":["components/ComboBox/examples/ComboBox.Controlled.Example.tsx"],"names":[],"mappings":"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","sourcesContent":["// @codepen\r\nimport * as React from 'react';\r\nimport { ComboBox, IComboBoxOption, IComboBox, SelectableOptionMenuItemType, Fabric, mergeStyles } from 'office-ui-fabric-react/lib/index';\r\n\r\nconst INITIAL_OPTIONS: IComboBoxOption[] = [\r\n  { key: 'Header1', text: 'First heading', itemType: SelectableOptionMenuItemType.Header },\r\n  { key: 'A', text: 'Option A' },\r\n  { key: 'B', text: 'Option B' },\r\n  { key: 'C', text: 'Option C' },\r\n  { key: 'D', text: 'Option D' },\r\n  { key: 'divider', text: '-', itemType: SelectableOptionMenuItemType.Divider },\r\n  { key: 'Header2', text: 'Second heading', itemType: SelectableOptionMenuItemType.Header },\r\n  { key: 'E', text: 'Option E' },\r\n  { key: 'F', text: 'Option F', disabled: true },\r\n  { key: 'G', text: 'Option G' },\r\n  { key: 'H', text: 'Option H' },\r\n  { key: 'I', text: 'Option I' },\r\n  { key: 'J', text: 'Option J' }\r\n];\r\n\r\nconst wrapperClassName = mergeStyles({\r\n  selectors: {\r\n    '& > *': { marginBottom: '20px' },\r\n    '& .ms-ComboBox': { maxWidth: '300px' }\r\n  }\r\n});\r\n\r\nexport interface IComboBoxControlledExampleState {\r\n  /** Current options for the single-select example */\r\n  options: IComboBoxOption[];\r\n  /** Current selected option for the single-select example */\r\n  selectedOptionKey?: string | number;\r\n  /**\r\n   * Initial display value for the single-select example.\r\n   * This will be cleared after the options are resolved for the first time.\r\n   */\r\n  initialDisplayValue?: string;\r\n\r\n  /** Current options for the multi-select example */\r\n  optionsMulti: IComboBoxOption[];\r\n  /** Current selected options for the multi-select example */\r\n  selectedOptionKeys?: string[];\r\n  /**\r\n   * Initial display value for the multi-select example.\r\n   * This will be cleared after the options are resolved for the first time.\r\n   */\r\n  initialDisplayValueMulti?: string;\r\n}\r\n\r\n// tslint:disable:jsx-no-lambda\r\nexport class ComboBoxControlledExample extends React.Component<{}, IComboBoxControlledExampleState> {\r\n  constructor(props: {}) {\r\n    super(props);\r\n    this.state = {\r\n      // The options will be resolved (and updated in state) the first time each example is focused\r\n      options: [],\r\n      optionsMulti: [],\r\n      // This is the text of the option which will be initially selected after the options are resolved\r\n      initialDisplayValue: 'Option C',\r\n      initialDisplayValueMulti: 'Option C'\r\n    };\r\n  }\r\n\r\n  public render(): JSX.Element {\r\n    const state = this.state;\r\n\r\n    return (\r\n      <Fabric className={wrapperClassName}>\r\n        <ComboBox\r\n          selectedKey={state.selectedOptionKey}\r\n          label=\"Controlled single-select ComboBox (allowFreeform: T)\"\r\n          allowFreeform={true}\r\n          autoComplete=\"on\"\r\n          options={state.options}\r\n          onChange={this._onChange}\r\n          onResolveOptions={this._getOptions}\r\n          text={state.initialDisplayValue}\r\n        />\r\n\r\n        <ComboBox\r\n          multiSelect\r\n          selectedKey={state.selectedOptionKeys}\r\n          label=\"Controlled multi-select ComboBox (allowFreeform: T)\"\r\n          allowFreeform={true}\r\n          autoComplete=\"on\"\r\n          options={state.optionsMulti}\r\n          onChange={this._onChangeMulti}\r\n          onResolveOptions={this._getOptionsMulti}\r\n          text={state.initialDisplayValueMulti}\r\n        />\r\n      </Fabric>\r\n    );\r\n  }\r\n\r\n  private _getOptions = (currentOptions: IComboBoxOption[]): IComboBoxOption[] => {\r\n    if (this.state.options.length > 0) {\r\n      return this.state.options;\r\n    }\r\n\r\n    const options = [...INITIAL_OPTIONS];\r\n\r\n    this.setState({\r\n      options: options,\r\n      selectedOptionKey: 'C',\r\n      initialDisplayValue: undefined\r\n    });\r\n\r\n    return options;\r\n  };\r\n\r\n  private _getOptionsMulti = (currentOptions: IComboBoxOption[]): IComboBoxOption[] => {\r\n    if (this.state.optionsMulti.length > 0) {\r\n      return this.state.optionsMulti;\r\n    }\r\n\r\n    const options = [...INITIAL_OPTIONS];\r\n\r\n    this.setState({\r\n      optionsMulti: options,\r\n      selectedOptionKeys: ['C'],\r\n      initialDisplayValueMulti: undefined\r\n    });\r\n\r\n    return options;\r\n  };\r\n\r\n  private _onChange = (event: React.FormEvent<IComboBox>, option?: IComboBoxOption, index?: number, value?: string): void => {\r\n    console.log('_onChanged() is called: option = ' + JSON.stringify(option));\r\n    if (option) {\r\n      // User chose an existing option\r\n      this.setState({\r\n        selectedOptionKey: option.key\r\n      });\r\n    } else if (value !== undefined) {\r\n      // User typed a new option\r\n      const newOption: IComboBoxOption = { key: value, text: value };\r\n\r\n      this.setState({\r\n        options: [...this.state.options, newOption],\r\n        selectedOptionKey: newOption.key\r\n      });\r\n    }\r\n  };\r\n\r\n  private _onChangeMulti = (event: React.FormEvent<IComboBox>, option?: IComboBoxOption, index?: number, value?: string) => {\r\n    console.log('_onChangeMulti() is called: option = ' + JSON.stringify(option));\r\n    const currentSelectedKeys = this.state.selectedOptionKeys || [];\r\n    if (option) {\r\n      // User selected/de-selected an existing option\r\n      this.setState({\r\n        selectedOptionKeys: this._updateSelectedOptionKeys(currentSelectedKeys, option)\r\n      });\r\n    } else if (value !== undefined) {\r\n      // User typed a freeform option\r\n      const newOption: IComboBoxOption = { key: value, text: value };\r\n      const updatedSelectedKeys: string[] = [...currentSelectedKeys, newOption.key as string];\r\n      this.setState({\r\n        optionsMulti: [...this.state.optionsMulti, newOption],\r\n        selectedOptionKeys: updatedSelectedKeys\r\n      });\r\n    }\r\n  };\r\n\r\n  private _updateSelectedOptionKeys = (selectedKeys: string[], option: IComboBoxOption): string[] => {\r\n    selectedKeys = [...selectedKeys]; // modify a copy\r\n    const index = selectedKeys.indexOf(option.key as string);\r\n    if (option.selected && index < 0) {\r\n      selectedKeys.push(option.key as string);\r\n    } else {\r\n      selectedKeys.splice(index, 1);\r\n    }\r\n    return selectedKeys;\r\n  };\r\n}\r\n"]}