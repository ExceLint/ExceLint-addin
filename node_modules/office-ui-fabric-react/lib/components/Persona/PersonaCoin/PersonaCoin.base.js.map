{"version":3,"file":"PersonaCoin.base.js","sourceRoot":"../src/","sources":["components/Persona/PersonaCoin/PersonaCoin.base.tsx"],"names":[],"mappings":"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","sourcesContent":["import * as React from 'react';\nimport {\n  warnDeprecations,\n  classNamesFunction,\n  divProperties,\n  getInitials,\n  getNativeProps,\n  getRTL,\n} from '../../../Utilities';\nimport { mergeStyles } from '../../../Styling';\nimport { PersonaPresence } from '../PersonaPresence/index';\nimport { Icon } from '../../../Icon';\nimport { Image, ImageFit, ImageLoadState } from '../../../Image';\nimport {\n  IPersonaCoinProps,\n  IPersonaCoinStyleProps,\n  IPersonaCoinStyles,\n  IPersonaPresenceProps,\n  PersonaPresence as PersonaPresenceEnum,\n  PersonaSize,\n} from '../Persona.types';\nimport { getPersonaInitialsColor } from '../PersonaInitialsColor';\nimport { sizeToPixels } from '../PersonaConsts';\n\nconst getClassNames = classNamesFunction<IPersonaCoinStyleProps, IPersonaCoinStyles>({\n  // There can be many PersonaCoin rendered with different sizes.\n  // Therefore setting a larger cache size.\n  cacheSize: 100,\n});\n\nexport interface IPersonaState {\n  isImageLoaded?: boolean;\n  isImageError?: boolean;\n}\n\n/**\n * PersonaCoin with no default styles.\n * [Use the `getStyles` API to add your own styles.](https://github.com/microsoft/fluentui/wiki/Styling)\n */\nexport class PersonaCoinBase extends React.Component<IPersonaCoinProps, IPersonaState> {\n  public static defaultProps: IPersonaCoinProps = {\n    size: PersonaSize.size48,\n    presence: PersonaPresenceEnum.none,\n    imageAlt: '',\n  };\n\n  constructor(props: IPersonaCoinProps) {\n    super(props);\n\n    if (process.env.NODE_ENV !== 'production') {\n      warnDeprecations('PersonaCoin', props, { primaryText: 'text' });\n    }\n\n    this.state = {\n      isImageLoaded: false,\n      isImageError: false,\n    };\n  }\n\n  public UNSAFE_componentWillReceiveProps(nextProps: IPersonaCoinProps): void {\n    if (nextProps.imageUrl !== this.props.imageUrl) {\n      this.setState({\n        isImageLoaded: false,\n        isImageError: false,\n      });\n    }\n  }\n\n  public render(): JSX.Element | null {\n    const {\n      className,\n      coinProps,\n      showUnknownPersonaCoin,\n      coinSize,\n      styles,\n      imageUrl,\n      isOutOfOffice,\n      /* eslint-disable deprecation/deprecation */\n      onRenderCoin = this._onRenderCoin,\n      onRenderPersonaCoin = onRenderCoin,\n      /* eslint-enable deprecation/deprecation */\n      onRenderInitials = this._onRenderInitials,\n      presence,\n      presenceTitle,\n      presenceColors,\n      showInitialsUntilImageLoads,\n      theme,\n    } = this.props;\n\n    const size = this.props.size as PersonaSize;\n    const divProps = getNativeProps<React.HTMLAttributes<HTMLDivElement>>(this.props, divProperties);\n    const divCoinProps = getNativeProps<React.HTMLAttributes<HTMLDivElement>>(coinProps || {}, divProperties);\n    const coinSizeStyle = coinSize ? { width: coinSize, height: coinSize } : undefined;\n    const hideImage = showUnknownPersonaCoin;\n\n    const personaPresenceProps: IPersonaPresenceProps = {\n      coinSize,\n      isOutOfOffice,\n      presence,\n      presenceTitle,\n      presenceColors,\n      size,\n      theme,\n    };\n\n    // Use getStyles from props, or fall back to getStyles from styles file.\n    const classNames = getClassNames(styles, {\n      theme: theme!,\n      className: coinProps && coinProps.className ? coinProps.className : className,\n      size,\n      coinSize,\n      showUnknownPersonaCoin,\n    });\n\n    const shouldRenderInitials = Boolean(\n      !this.state.isImageLoaded &&\n        ((showInitialsUntilImageLoads && imageUrl) || !imageUrl || this.state.isImageError || hideImage),\n    );\n\n    return (\n      <div role=\"presentation\" {...divProps} className={classNames.coin}>\n        {// Render PersonaCoin if size is not size8. size10 and tiny need to removed after a deprecation cleanup.\n        // eslint-disable-next-line deprecation/deprecation\n        size !== PersonaSize.size8 && size !== PersonaSize.size10 && size !== PersonaSize.tiny ? (\n          <div role=\"presentation\" {...divCoinProps} className={classNames.imageArea} style={coinSizeStyle}>\n            {shouldRenderInitials && (\n              <div\n                className={mergeStyles(\n                  classNames.initials,\n                  !showUnknownPersonaCoin && { backgroundColor: getPersonaInitialsColor(this.props) },\n                )}\n                style={coinSizeStyle}\n                aria-hidden=\"true\"\n              >\n                {onRenderInitials(this.props, this._onRenderInitials)}\n              </div>\n            )}\n            {!hideImage && onRenderPersonaCoin(this.props, this._onRenderCoin)}\n            <PersonaPresence {...personaPresenceProps} />\n          </div>\n        ) : // Otherwise, render just PersonaPresence.\n        this.props.presence ? (\n          <PersonaPresence {...personaPresenceProps} />\n        ) : (\n          // Just render Contact Icon if there isn't a Presence prop.\n          <Icon iconName=\"Contact\" className={classNames.size10WithoutPresenceIcon} />\n        )}\n        {this.props.children}\n      </div>\n    );\n  }\n\n  private _onRenderCoin = (props: IPersonaCoinProps): JSX.Element | null => {\n    const {\n      coinSize,\n      styles,\n      imageUrl,\n      imageAlt,\n      imageShouldFadeIn,\n      imageShouldStartVisible,\n      theme,\n      showUnknownPersonaCoin,\n    } = this.props;\n\n    // Render the Image component only if an image URL is provided\n    if (!imageUrl) {\n      return null;\n    }\n\n    const size = this.props.size as PersonaSize;\n\n    const classNames = getClassNames(styles, {\n      theme: theme!,\n      size,\n      showUnknownPersonaCoin,\n    });\n\n    const dimension = coinSize || sizeToPixels[size];\n\n    return (\n      <Image\n        className={classNames.image}\n        imageFit={ImageFit.cover}\n        src={imageUrl}\n        width={dimension}\n        height={dimension}\n        alt={imageAlt}\n        shouldFadeIn={imageShouldFadeIn}\n        shouldStartVisible={imageShouldStartVisible}\n        onLoadingStateChange={this._onPhotoLoadingStateChange}\n      />\n    );\n  };\n\n  /**\n   * Deprecation helper for getting text.\n   */\n  private _getText(): string {\n    // eslint-disable-next-line deprecation/deprecation\n    return this.props.text || this.props.primaryText || '';\n  }\n\n  private _onRenderInitials = (props: IPersonaCoinProps): JSX.Element => {\n    let { imageInitials } = props;\n    const { allowPhoneInitials, showUnknownPersonaCoin } = props;\n\n    if (showUnknownPersonaCoin) {\n      return <Icon iconName=\"Help\" />;\n    }\n\n    const isRTL = getRTL(this.props.theme);\n\n    imageInitials = imageInitials || getInitials(this._getText(), isRTL, allowPhoneInitials);\n\n    return imageInitials !== '' ? <span>{imageInitials}</span> : <Icon iconName=\"Contact\" />;\n  };\n\n  private _onPhotoLoadingStateChange = (loadState: ImageLoadState) => {\n    this.setState({\n      isImageLoaded: loadState === ImageLoadState.loaded,\n      isImageError: loadState === ImageLoadState.error,\n    });\n\n    this.props.onPhotoLoadingStateChange && this.props.onPhotoLoadingStateChange(loadState);\n  };\n}\n"]}