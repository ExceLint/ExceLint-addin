{"version":3,"file":"ChoiceGroup.base.js","sourceRoot":"../src/","sources":["components/ChoiceGroup/ChoiceGroup.base.tsx"],"names":[],"mappings":"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","sourcesContent":["import * as React from 'react';\r\n\r\nimport { Label } from '../../Label';\r\nimport { initializeComponentRef, warnDeprecations, warnMutuallyExclusive, classNamesFunction, find, getId } from '../../Utilities';\r\nimport { IChoiceGroup, IChoiceGroupOption, IChoiceGroupProps, IChoiceGroupStyleProps, IChoiceGroupStyles } from './ChoiceGroup.types';\r\nimport { ChoiceGroupOption, OnChangeCallback, OnFocusCallback } from './ChoiceGroupOption/index';\r\n\r\nconst getClassNames = classNamesFunction<IChoiceGroupStyleProps, IChoiceGroupStyles>();\r\n\r\nexport interface IChoiceGroupState {\r\n  keyChecked: string | number;\r\n\r\n  /** Is true when the control has focus. */\r\n  keyFocused?: string | number;\r\n}\r\n\r\nexport class ChoiceGroupBase extends React.Component<IChoiceGroupProps, IChoiceGroupState> implements IChoiceGroup {\r\n  public static defaultProps: IChoiceGroupProps = {\r\n    options: []\r\n  };\r\n\r\n  private _id: string;\r\n  private _labelId: string;\r\n  private _inputElement = React.createRef<HTMLInputElement>();\r\n  private focusedVars: { [key: string]: OnFocusCallback } = {};\r\n  private changedVars: { [key: string]: OnChangeCallback } = {};\r\n\r\n  constructor(props: IChoiceGroupProps) {\r\n    super(props);\r\n\r\n    initializeComponentRef(this);\r\n\r\n    if (typeof process !== 'undefined' && process.env.NODE_ENV !== 'production') {\r\n      warnDeprecations('ChoiceGroup', props, { onChanged: 'onChange' });\r\n      warnMutuallyExclusive('ChoiceGroup', props, {\r\n        selectedKey: 'defaultSelectedKey'\r\n      });\r\n    }\r\n\r\n    const validDefaultSelectedKey: boolean = !!props.options && props.options.some(option => option.key === props.defaultSelectedKey);\r\n\r\n    this.state = {\r\n      keyChecked:\r\n        props.defaultSelectedKey === undefined || !validDefaultSelectedKey ? this._getKeyChecked(props)! : props.defaultSelectedKey,\r\n      keyFocused: undefined\r\n    };\r\n\r\n    this._id = getId('ChoiceGroup');\r\n    this._labelId = getId('ChoiceGroupLabel');\r\n  }\r\n\r\n  /**\r\n   * Gets the current checked option.\r\n   */\r\n  public get checkedOption(): IChoiceGroupOption | undefined {\r\n    const { options = [] } = this.props;\r\n    const { keyChecked: key } = this.state;\r\n    return find(options, (value: IChoiceGroupOption) => value.key === key);\r\n  }\r\n\r\n  public componentWillReceiveProps(newProps: IChoiceGroupProps): void {\r\n    const newKeyChecked = this._getKeyChecked(newProps);\r\n    const oldKeyChecked = this._getKeyChecked(this.props);\r\n\r\n    if (newKeyChecked !== oldKeyChecked) {\r\n      this.setState({\r\n        keyChecked: newKeyChecked!\r\n      });\r\n    }\r\n  }\r\n\r\n  public render(): JSX.Element {\r\n    const { className, theme, styles, options, label, required, disabled, name, role } = this.props;\r\n    const { keyChecked, keyFocused } = this.state;\r\n\r\n    const classNames = getClassNames(styles!, {\r\n      theme: theme!,\r\n      className,\r\n      optionsContainIconOrImage: options!.some(option => Boolean(option.iconProps || option.imageSrc))\r\n    });\r\n\r\n    const ariaLabelledBy = this.props.ariaLabelledBy\r\n      ? this.props.ariaLabelledBy\r\n      : label\r\n      ? this._id + '-label'\r\n      : (this.props as any)['aria-labelledby'];\r\n\r\n    return (\r\n      <div role={role} className={classNames.applicationRole}>\r\n        <div className={classNames.root} role=\"radiogroup\" {...ariaLabelledBy && { 'aria-labelledby': ariaLabelledBy }}>\r\n          {label && (\r\n            <Label className={classNames.label} required={required} id={this._id + '-label'}>\r\n              {label}\r\n            </Label>\r\n          )}\r\n          <div className={classNames.flexContainer}>\r\n            {options!.map((option: IChoiceGroupOption) => {\r\n              const innerOptionProps = {\r\n                ...option,\r\n                focused: option.key === keyFocused,\r\n                checked: option.key === keyChecked,\r\n                disabled: option.disabled || disabled,\r\n                id: `${this._id}-${option.key}`,\r\n                labelId: `${this._labelId}-${option.key}`,\r\n                name: name || this._id,\r\n                required\r\n              };\r\n\r\n              return (\r\n                <ChoiceGroupOption\r\n                  key={option.key}\r\n                  onBlur={this._onBlur}\r\n                  onFocus={this._onFocus(option.key)}\r\n                  onChange={this._onChange(option.key)}\r\n                  {...innerOptionProps}\r\n                />\r\n              );\r\n            })}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  public focus() {\r\n    const { options } = this.props;\r\n    if (options) {\r\n      for (const option of options) {\r\n        const elementToFocus = document.getElementById(`${this._id}-${option.key}`);\r\n        if (elementToFocus && elementToFocus.getAttribute('data-is-focusable') === 'true') {\r\n          elementToFocus.focus(); // focus on checked or default focusable key\r\n          return;\r\n        }\r\n      }\r\n    }\r\n    if (this._inputElement.current) {\r\n      this._inputElement.current.focus();\r\n    }\r\n  }\r\n\r\n  private _onFocus = (key: string) =>\r\n    this.focusedVars[key]\r\n      ? this.focusedVars[key]\r\n      : (this.focusedVars[key] = (ev: React.FocusEvent<HTMLElement>, option: IChoiceGroupOption) => {\r\n          this.setState({\r\n            keyFocused: key,\r\n            keyChecked: this.state.keyChecked\r\n          });\r\n        });\r\n\r\n  private _onBlur = (ev: React.FocusEvent<HTMLElement>, option: IChoiceGroupOption) => {\r\n    this.setState({\r\n      keyFocused: undefined,\r\n      keyChecked: this.state.keyChecked\r\n    });\r\n  };\r\n\r\n  private _onChange = (key: string) =>\r\n    this.changedVars[key]\r\n      ? this.changedVars[key]\r\n      : (this.changedVars[key] = (evt, option: IChoiceGroupOption) => {\r\n          const { onChanged, onChange, selectedKey, options = [] } = this.props;\r\n\r\n          // Only manage state in uncontrolled scenarios.\r\n          if (selectedKey === undefined) {\r\n            this.setState({\r\n              keyChecked: key\r\n            });\r\n          }\r\n\r\n          const originalOption = find(options, (value: IChoiceGroupOption) => value.key === key);\r\n\r\n          // TODO: onChanged deprecated, remove else if after 07/17/2017 when onChanged has been removed.\r\n          if (onChange) {\r\n            onChange(evt, originalOption);\r\n          } else if (onChanged) {\r\n            onChanged(originalOption!);\r\n          }\r\n        });\r\n\r\n  private _getKeyChecked(props: IChoiceGroupProps): string | number | undefined {\r\n    if (props.selectedKey !== undefined) {\r\n      return props.selectedKey;\r\n    }\r\n\r\n    const { options = [] } = props;\r\n\r\n    const optionsChecked = options.filter((option: IChoiceGroupOption) => {\r\n      return option.checked;\r\n    });\r\n\r\n    if (optionsChecked.length === 0) {\r\n      return undefined;\r\n    } else {\r\n      return optionsChecked[0].key;\r\n    }\r\n  }\r\n}\r\n"]}