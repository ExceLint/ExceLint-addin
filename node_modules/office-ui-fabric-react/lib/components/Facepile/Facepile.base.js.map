{"version":3,"file":"Facepile.base.js","sourceRoot":"../src/","sources":["components/Facepile/Facepile.base.tsx"],"names":[],"mappings":"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","sourcesContent":["import * as React from 'react';\r\nimport { BaseComponent, buttonProperties, classNamesFunction, getId, getNativeProps } from '../../Utilities';\r\nimport { IFacepileProps, IFacepilePersona, IFacepileStyleProps, IFacepileStyles, OverflowButtonType } from './Facepile.types';\r\nimport { FacepileButton } from './FacepileButton';\r\nimport { Icon } from '../../Icon';\r\nimport { Persona, IPersonaStyles } from '../../Persona';\r\nimport { PersonaCoin, PersonaSize, PersonaInitialsColor } from '../../PersonaCoin';\r\nimport { IButtonProps } from '../Button/Button.types';\r\n\r\nconst getClassNames = classNamesFunction<IFacepileStyleProps, IFacepileStyles>();\r\n\r\n/**\r\n * FacePile with no default styles.\r\n * [Use the `styles` API to add your own styles.](https://github.com/OfficeDev/office-ui-fabric-react/wiki/Component-Styling)\r\n */\r\nexport class FacepileBase extends BaseComponent<IFacepileProps, {}> {\r\n  public static defaultProps: IFacepileProps = {\r\n    maxDisplayablePersonas: 5,\r\n    personas: [],\r\n    overflowPersonas: [],\r\n    personaSize: PersonaSize.size32\r\n  };\r\n\r\n  private _ariaDescriptionId: string;\r\n\r\n  private _classNames = getClassNames(this.props.styles, {\r\n    theme: this.props.theme!,\r\n    className: this.props.className\r\n  });\r\n\r\n  constructor(props: IFacepileProps) {\r\n    super(props);\r\n\r\n    this._ariaDescriptionId = getId();\r\n  }\r\n\r\n  public render(): JSX.Element {\r\n    let { overflowButtonProps } = this.props;\r\n    const { chevronButtonProps, maxDisplayablePersonas, personas, overflowPersonas, showAddButton } = this.props;\r\n\r\n    const { _classNames } = this;\r\n\r\n    // Add a check to make sure maxDisplayalePersonas is defined to cover the edge case of it being 0.\r\n    const numPersonasToShow: number =\r\n      typeof maxDisplayablePersonas === 'number' ? Math.min(personas.length, maxDisplayablePersonas) : personas.length;\r\n\r\n    // Added for deprecating chevronButtonProps.  Can remove after v1.0\r\n    if (chevronButtonProps && !overflowButtonProps) {\r\n      overflowButtonProps = chevronButtonProps;\r\n    }\r\n\r\n    const hasOverflowPersonas = overflowPersonas && overflowPersonas.length > 0;\r\n    const personasPrimary: IFacepilePersona[] = hasOverflowPersonas ? personas : personas.slice(0, numPersonasToShow);\r\n    const personasOverflow: IFacepilePersona[] = (hasOverflowPersonas ? overflowPersonas : personas.slice(numPersonasToShow)) || [];\r\n\r\n    return (\r\n      <div className={_classNames.root}>\r\n        {this.onRenderAriaDescription()}\r\n        <div className={_classNames.itemContainer}>\r\n          {showAddButton ? this._getAddNewElement() : null}\r\n          <ul className={_classNames.members} role=\"listbox\">\r\n            {this._onRenderVisiblePersonas(personasPrimary, personasOverflow.length === 0 && personas.length === 1)}\r\n          </ul>\r\n          {overflowButtonProps ? this._getOverflowElement(personasOverflow) : null}\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  protected onRenderAriaDescription() {\r\n    const { ariaDescription } = this.props;\r\n\r\n    const { _classNames } = this;\r\n\r\n    // If ariaDescription is given, descriptionId will be assigned to ariaDescriptionSpan,\r\n    // otherwise it will be assigned to descriptionSpan.\r\n    return (\r\n      ariaDescription && (\r\n        <span className={_classNames.screenReaderOnly} id={this._ariaDescriptionId}>\r\n          {ariaDescription}\r\n        </span>\r\n      )\r\n    );\r\n  }\r\n\r\n  private _onRenderVisiblePersonas(personas: IFacepilePersona[], singlePersona: boolean): JSX.Element[] {\r\n    return personas.map((persona: IFacepilePersona, index: number) => {\r\n      const personaControl: JSX.Element = singlePersona ? this._getPersonaControl(persona) : this._getPersonaCoinControl(persona);\r\n      return (\r\n        <li role=\"option\" key={`${singlePersona ? 'persona' : 'personaCoin'}-${index}`} className={this._classNames.member}>\r\n          {persona.onClick\r\n            ? this._getElementWithOnClickEvent(personaControl, persona, index)\r\n            : this._getElementWithoutOnClickEvent(personaControl, persona, index)}\r\n        </li>\r\n      );\r\n    });\r\n  }\r\n\r\n  private _getPersonaControl(persona: IFacepilePersona): JSX.Element {\r\n    const { getPersonaProps, personaSize } = this.props;\r\n    const personaStyles: Partial<IPersonaStyles> = {\r\n      details: {\r\n        flex: '1 0 auto'\r\n      }\r\n    };\r\n\r\n    return (\r\n      <Persona\r\n        imageInitials={persona.imageInitials}\r\n        imageUrl={persona.imageUrl}\r\n        initialsColor={persona.initialsColor}\r\n        allowPhoneInitials={persona.allowPhoneInitials}\r\n        text={persona.personaName}\r\n        size={personaSize}\r\n        {...(getPersonaProps ? getPersonaProps(persona) : null)}\r\n        styles={personaStyles}\r\n      />\r\n    );\r\n  }\r\n\r\n  private _getPersonaCoinControl(persona: IFacepilePersona): JSX.Element {\r\n    const { getPersonaProps, personaSize } = this.props;\r\n    return (\r\n      <PersonaCoin\r\n        imageInitials={persona.imageInitials}\r\n        imageUrl={persona.imageUrl}\r\n        initialsColor={persona.initialsColor}\r\n        allowPhoneInitials={persona.allowPhoneInitials}\r\n        text={persona.personaName}\r\n        size={personaSize}\r\n        {...(getPersonaProps ? getPersonaProps(persona) : null)}\r\n      />\r\n    );\r\n  }\r\n\r\n  private _getElementWithOnClickEvent(personaControl: JSX.Element, persona: IFacepilePersona, index: number): JSX.Element {\r\n    const { keytipProps } = persona;\r\n    return (\r\n      <FacepileButton\r\n        {...getNativeProps(persona, buttonProperties)}\r\n        {...this._getElementProps(persona, index)}\r\n        keytipProps={keytipProps}\r\n        onClick={this._onPersonaClick.bind(this, persona)}\r\n      >\r\n        {personaControl}\r\n      </FacepileButton>\r\n    );\r\n  }\r\n\r\n  private _getElementWithoutOnClickEvent(personaControl: JSX.Element, persona: IFacepilePersona, index: number): JSX.Element {\r\n    return (\r\n      <div {...getNativeProps(persona, buttonProperties)} {...this._getElementProps(persona, index)}>\r\n        {personaControl}\r\n      </div>\r\n    );\r\n  }\r\n\r\n  private _getElementProps(\r\n    persona: IFacepilePersona,\r\n    index: number\r\n  ): { key: React.Key; ['data-is-focusable']: boolean } & React.HTMLAttributes<HTMLDivElement> {\r\n    const { _classNames } = this;\r\n\r\n    return {\r\n      key: (!!persona.imageUrl ? 'i' : '') + index,\r\n      'data-is-focusable': true,\r\n      role: 'option',\r\n      className: _classNames.itemButton,\r\n      title: persona.personaName,\r\n      onMouseMove: this._onPersonaMouseMove.bind(this, persona),\r\n      onMouseOut: this._onPersonaMouseOut.bind(this, persona)\r\n    };\r\n  }\r\n\r\n  private _getOverflowElement(personasOverflow: IFacepilePersona[]): JSX.Element | null {\r\n    switch (this.props.overflowButtonType) {\r\n      case OverflowButtonType.descriptive:\r\n        return this._getDescriptiveOverflowElement(personasOverflow);\r\n      case OverflowButtonType.downArrow:\r\n        return this._getIconElement('ChevronDown');\r\n      case OverflowButtonType.more:\r\n        return this._getIconElement('More');\r\n      default:\r\n        return null;\r\n    }\r\n  }\r\n\r\n  private _getDescriptiveOverflowElement(personasOverflow: IFacepilePersona[]): JSX.Element | null {\r\n    const { personaSize } = this.props;\r\n    if (!personasOverflow || personasOverflow.length < 1) {\r\n      return null;\r\n    }\r\n\r\n    const personaNames: string = personasOverflow.map((p: IFacepilePersona) => p.personaName).join(', ');\r\n    const overflowButtonProps: IButtonProps = { ...{ title: personaNames }, ...this.props.overflowButtonProps };\r\n    const numPersonasNotPictured: number = Math.max(personasOverflow.length, 0);\r\n\r\n    const { _classNames } = this;\r\n\r\n    return (\r\n      <FacepileButton\r\n        {...overflowButtonProps}\r\n        ariaDescription={overflowButtonProps.title}\r\n        className={_classNames.descriptiveOverflowButton}\r\n      >\r\n        <PersonaCoin\r\n          size={personaSize}\r\n          onRenderInitials={this._renderInitialsNotPictured(numPersonasNotPictured)}\r\n          initialsColor={PersonaInitialsColor.transparent}\r\n        />\r\n      </FacepileButton>\r\n    );\r\n  }\r\n\r\n  private _getIconElement(icon: string): JSX.Element {\r\n    const { overflowButtonProps, personaSize } = this.props;\r\n    const overflowInitialsIcon = true;\r\n\r\n    const { _classNames } = this;\r\n\r\n    return (\r\n      <FacepileButton {...overflowButtonProps} className={_classNames.overflowButton}>\r\n        <PersonaCoin\r\n          size={personaSize}\r\n          onRenderInitials={this._renderInitials(icon, overflowInitialsIcon)}\r\n          initialsColor={PersonaInitialsColor.transparent}\r\n        />\r\n      </FacepileButton>\r\n    );\r\n  }\r\n  private _getAddNewElement(): JSX.Element {\r\n    const { addButtonProps, personaSize } = this.props;\r\n\r\n    const { _classNames } = this;\r\n\r\n    return (\r\n      <FacepileButton {...addButtonProps} className={_classNames.addButton}>\r\n        <PersonaCoin size={personaSize} onRenderInitials={this._renderInitials('AddFriend')} />\r\n      </FacepileButton>\r\n    );\r\n  }\r\n\r\n  private _onPersonaClick(persona: IFacepilePersona, ev?: React.MouseEvent<HTMLElement>): void {\r\n    persona.onClick!(ev, persona);\r\n    ev!.preventDefault();\r\n    ev!.stopPropagation();\r\n  }\r\n\r\n  private _onPersonaMouseMove(persona: IFacepilePersona, ev?: React.MouseEvent<HTMLElement>): void {\r\n    if (!!persona.onMouseMove) {\r\n      persona.onMouseMove(ev, persona);\r\n    }\r\n  }\r\n\r\n  private _onPersonaMouseOut(persona: IFacepilePersona, ev?: React.MouseEvent<HTMLElement>): void {\r\n    if (!!persona.onMouseOut) {\r\n      persona.onMouseOut(ev, persona);\r\n    }\r\n  }\r\n\r\n  private _renderInitials(iconName: string, overflowButton?: boolean): () => JSX.Element {\r\n    const { _classNames } = this;\r\n\r\n    return (): JSX.Element => {\r\n      return <Icon iconName={iconName} className={overflowButton ? _classNames.overflowInitialsIcon : ''} />;\r\n    };\r\n  }\r\n\r\n  private _renderInitialsNotPictured(numPersonasNotPictured: number): () => JSX.Element {\r\n    const { _classNames } = this;\r\n\r\n    return (): JSX.Element => {\r\n      return <span className={_classNames.overflowInitialsIcon}>{'+' + numPersonasNotPictured}</span>;\r\n    };\r\n  }\r\n}\r\n"]}