{"version":3,"file":"Selection.Basic.Example.js","sourceRoot":"../src/","sources":["utilities/selection/examples/Selection.Basic.Example.tsx"],"names":[],"mappings":"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","sourcesContent":["import * as React from 'react';\r\nimport { CommandBar } from 'office-ui-fabric-react/lib/CommandBar';\r\nimport { Check } from 'office-ui-fabric-react/lib/Check';\r\nimport { IContextualMenuItem } from 'office-ui-fabric-react/lib/ContextualMenu';\r\nimport { MarqueeSelection } from 'office-ui-fabric-react/lib/MarqueeSelection';\r\nimport { ISelection, Selection, SelectionMode, SelectionZone } from 'office-ui-fabric-react/lib/Selection';\r\nimport { createListItems, IExampleItem } from 'office-ui-fabric-react/lib/utilities/exampleData';\r\nimport { mergeStyleSets, IRawStyle } from 'office-ui-fabric-react/lib/Styling';\r\nimport { memoizeFunction } from 'office-ui-fabric-react/lib/Utilities';\r\n\r\nconst commonStyles: IRawStyle = {\r\n  display: 'inline-block',\r\n  cursor: 'default',\r\n  boxSizing: 'border-box',\r\n  verticalAlign: 'top',\r\n  background: 'none',\r\n  backgroundColor: 'transparent',\r\n  border: 'none'\r\n};\r\nconst classNames = mergeStyleSets({\r\n  item: {\r\n    selectors: {\r\n      '&:hover': { background: '#eee' }\r\n    }\r\n  },\r\n  // Overwrites the default style for Button\r\n  check: [commonStyles, { padding: '11px 8px' }],\r\n  cell: [\r\n    commonStyles,\r\n    {\r\n      overflow: 'hidden',\r\n      height: 36,\r\n      padding: 8\r\n    }\r\n  ]\r\n});\r\n\r\nconst ITEM_COUNT = 100;\r\n\r\nexport interface ISelectionBasicExampleState {\r\n  items: IExampleItem[];\r\n  selection: ISelection;\r\n  selectionMode: SelectionMode;\r\n  canSelect: 'all' | 'vowels';\r\n}\r\n\r\nexport interface ISelectionItemExampleProps {\r\n  item: IExampleItem;\r\n  itemIndex?: number;\r\n  selection?: ISelection;\r\n  selectionMode?: SelectionMode;\r\n}\r\n\r\n/**\r\n * The SelectionItemExample controls and displays the selection state of a single item\r\n */\r\nexport const SelectionItemExample: React.StatelessComponent<ISelectionItemExampleProps> = (props: ISelectionItemExampleProps) => {\r\n  const { item, itemIndex, selection } = props;\r\n  let isSelected = false;\r\n\r\n  if (selection && itemIndex !== undefined) {\r\n    isSelected = selection.isIndexSelected(itemIndex);\r\n  }\r\n\r\n  return (\r\n    <div className={classNames.item} data-is-focusable={true} data-selection-index={itemIndex}>\r\n      {selection && selection.canSelectItem(item) && selection.mode !== SelectionMode.none && (\r\n        <div className={classNames.check} data-is-focusable={true} data-selection-toggle={true}>\r\n          <Check checked={isSelected} />\r\n        </div>\r\n      )}\r\n      <span className={classNames.cell}>{item.name}</span>\r\n      <a className={classNames.cell} href=\"https://bing.com\" target=\"_blank\">\r\n        Link that avoids selection\r\n      </a>\r\n      <a className={classNames.cell} data-selection-select={true} href=\"https://bing.com\" target=\"_blank\">\r\n        Link that selects first\r\n      </a>\r\n    </div>\r\n  );\r\n};\r\n\r\n/**\r\n * The SelectionBasicExample controls the selection state of all items\r\n */\r\nexport class SelectionBasicExample extends React.Component<{}, ISelectionBasicExampleState> {\r\n  private _hasMounted: boolean;\r\n\r\n  constructor(props: {}) {\r\n    super(props);\r\n\r\n    this._hasMounted = false;\r\n    // Memoizing this means that given the same parameters, it will return the same array of command objects\r\n    // (performance optimization)\r\n    this._getCommandItems = memoizeFunction(this._getCommandItems);\r\n\r\n    this.state = {\r\n      items: createListItems(ITEM_COUNT),\r\n      selection: new Selection({ onSelectionChanged: this._onSelectionChanged }),\r\n      selectionMode: SelectionMode.multiple,\r\n      canSelect: 'all'\r\n    };\r\n    this.state.selection.setItems(this.state.items, false);\r\n  }\r\n\r\n  public componentDidMount(): void {\r\n    this._hasMounted = true;\r\n  }\r\n\r\n  public render(): JSX.Element {\r\n    const { items, selection, canSelect } = this.state;\r\n\r\n    return (\r\n      <div className=\"ms-SelectionBasicExample\">\r\n        <CommandBar items={this._getCommandItems(selection.mode, canSelect)} />\r\n        <MarqueeSelection selection={selection} isEnabled={selection.mode === SelectionMode.multiple}>\r\n          <SelectionZone selection={selection} onItemInvoked={this._alertItem}>\r\n            {items.map((item: IExampleItem, index: number) => (\r\n              <SelectionItemExample key={item.key} item={item} itemIndex={index} selection={selection} />\r\n            ))}\r\n          </SelectionZone>\r\n        </MarqueeSelection>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  private _alertItem = (item: IExampleItem): void => {\r\n    alert('item invoked: ' + item.name);\r\n  };\r\n\r\n  private _onSelectionChanged = (): void => {\r\n    if (this._hasMounted) {\r\n      this.forceUpdate();\r\n    }\r\n  };\r\n\r\n  private _onToggleSelectAll = (): void => {\r\n    const { selection } = this.state;\r\n    selection.toggleAllSelected();\r\n  };\r\n\r\n  private _onSelectionModeChanged = (ev: React.MouseEvent<HTMLElement>, menuItem: IContextualMenuItem): void => {\r\n    this.setState((previousState: ISelectionBasicExampleState) => {\r\n      const newSelection = new Selection({\r\n        onSelectionChanged: this._onSelectionChanged,\r\n        canSelectItem: previousState.canSelect === 'vowels' ? this._canSelectItem : undefined,\r\n        selectionMode: menuItem.data\r\n      });\r\n      newSelection.setItems(previousState.items, false);\r\n\r\n      return {\r\n        selection: newSelection\r\n      };\r\n    });\r\n  };\r\n\r\n  private _onCanSelectChanged = (ev: React.MouseEvent<HTMLElement>, menuItem: IContextualMenuItem): void => {\r\n    const canSelectItem = menuItem.data === 'vowels' ? this._canSelectItem : undefined;\r\n\r\n    this.setState((previousState: ISelectionBasicExampleState) => {\r\n      const newSelection = new Selection({\r\n        onSelectionChanged: this._onSelectionChanged,\r\n        canSelectItem: canSelectItem,\r\n        selectionMode: previousState.selection.mode\r\n      });\r\n      newSelection.setItems(previousState.items, false);\r\n      return {\r\n        selection: newSelection,\r\n        canSelect: menuItem.data === 'vowels' ? 'vowels' : 'all'\r\n      };\r\n    });\r\n  };\r\n\r\n  private _canSelectItem = (item: IExampleItem): boolean => {\r\n    return /^[aeiou]/.test(item.name || '');\r\n  };\r\n\r\n  private _getCommandItems = (selectionMode: SelectionMode, canSelect: 'all' | 'vowels'): IContextualMenuItem[] => {\r\n    return [\r\n      {\r\n        key: 'selectionMode',\r\n        text: 'Selection Mode',\r\n        items: [\r\n          {\r\n            key: SelectionMode[SelectionMode.none],\r\n            name: 'None',\r\n            canCheck: true,\r\n            checked: selectionMode === SelectionMode.none,\r\n            onClick: this._onSelectionModeChanged,\r\n            data: SelectionMode.none\r\n          },\r\n          {\r\n            key: SelectionMode[SelectionMode.single],\r\n            name: 'Single select',\r\n            canCheck: true,\r\n            checked: selectionMode === SelectionMode.single,\r\n            onClick: this._onSelectionModeChanged,\r\n            data: SelectionMode.single\r\n          },\r\n          {\r\n            key: SelectionMode[SelectionMode.multiple],\r\n            name: 'Multi select',\r\n            canCheck: true,\r\n            checked: selectionMode === SelectionMode.multiple,\r\n            onClick: this._onSelectionModeChanged,\r\n            data: SelectionMode.multiple\r\n          }\r\n        ]\r\n      },\r\n      {\r\n        key: 'selectAll',\r\n        text: 'Select All',\r\n        iconProps: { iconName: 'CheckMark' },\r\n        onClick: this._onToggleSelectAll\r\n      },\r\n      {\r\n        key: 'allowCanSelect',\r\n        text: 'Choose selectable items',\r\n        items: [\r\n          {\r\n            key: 'all',\r\n            name: 'All items',\r\n            canCheck: true,\r\n            checked: canSelect === 'all',\r\n            onClick: this._onCanSelectChanged,\r\n            data: 'all'\r\n          },\r\n          {\r\n            key: 'a',\r\n            name: 'Names starting with vowels',\r\n            canCheck: true,\r\n            checked: canSelect === 'vowels',\r\n            onClick: this._onCanSelectChanged,\r\n            data: 'vowels'\r\n          }\r\n        ]\r\n      }\r\n    ];\r\n  };\r\n}\r\n"]}