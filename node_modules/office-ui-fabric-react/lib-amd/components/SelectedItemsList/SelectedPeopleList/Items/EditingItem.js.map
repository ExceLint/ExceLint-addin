{"version":3,"file":"EditingItem.js","sourceRoot":"../src/","sources":["components/SelectedItemsList/SelectedPeopleList/Items/EditingItem.tsx"],"names":[],"mappings":"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","sourcesContent":["/* tslint:disable */\r\nimport * as React from 'react';\r\n/* tslint:enable */\r\nimport { BaseComponent, KeyCodes, getId, getNativeProps, inputProperties, css } from '../../../../Utilities';\r\nimport { FloatingPeoplePicker, IBaseFloatingPickerProps } from '../../../../FloatingPicker';\r\nimport { ISelectedPeopleItemProps } from '../SelectedPeopleList';\r\nimport { IExtendedPersonaProps } from '../SelectedPeopleList';\r\nimport { IPeoplePickerItemState } from './ExtendedSelectedItem';\r\nimport { IPersonaProps } from '../../../../Persona';\r\n\r\nimport * as stylesImport from './EditingItem.scss';\r\n\r\n// tslint:disable-next-line:no-any\r\nconst styles: any = stylesImport;\r\n\r\nexport interface IEditingSelectedPeopleItemProps extends ISelectedPeopleItemProps {\r\n  // tslint:disable-next-line:no-any\r\n  onEditingComplete: (oldItem: any, newItem: any) => void;\r\n  onRenderFloatingPicker?: React.ComponentType<IBaseFloatingPickerProps<IPersonaProps>>;\r\n  floatingPickerProps?: IBaseFloatingPickerProps<IPersonaProps>;\r\n  getEditingItemText?: (item: IExtendedPersonaProps) => string;\r\n}\r\n\r\nexport class EditingItem extends BaseComponent<IEditingSelectedPeopleItemProps, IPeoplePickerItemState> {\r\n  private _editingInput: HTMLInputElement;\r\n  private _editingFloatingPicker = React.createRef<FloatingPeoplePicker>();\r\n\r\n  constructor(props: IEditingSelectedPeopleItemProps) {\r\n    super(props);\r\n    this.state = { contextualMenuVisible: false };\r\n  }\r\n\r\n  public componentDidMount(): void {\r\n    const getEditingItemText = this.props.getEditingItemText as (item: IExtendedPersonaProps) => string;\r\n    const itemText = getEditingItemText(this.props.item);\r\n\r\n    this._editingFloatingPicker.current && this._editingFloatingPicker.current.onQueryStringChanged(itemText);\r\n    this._editingInput.value = itemText;\r\n    this._editingInput.focus();\r\n  }\r\n\r\n  public render(): JSX.Element {\r\n    const itemId = getId();\r\n    const nativeProps = getNativeProps(this.props, inputProperties);\r\n    return (\r\n      <div aria-labelledby={'editingItemPersona-' + itemId} className={css('ms-EditingItem', styles.editingContainer)}>\r\n        <input\r\n          {...nativeProps}\r\n          ref={this._resolveInputRef}\r\n          autoCapitalize={'off'}\r\n          autoComplete={'off'}\r\n          onChange={this._onInputChange}\r\n          onKeyDown={this._onInputKeyDown}\r\n          onBlur={this._onInputBlur}\r\n          onClick={this._onInputClick}\r\n          data-lpignore={true}\r\n          className={styles.editingInput}\r\n          id={itemId}\r\n        />\r\n        {this._renderEditingSuggestions()}\r\n      </div>\r\n    );\r\n  }\r\n\r\n  private _renderEditingSuggestions = (): JSX.Element => {\r\n    const FloatingPicker = this.props.onRenderFloatingPicker;\r\n    const floatingPickerProps = this.props.floatingPickerProps;\r\n    if (!FloatingPicker || !floatingPickerProps) {\r\n      return <></>;\r\n    }\r\n    return (\r\n      <FloatingPicker\r\n        componentRef={this._editingFloatingPicker}\r\n        onChange={this._onSuggestionSelected}\r\n        inputElement={this._editingInput}\r\n        selectedItems={[]}\r\n        {...floatingPickerProps}\r\n      />\r\n    );\r\n  };\r\n\r\n  private _resolveInputRef = (ref: HTMLInputElement): void => {\r\n    this._editingInput = ref;\r\n\r\n    this.forceUpdate(() => {\r\n      this._editingInput.focus();\r\n    });\r\n  };\r\n\r\n  private _onInputClick = (): void => {\r\n    this._editingFloatingPicker.current && this._editingFloatingPicker.current.showPicker(true /*updatevalue*/);\r\n  };\r\n\r\n  private _onInputBlur = (ev: React.FocusEvent<HTMLElement>): void => {\r\n    if (this._editingFloatingPicker.current && ev.relatedTarget !== null) {\r\n      const target = ev.relatedTarget as HTMLElement;\r\n      if (target.className.indexOf('ms-Suggestions-itemButton') === -1 && target.className.indexOf('ms-Suggestions-sectionButton') === -1) {\r\n        this._editingFloatingPicker.current.forceResolveSuggestion();\r\n      }\r\n    }\r\n  };\r\n\r\n  private _onInputChange = (ev: React.FormEvent<HTMLElement>): void => {\r\n    const value: string = (ev.target as HTMLInputElement).value;\r\n\r\n    if (value === '') {\r\n      if (this.props.onRemoveItem) {\r\n        this.props.onRemoveItem();\r\n      }\r\n    } else {\r\n      this._editingFloatingPicker.current && this._editingFloatingPicker.current.onQueryStringChanged(value);\r\n    }\r\n  };\r\n\r\n  private _onInputKeyDown(ev: React.KeyboardEvent<HTMLInputElement>): void {\r\n    if (ev.which === KeyCodes.backspace || ev.which === KeyCodes.del) {\r\n      ev.stopPropagation();\r\n    }\r\n  }\r\n\r\n  private _onSuggestionSelected = (item: IExtendedPersonaProps): void => {\r\n    this.props.onEditingComplete(this.props.item, item);\r\n  };\r\n}\r\n"]}