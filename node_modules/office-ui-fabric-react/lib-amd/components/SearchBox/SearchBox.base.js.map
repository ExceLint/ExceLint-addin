{"version":3,"file":"SearchBox.base.js","sourceRoot":"../src/","sources":["components/SearchBox/SearchBox.base.tsx"],"names":[],"mappings":"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","sourcesContent":["import * as React from 'react';\r\nimport { ISearchBoxProps, ISearchBoxStyleProps, ISearchBoxStyles } from './SearchBox.types';\r\nimport { BaseComponent, getId, KeyCodes, classNamesFunction, getNativeProps, inputProperties } from '../../Utilities';\r\n\r\nimport { IconButton } from '../../Button';\r\nimport { Icon } from '../../Icon';\r\n\r\nconst getClassNames = classNamesFunction<ISearchBoxStyleProps, ISearchBoxStyles>();\r\n\r\nexport interface ISearchBoxState {\r\n  value?: string;\r\n  hasFocus?: boolean;\r\n  id?: string;\r\n}\r\n\r\nexport class SearchBoxBase extends BaseComponent<ISearchBoxProps, ISearchBoxState> {\r\n  public static defaultProps: Pick<ISearchBoxProps, 'disableAnimation' | 'clearButtonProps'> = {\r\n    disableAnimation: false,\r\n    clearButtonProps: { ariaLabel: 'Clear text' }\r\n  };\r\n\r\n  private _rootElement = React.createRef<HTMLDivElement>();\r\n  private _inputElement = React.createRef<HTMLInputElement>();\r\n  private _latestValue: string;\r\n\r\n  public constructor(props: ISearchBoxProps) {\r\n    super(props);\r\n\r\n    this._warnDeprecations({\r\n      labelText: 'placeholder',\r\n      defaultValue: 'value'\r\n    });\r\n\r\n    this._latestValue = props.value || '';\r\n\r\n    this.state = {\r\n      value: this._latestValue,\r\n      hasFocus: false,\r\n      id: getId('SearchBox')\r\n    };\r\n  }\r\n\r\n  public componentWillReceiveProps(newProps: ISearchBoxProps): void {\r\n    if (newProps.value !== undefined) {\r\n      this._latestValue = newProps.value;\r\n      // If the user passes in null, substitute an empty string\r\n      // (passing null is not allowed per typings, but users might do it anyway)\r\n      this.setState({\r\n        value: newProps.value || ''\r\n      });\r\n    }\r\n  }\r\n\r\n  public render() {\r\n    const {\r\n      ariaLabel,\r\n      placeholder,\r\n      className,\r\n      disabled,\r\n      underlined,\r\n      styles,\r\n      labelText,\r\n      theme,\r\n      clearButtonProps,\r\n      disableAnimation,\r\n      iconProps\r\n    } = this.props;\r\n    const { value, hasFocus, id } = this.state;\r\n    const placeholderValue = labelText === undefined ? placeholder : labelText;\r\n\r\n    const classNames = getClassNames(styles!, {\r\n      theme: theme!,\r\n      className,\r\n      underlined,\r\n      hasFocus,\r\n      disabled,\r\n      hasInput: value!.length > 0,\r\n      disableAnimation\r\n    });\r\n\r\n    const nativeProps = getNativeProps(this.props, inputProperties, ['id', 'className', 'placeholder', 'onFocus', 'onBlur', 'value']);\r\n\r\n    return (\r\n      <div ref={this._rootElement} className={classNames.root} onFocusCapture={this._onFocusCapture}>\r\n        <div className={classNames.iconContainer} onClick={this._onClickFocus} aria-hidden={true}>\r\n          <Icon iconName=\"Search\" {...iconProps} className={classNames.icon} />\r\n        </div>\r\n        <input\r\n          {...nativeProps}\r\n          id={id}\r\n          className={classNames.field}\r\n          placeholder={placeholderValue}\r\n          onChange={this._onInputChange}\r\n          onInput={this._onInputChange}\r\n          onKeyDown={this._onKeyDown}\r\n          value={value}\r\n          disabled={disabled}\r\n          aria-label={ariaLabel ? ariaLabel : placeholder}\r\n          ref={this._inputElement}\r\n        />\r\n        {value!.length > 0 && (\r\n          <div className={classNames.clearButton}>\r\n            <IconButton\r\n              styles={{ root: { height: 'auto' }, icon: { fontSize: '12px' } }}\r\n              iconProps={{ iconName: 'Clear' }}\r\n              {...clearButtonProps}\r\n              onClick={this._onClearClick}\r\n            />\r\n          </div>\r\n        )}\r\n      </div>\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Sets focus to the search box input field\r\n   */\r\n  public focus() {\r\n    if (this._inputElement.current) {\r\n      this._inputElement.current.focus();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Returns whether or not the SearchBox has focus\r\n   */\r\n  public hasFocus(): boolean {\r\n    return !!this.state.hasFocus;\r\n  }\r\n\r\n  private _onClear(ev: React.MouseEvent<HTMLAnchorElement | HTMLButtonElement> | React.KeyboardEvent<HTMLElement>) {\r\n    this.props.onClear && this.props.onClear(ev);\r\n    if (!ev.defaultPrevented) {\r\n      this._latestValue = '';\r\n      this.setState({\r\n        value: ''\r\n      });\r\n      this._callOnChange('');\r\n      ev.stopPropagation();\r\n      ev.preventDefault();\r\n\r\n      this.focus();\r\n    }\r\n  }\r\n\r\n  private _onClickFocus = () => {\r\n    const inputElement = this._inputElement.current;\r\n    if (inputElement) {\r\n      this.focus();\r\n      inputElement.selectionStart = inputElement.selectionEnd = 0;\r\n    }\r\n  };\r\n\r\n  private _onFocusCapture = (ev: React.FocusEvent<HTMLElement>) => {\r\n    this.setState({\r\n      hasFocus: true\r\n    });\r\n\r\n    this._events.on(ev.currentTarget, 'blur', this._onBlur, true);\r\n\r\n    if (this.props.onFocus) {\r\n      this.props.onFocus(ev as React.FocusEvent<HTMLInputElement>);\r\n    }\r\n  };\r\n\r\n  private _onClearClick = (ev: React.MouseEvent<HTMLAnchorElement | HTMLButtonElement>) => {\r\n    const { clearButtonProps } = this.props;\r\n\r\n    if (clearButtonProps && clearButtonProps.onClick) {\r\n      clearButtonProps.onClick(ev);\r\n    }\r\n\r\n    if (!ev.defaultPrevented) {\r\n      this._onClear(ev);\r\n    }\r\n  };\r\n\r\n  private _onKeyDown = (ev: React.KeyboardEvent<HTMLInputElement>) => {\r\n    switch (ev.which) {\r\n      case KeyCodes.escape:\r\n        this.props.onEscape && this.props.onEscape(ev);\r\n        if (!ev.defaultPrevented) {\r\n          this._onClear(ev);\r\n        }\r\n        break;\r\n\r\n      case KeyCodes.enter:\r\n        if (this.props.onSearch) {\r\n          this.props.onSearch(this.state.value);\r\n        }\r\n        break;\r\n\r\n      default:\r\n        this.props.onKeyDown && this.props.onKeyDown(ev);\r\n        if (!ev.defaultPrevented) {\r\n          return;\r\n        }\r\n    }\r\n\r\n    // We only get here if the keypress has been handled,\r\n    // or preventDefault was called in case of default keyDown handler\r\n    ev.preventDefault();\r\n    ev.stopPropagation();\r\n  };\r\n\r\n  private _onBlur = (ev: React.FocusEvent<HTMLInputElement>): void => {\r\n    this._events.off(this._rootElement.current, 'blur');\r\n    this.setState({\r\n      hasFocus: false\r\n    });\r\n\r\n    if (this.props.onBlur) {\r\n      this.props.onBlur(ev);\r\n    }\r\n  };\r\n\r\n  private _onInputChange = (ev: React.ChangeEvent<HTMLInputElement>) => {\r\n    const value = ev.target.value;\r\n\r\n    if (value === this._latestValue) {\r\n      return;\r\n    }\r\n    this._latestValue = value;\r\n\r\n    this.setState({ value });\r\n    this._callOnChange(value);\r\n  };\r\n\r\n  private _callOnChange(newValue: string): void {\r\n    const { onChange, onChanged } = this.props;\r\n\r\n    // Call @deprecated method.\r\n    if (onChanged) {\r\n      onChanged(newValue);\r\n    }\r\n\r\n    if (onChange) {\r\n      onChange(newValue);\r\n    }\r\n  }\r\n}\r\n"]}