{"version":3,"file":"FocusTrapZone.js","sourceRoot":"../src/","sources":["components/FocusTrapZone/FocusTrapZone.tsx"],"names":[],"mappings":"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","sourcesContent":["import * as React from 'react';\nimport { modalize } from '@uifabric/utilities';\nimport {\n  elementContains,\n  getNativeProps,\n  divProperties,\n  getFirstTabbable,\n  getLastTabbable,\n  getNextElement,\n  getDocument,\n  focusAsync,\n  initializeComponentRef,\n  on,\n} from '../../Utilities';\nimport { IFocusTrapZone, IFocusTrapZoneProps } from './FocusTrapZone.types';\n\nexport class FocusTrapZone extends React.Component<IFocusTrapZoneProps, {}> implements IFocusTrapZone {\n  private static _focusStack: FocusTrapZone[] = [];\n\n  private _root = React.createRef<HTMLDivElement>();\n  private _firstBumper = React.createRef<HTMLDivElement>();\n  private _lastBumper = React.createRef<HTMLDivElement>();\n  private _hasFocus: boolean = false;\n  private _unmodalize?: () => void;\n\n  private _previouslyFocusedElementOutsideTrapZone: HTMLElement;\n  private _previouslyFocusedElementInTrapZone?: HTMLElement;\n  private _disposeFocusHandler: (() => void) | undefined;\n  private _disposeClickHandler: (() => void) | undefined;\n\n  public constructor(props: IFocusTrapZoneProps) {\n    super(props);\n    initializeComponentRef(this);\n  }\n\n  public componentDidMount(): void {\n    this._bringFocusIntoZone();\n    this._updateEventHandlers(this.props);\n\n    if (!this.props.disabled && this._root.current && this.props.enableAriaHiddenSiblings) {\n      this._unmodalize = modalize(this._root.current);\n    }\n  }\n\n  public UNSAFE_componentWillReceiveProps(nextProps: IFocusTrapZoneProps): void {\n    const { elementToFocusOnDismiss } = nextProps;\n    if (elementToFocusOnDismiss && this._previouslyFocusedElementOutsideTrapZone !== elementToFocusOnDismiss) {\n      this._previouslyFocusedElementOutsideTrapZone = elementToFocusOnDismiss;\n    }\n\n    this._updateEventHandlers(nextProps);\n  }\n\n  public componentDidUpdate(prevProps: IFocusTrapZoneProps) {\n    const prevForceFocusInsideTrap =\n      prevProps.forceFocusInsideTrap !== undefined ? prevProps.forceFocusInsideTrap : true;\n    const newForceFocusInsideTrap =\n      this.props.forceFocusInsideTrap !== undefined ? this.props.forceFocusInsideTrap : true;\n    const prevDisabled = prevProps.disabled !== undefined ? prevProps.disabled : false;\n    const newDisabled = this.props.disabled !== undefined ? this.props.disabled : false;\n\n    if ((!prevForceFocusInsideTrap && newForceFocusInsideTrap) || (prevDisabled && !newDisabled)) {\n      // Transition from forceFocusInsideTrap / FTZ disabled to enabled.\n      // Emulate what happens when a FocusTrapZone gets mounted.\n      this._bringFocusIntoZone();\n      if (!this._unmodalize && this._root.current && this.props.enableAriaHiddenSiblings) {\n        this._unmodalize = modalize(this._root.current);\n      }\n    } else if ((prevForceFocusInsideTrap && !newForceFocusInsideTrap) || (!prevDisabled && newDisabled)) {\n      // Transition from forceFocusInsideTrap / FTZ enabled to disabled.\n      // Emulate what happens when a FocusTrapZone gets unmounted.\n      this._returnFocusToInitiator();\n      if (this._unmodalize) {\n        this._unmodalize();\n      }\n    }\n  }\n\n  public componentWillUnmount(): void {\n    // don't handle return focus unless forceFocusInsideTrap is true or focus is still within FocusTrapZone\n    if (\n      !this.props.disabled ||\n      this.props.forceFocusInsideTrap ||\n      !elementContains(this._root.current, this._getDocument().activeElement as HTMLElement)\n    ) {\n      this._returnFocusToInitiator();\n    }\n\n    // Dispose of event handlers so their closures can be garbage-collected\n    if (this._disposeClickHandler) {\n      this._disposeClickHandler();\n      this._disposeClickHandler = undefined;\n    }\n\n    if (this._disposeFocusHandler) {\n      this._disposeFocusHandler();\n      this._disposeFocusHandler = undefined;\n    }\n\n    if (this._unmodalize) {\n      this._unmodalize();\n    }\n\n    // Dispose of element references so the DOM Nodes can be garbage-collected\n    delete this._previouslyFocusedElementInTrapZone;\n    delete this._previouslyFocusedElementOutsideTrapZone;\n  }\n\n  public render(): JSX.Element {\n    const { className, disabled = false, ariaLabelledBy } = this.props;\n    const divProps = getNativeProps<React.HTMLAttributes<HTMLDivElement>>(this.props, divProperties);\n\n    const bumperProps = {\n      'aria-hidden': true,\n      style: {\n        pointerEvents: 'none',\n        position: 'fixed', // 'fixed' prevents browsers from scrolling to bumpers when viewport does not contain them\n      },\n      tabIndex: disabled ? -1 : 0, // make bumpers tabbable only when enabled\n      'data-is-visible': true,\n    } as React.HTMLAttributes<HTMLDivElement>;\n\n    return (\n      <div\n        {...divProps}\n        className={className}\n        ref={this._root}\n        aria-labelledby={ariaLabelledBy}\n        onFocusCapture={this._onFocusCapture}\n        onFocus={this._onRootFocus}\n        onBlur={this._onRootBlur}\n      >\n        <div {...bumperProps} ref={this._firstBumper} onFocus={this._onFirstBumperFocus} />\n        {this.props.children}\n        <div {...bumperProps} ref={this._lastBumper} onFocus={this._onLastBumperFocus} />\n      </div>\n    );\n  }\n\n  public focus() {\n    // eslint-disable-next-line deprecation/deprecation\n    const { focusPreviouslyFocusedInnerElement, firstFocusableSelector, firstFocusableTarget } = this.props;\n\n    if (\n      focusPreviouslyFocusedInnerElement &&\n      this._previouslyFocusedElementInTrapZone &&\n      elementContains(this._root.current, this._previouslyFocusedElementInTrapZone)\n    ) {\n      // focus on the last item that had focus in the zone before we left the zone\n      this._focusAsync(this._previouslyFocusedElementInTrapZone);\n      return;\n    }\n\n    const focusSelector =\n      typeof firstFocusableSelector === 'string'\n        ? firstFocusableSelector\n        : firstFocusableSelector && firstFocusableSelector();\n\n    let _firstFocusableChild: HTMLElement | null = null;\n\n    if (this._root.current) {\n      if (typeof firstFocusableTarget === 'string') {\n        _firstFocusableChild = this._root.current.querySelector(firstFocusableTarget);\n      } else if (firstFocusableTarget) {\n        _firstFocusableChild = firstFocusableTarget(this._root.current);\n      } else if (focusSelector) {\n        _firstFocusableChild = this._root.current.querySelector('.' + focusSelector);\n      }\n\n      // Fall back to first element if query selector did not match any elements.\n      if (!_firstFocusableChild) {\n        _firstFocusableChild = getNextElement(\n          this._root.current,\n          this._root.current.firstChild as HTMLElement,\n          false,\n          false,\n          false,\n          true,\n        );\n      }\n    }\n    if (_firstFocusableChild) {\n      this._focusAsync(_firstFocusableChild);\n    }\n  }\n\n  private _focusAsync(element: HTMLElement): void {\n    if (!this._isBumper(element)) {\n      focusAsync(element);\n    }\n  }\n\n  private _onRootFocus = (ev: React.FocusEvent<HTMLDivElement>) => {\n    if (this.props.onFocus) {\n      this.props.onFocus(ev);\n    }\n\n    this._hasFocus = true;\n  };\n\n  private _onRootBlur = (ev: React.FocusEvent<HTMLDivElement>) => {\n    if (this.props.onBlur) {\n      this.props.onBlur(ev);\n    }\n\n    let relatedTarget = ev.relatedTarget;\n    if (ev.relatedTarget === null) {\n      // In IE11, due to lack of support, event.relatedTarget is always\n      // null making every onBlur call to be \"outside\" of the ComboBox\n      // even when it's not. Using document.activeElement is another way\n      // for us to be able to get what the relatedTarget without relying\n      // on the event\n      relatedTarget = this._getDocument().activeElement as Element;\n    }\n\n    if (!elementContains(this._root.current, relatedTarget as HTMLElement)) {\n      this._hasFocus = false;\n    }\n  };\n\n  private _onFirstBumperFocus = () => {\n    this._onBumperFocus(true);\n  };\n\n  private _onLastBumperFocus = () => {\n    this._onBumperFocus(false);\n  };\n\n  private _onBumperFocus = (isFirstBumper: boolean) => {\n    if (this.props.disabled) {\n      return;\n    }\n\n    const currentBumper = (isFirstBumper === this._hasFocus\n      ? this._lastBumper.current\n      : this._firstBumper.current) as HTMLElement;\n\n    if (this._root.current) {\n      const nextFocusable =\n        isFirstBumper === this._hasFocus\n          ? getLastTabbable(this._root.current, currentBumper, true, false)\n          : getFirstTabbable(this._root.current, currentBumper, true, false);\n\n      if (nextFocusable) {\n        if (this._isBumper(nextFocusable)) {\n          // This can happen when FTZ contains no tabbable elements.\n          // focus will take care of finding a focusable element in FTZ.\n          this.focus();\n        } else {\n          nextFocusable.focus();\n        }\n      }\n    }\n  };\n\n  private _bringFocusIntoZone(): void {\n    const { elementToFocusOnDismiss, disabled = false, disableFirstFocus = false } = this.props;\n\n    if (disabled) {\n      return;\n    }\n\n    FocusTrapZone._focusStack.push(this);\n\n    this._previouslyFocusedElementOutsideTrapZone = elementToFocusOnDismiss\n      ? elementToFocusOnDismiss\n      : (this._getDocument().activeElement as HTMLElement);\n    if (!disableFirstFocus && !elementContains(this._root.current, this._previouslyFocusedElementOutsideTrapZone)) {\n      this.focus();\n    }\n  }\n\n  private _returnFocusToInitiator(): void {\n    const { ignoreExternalFocusing } = this.props;\n\n    FocusTrapZone._focusStack = FocusTrapZone._focusStack.filter((value: FocusTrapZone) => {\n      return this !== value;\n    });\n\n    const doc = this._getDocument();\n    const activeElement = doc.activeElement as HTMLElement;\n    if (\n      !ignoreExternalFocusing &&\n      this._previouslyFocusedElementOutsideTrapZone &&\n      typeof this._previouslyFocusedElementOutsideTrapZone.focus === 'function' &&\n      (elementContains(this._root.current, activeElement) || activeElement === doc.body)\n    ) {\n      this._focusAsync(this._previouslyFocusedElementOutsideTrapZone);\n    }\n  }\n\n  private _updateEventHandlers(newProps: IFocusTrapZoneProps): void {\n    const { isClickableOutsideFocusTrap = false, forceFocusInsideTrap = true } = newProps;\n\n    if (forceFocusInsideTrap && !this._disposeFocusHandler) {\n      this._disposeFocusHandler = on(window, 'focus', this._forceFocusInTrap, true);\n    } else if (!forceFocusInsideTrap && this._disposeFocusHandler) {\n      this._disposeFocusHandler();\n      this._disposeFocusHandler = undefined;\n    }\n\n    if (!isClickableOutsideFocusTrap && !this._disposeClickHandler) {\n      this._disposeClickHandler = on(window, 'click', this._forceClickInTrap, true);\n    } else if (isClickableOutsideFocusTrap && this._disposeClickHandler) {\n      this._disposeClickHandler();\n      this._disposeClickHandler = undefined;\n    }\n  }\n\n  private _onFocusCapture = (ev: React.FocusEvent<HTMLDivElement>) => {\n    if (this.props.onFocusCapture) {\n      this.props.onFocusCapture(ev);\n    }\n\n    if (ev.target !== ev.currentTarget && !this._isBumper(ev.target)) {\n      // every time focus changes within the trap zone, remember the focused element so that\n      // it can be restored if focus leaves the pane and returns via keystroke (i.e. via a call to this.focus(true))\n      this._previouslyFocusedElementInTrapZone = ev.target as HTMLElement;\n    }\n  };\n\n  private _isBumper(element: HTMLElement): boolean {\n    return element === this._firstBumper.current || element === this._lastBumper.current;\n  }\n\n  private _forceFocusInTrap = (ev: FocusEvent): void => {\n    if (this.props.disabled) {\n      return;\n    }\n\n    if (FocusTrapZone._focusStack.length && this === FocusTrapZone._focusStack[FocusTrapZone._focusStack.length - 1]) {\n      const focusedElement = this._getDocument().activeElement as HTMLElement;\n\n      if (!elementContains(this._root.current, focusedElement)) {\n        this.focus();\n        this._hasFocus = true; // set focus here since we stop event propagation\n        ev.preventDefault();\n        ev.stopPropagation();\n      }\n    }\n  };\n\n  private _forceClickInTrap = (ev: MouseEvent): void => {\n    if (this.props.disabled) {\n      return;\n    }\n\n    if (FocusTrapZone._focusStack.length && this === FocusTrapZone._focusStack[FocusTrapZone._focusStack.length - 1]) {\n      const clickedElement = ev.target as HTMLElement;\n\n      if (clickedElement && !elementContains(this._root.current, clickedElement)) {\n        this.focus();\n        this._hasFocus = true; // set focus here since we stop event propagation\n        ev.preventDefault();\n        ev.stopPropagation();\n      }\n    }\n  };\n\n  private _getDocument(): Document {\n    return getDocument(this._root.current)!;\n  }\n}\n"]}