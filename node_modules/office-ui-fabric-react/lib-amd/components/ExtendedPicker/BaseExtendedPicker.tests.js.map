{"version":3,"file":"BaseExtendedPicker.tests.js","sourceRoot":"../src/","sources":["components/ExtendedPicker/BaseExtendedPicker.tests.tsx"],"names":[],"mappings":"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","sourcesContent":["/* tslint:disable:no-unused-variable */\r\nimport * as React from 'react';\r\nimport * as ReactDOM from 'react-dom';\r\nimport * as ReactTestUtils from 'react-dom/test-utils';\r\n/* tslint:enable:no-unused-variable */\r\nimport * as renderer from 'react-test-renderer';\r\n\r\nimport { IBaseExtendedPickerProps } from './BaseExtendedPicker.types';\r\nimport { BaseExtendedPicker } from './BaseExtendedPicker';\r\nimport { IBaseFloatingPickerProps, BaseFloatingPicker, SuggestionsStore } from '../FloatingPicker/index';\r\nimport { IBaseSelectedItemsListProps, ISelectedItemProps, BaseSelectedItemsList } from '../SelectedItemsList/index';\r\nimport { KeyCodes } from '../../Utilities';\r\n\r\nfunction onResolveSuggestions(text: string): ISimple[] {\r\n  return [\r\n    'black',\r\n    'blue',\r\n    'brown',\r\n    'cyan',\r\n    'green',\r\n    'magenta',\r\n    'mauve',\r\n    'orange',\r\n    'pink',\r\n    'purple',\r\n    'red',\r\n    'rose',\r\n    'violet',\r\n    'white',\r\n    'yellow'\r\n  ]\r\n    .filter((tag: string) => tag.toLowerCase().indexOf(text.toLowerCase()) === 0)\r\n    .map((item: string) => ({ key: item, name: item }));\r\n}\r\n\r\nconst BasePickerWithType = BaseFloatingPicker as new (props: IBaseFloatingPickerProps<ISimple>) => BaseFloatingPicker<\r\n  ISimple,\r\n  IBaseFloatingPickerProps<ISimple>\r\n>;\r\n\r\nconst BaseSelectedItemsListWithType = BaseSelectedItemsList as new (props: IBaseSelectedItemsListProps<ISimple>) => BaseSelectedItemsList<\r\n  ISimple,\r\n  IBaseSelectedItemsListProps<ISimple>\r\n>;\r\n\r\nconst basicSuggestionRenderer = (props: ISimple) => {\r\n  return <div> {props.name} </div>;\r\n};\r\n\r\nconst basicItemRenderer = (props: ISelectedItemProps<ISimple>) => {\r\n  return <div> {props.name} </div>;\r\n};\r\n\r\nconst basicRenderFloatingPicker = (props: IBaseFloatingPickerProps<ISimple>) => {\r\n  return <BasePickerWithType {...props} />;\r\n};\r\n\r\nconst basicRenderSelectedItemsList = (props: IBaseSelectedItemsListProps<ISimple>) => {\r\n  return <BaseSelectedItemsListWithType />;\r\n};\r\n\r\nconst floatingPickerProps = {\r\n  onResolveSuggestions: onResolveSuggestions,\r\n  onRenderSuggestionsItem: basicSuggestionRenderer,\r\n  suggestionsStore: new SuggestionsStore<ISimple>()\r\n};\r\n\r\nconst selectedItemsListProps: IBaseSelectedItemsListProps<ISimple> = {\r\n  onRenderItem: basicItemRenderer\r\n};\r\n\r\nexport interface ISimple {\r\n  key: string;\r\n  name: string;\r\n}\r\n\r\nexport type TypedBaseExtendedPicker = BaseExtendedPicker<ISimple, IBaseExtendedPickerProps<ISimple>>;\r\n\r\ndescribe('Pickers', () => {\r\n  describe('BasePicker', () => {\r\n    const BaseExtendedPickerWithType = BaseExtendedPicker as new (props: IBaseExtendedPickerProps<ISimple>) => BaseExtendedPicker<\r\n      ISimple,\r\n      IBaseExtendedPickerProps<ISimple>\r\n    >;\r\n\r\n    it('renders BaseExtendedPicker correctly', () => {\r\n      const component = renderer.create(\r\n        <BaseExtendedPickerWithType\r\n          floatingPickerProps={floatingPickerProps}\r\n          selectedItemsListProps={selectedItemsListProps}\r\n          onRenderSelectedItems={basicRenderSelectedItemsList}\r\n          onRenderFloatingPicker={basicRenderFloatingPicker}\r\n        />\r\n      );\r\n      const tree = component.toJSON();\r\n      expect(tree).toMatchSnapshot();\r\n    });\r\n\r\n    it('force resolves to the first suggestion', () => {\r\n      const root = document.createElement('div');\r\n      document.body.appendChild(root);\r\n\r\n      const picker: TypedBaseExtendedPicker = ReactDOM.render(\r\n        <BaseExtendedPickerWithType\r\n          floatingPickerProps={floatingPickerProps}\r\n          selectedItemsListProps={selectedItemsListProps}\r\n          onRenderSelectedItems={basicRenderSelectedItemsList}\r\n          onRenderFloatingPicker={basicRenderFloatingPicker}\r\n        />,\r\n        root\r\n      ) as TypedBaseExtendedPicker;\r\n\r\n      if (picker.inputElement) {\r\n        picker.inputElement.value = 'bl';\r\n      }\r\n\r\n      expect(picker.floatingPicker.current && picker.floatingPicker.current.suggestions.length).toBe(2);\r\n      expect(picker.floatingPicker.current && picker.floatingPicker.current.suggestions[0].name).toBe('black');\r\n\r\n      // Force resolve to the first suggestions\r\n      picker.floatingPicker.current && picker.floatingPicker.current.forceResolveSuggestion();\r\n      expect(picker.items.length).toBe(1);\r\n      expect(picker.items[0].name).toBe('black');\r\n\r\n      ReactDOM.unmountComponentAtNode(root);\r\n    });\r\n\r\n    it('Can hide and show picker', () => {\r\n      const root = document.createElement('div');\r\n      document.body.appendChild(root);\r\n\r\n      const picker: TypedBaseExtendedPicker = ReactDOM.render(\r\n        <BaseExtendedPickerWithType\r\n          floatingPickerProps={floatingPickerProps}\r\n          selectedItemsListProps={selectedItemsListProps}\r\n          onRenderSelectedItems={basicRenderSelectedItemsList}\r\n          onRenderFloatingPicker={basicRenderFloatingPicker}\r\n        />,\r\n        root\r\n      ) as TypedBaseExtendedPicker;\r\n\r\n      if (picker.inputElement) {\r\n        picker.inputElement.value = 'bl';\r\n      }\r\n\r\n      expect(picker.floatingPicker.current && picker.floatingPicker.current.isSuggestionsShown).toBeTruthy();\r\n      picker.floatingPicker.current && picker.floatingPicker.current.hidePicker();\r\n      expect(picker.floatingPicker.current && picker.floatingPicker.current.isSuggestionsShown).toBeFalsy();\r\n      picker.floatingPicker.current && picker.floatingPicker.current.showPicker();\r\n      expect(picker.floatingPicker.current && picker.floatingPicker.current.isSuggestionsShown).toBeTruthy();\r\n\r\n      ReactDOM.unmountComponentAtNode(root);\r\n    });\r\n\r\n    it('Completes the suggestion', () => {\r\n      const root = document.createElement('div');\r\n      document.body.appendChild(root);\r\n\r\n      const picker: TypedBaseExtendedPicker = ReactDOM.render(\r\n        <BaseExtendedPickerWithType\r\n          floatingPickerProps={floatingPickerProps}\r\n          selectedItemsListProps={selectedItemsListProps}\r\n          onRenderSelectedItems={basicRenderSelectedItemsList}\r\n          onRenderFloatingPicker={basicRenderFloatingPicker}\r\n        />,\r\n        root\r\n      ) as TypedBaseExtendedPicker;\r\n\r\n      if (picker.inputElement) {\r\n        picker.inputElement.value = 'bl';\r\n        ReactTestUtils.Simulate.keyDown(picker.inputElement, { which: KeyCodes.down });\r\n      }\r\n\r\n      picker.floatingPicker.current && picker.floatingPicker.current.completeSuggestion();\r\n      expect(picker.selectedItemsList.current && picker.selectedItemsList.current.items.length).toBe(1);\r\n      expect(picker.selectedItemsList.current && picker.selectedItemsList.current.items[0].name).toBe('blue');\r\n\r\n      ReactDOM.unmountComponentAtNode(root);\r\n    });\r\n  });\r\n});\r\n"]}