{"version":3,"file":"ExtendedPeoplePicker.Basic.Example.js","sourceRoot":"../src/","sources":["components/ExtendedPicker/examples/ExtendedPeoplePicker.Basic.Example.tsx"],"names":[],"mappings":";;;IAkBA,kCAAkC;IAClC,IAAM,MAAM,GAAQ,YAAY,CAAC;IAWjC;QAAsD,4DAA8C;QAOlG,0CAAY,KAAS;YAArB,YACE,kBAAM,KAAK,CAAC,SA0Gb;YAqCO,gCAA0B,GAAG,UAAC,EAAiC,EAAE,WAAoB;gBAC3F,KAAI,CAAC,QAAQ,CAAC,EAAE,mBAAmB,EAAE,WAAW,EAAE,CAAC,CAAC;YACtD,CAAC,CAAC;YAUM,sBAAgB,GAAG,UAAC,SAA+B;gBACzD,KAAI,CAAC,OAAO,GAAG,SAAS,CAAC;YAC3B,CAAC,CAAC;YAEM,8BAAwB,GAAG;gBACjC,IAAI,KAAI,CAAC,OAAO,EAAE;oBAChB,KAAI,CAAC,OAAO,CAAC,KAAK,EAAE,CAAC;iBACtB;YACH,CAAC,CAAC;YAEM,mBAAa,GAAG,UAAC,IAA2B;gBAClD,IAAI,KAAI,CAAC,KAAK,CAAC,mBAAmB,EAAE;oBAC1B,IAAA,2DAAsB,CAAgB;oBAC9C,IAAM,aAAa,GAAG,sBAAsB,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;oBAC3D,IAAM,QAAQ,GAAG,sBAAsB,CAAC;oBACxC,QAAQ,CAAC,MAAM,OAAf,QAAQ,GAAQ,aAAa,EAAE,CAAC,SAAK,KAAI,CAAC,sBAAsB,CAAC,IAAI,CAAC,GAAE;oBACxE,KAAI,CAAC,QAAQ,CAAC,EAAE,sBAAsB,EAAE,QAAQ,EAAE,CAAC,CAAC;iBACrD;qBAAM;oBACL,IAAI,KAAI,CAAC,OAAO,CAAC,iBAAiB,CAAC,OAAO,EAAE;wBAC1C,kCAAkC;wBACjC,KAAI,CAAC,OAAO,CAAC,iBAAiB,CAAC,OAA8B,CAAC,WAAW,CAAC,IAAI,EAAE,KAAI,CAAC,sBAAsB,CAAC,IAAW,CAAC,CAAC,CAAC;qBAC5H;iBACF;YACH,CAAC,CAAC;YAEM,yBAAmB,GAAG,UAAC,IAAmB;gBAC1C,IAAA,gBAAuD,EAArD,0BAAU,EAAE,8BAA0B,CAAgB;gBAC9D,IAAM,eAAe,GAAW,UAAU,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;gBACzD,IAAM,qBAAqB,GAAW,QAAQ,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;gBAE7D,IAAI,eAAe,IAAI,CAAC,EAAE;oBACxB,IAAM,SAAS,GAAoB,UAAU,CAAC,KAAK,CAAC,CAAC,EAAE,eAAe,CAAC,CAAC,MAAM,CAAC,UAAU,CAAC,KAAK,CAAC,eAAe,GAAG,CAAC,CAAC,CAAC,CAAC;oBACtH,KAAI,CAAC,QAAQ,CAAC,EAAE,UAAU,EAAE,SAAS,EAAE,CAAC,CAAC;iBAC1C;gBAED,IAAI,qBAAqB,IAAI,CAAC,EAAE;oBAC9B,IAAM,kBAAkB,GAAoB,QAAQ;yBACjD,KAAK,CAAC,CAAC,EAAE,qBAAqB,CAAC;yBAC/B,MAAM,CAAC,QAAQ,CAAC,KAAK,CAAC,qBAAqB,GAAG,CAAC,CAAC,CAAC,CAAC;oBACrD,KAAI,CAAC,QAAQ,CAAC,EAAE,gBAAgB,EAAE,kBAAkB,EAAE,CAAC,CAAC;iBACzD;YACH,CAAC,CAAC;YAEM,sBAAgB,GAAG,UAAC,UAAkB,EAAE,eAAgC;gBACtE,IAAA,qDAAmB,CAAgB;gBAC3C,IAAI,gBAAgB,GAAoB,EAAE,CAAC;gBAC3C,IAAI,UAAU,EAAE;oBACd,gBAAgB,GAAG,KAAI,CAAC,qBAAqB,CAAC,UAAU,CAAC,CAAC;oBAC1D,gBAAgB,GAAG,KAAI,CAAC,iBAAiB,CAAC,gBAAgB,EAAE,eAAe,CAAC,CAAC;iBAC9E;gBAED,IAAI,mBAAmB,EAAE;oBACvB,KAAI,CAAC,QAAQ,CAAC,EAAE,eAAe,EAAE,gBAAgB,EAAE,CAAC,CAAC;iBACtD;gBACD,OAAO,mBAAmB,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,KAAI,CAAC,wBAAwB,CAAC,gBAAgB,CAAC,CAAC;YACtF,CAAC,CAAC;YAEM,6BAAuB,GAAG,UAAC,eAAgC;gBACzD,IAAA,qDAAmB,CAAgB;gBACrC,IAAA,+CAAgB,CAAgB;gBACtC,gBAAgB,GAAG,KAAI,CAAC,iBAAiB,CAAC,gBAAgB,EAAE,KAAI,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC;gBAChF,IAAI,mBAAmB,EAAE;oBACvB,KAAI,CAAC,QAAQ,CAAC,EAAE,eAAe,EAAE,gBAAgB,EAAE,CAAC,CAAC;iBACtD;gBACD,OAAO,mBAAmB,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,KAAI,CAAC,wBAAwB,CAAC,gBAAgB,CAAC,CAAC;YACtF,CAAC,CAAC;YAeM,6BAAuB,GAAG;gBAChC,OAAO,OAAO,CACZ,KAAI,CAAC,OAAO,CAAC,cAAc,CAAC,OAAO;oBACjC,KAAI,CAAC,cAAc,CAAC,KAAI,CAAC,OAAO,CAAC,cAAc,CAAC,OAAO,CAAC,SAAS,CAAC;oBAClE,KAAI,CAAC,OAAO,CAAC,cAAc,CAAC,OAAO,CAAC,WAAW,CAAC,MAAM,KAAK,CAAC,CAC/D,CAAC;YACJ,CAAC,CAAC;YAEM,kCAA4B,GAAG;gBACrC,OAAO,KAAI,CAAC,OAAO,KAAK,SAAS,IAAI,KAAI,CAAC,OAAO,CAAC,YAAY,KAAK,IAAI,IAAI,KAAI,CAAC,OAAO,CAAC,YAAY,CAAC,KAAK,KAAK,EAAE,CAAC;YACpH,CAAC,CAAC;YAqBM,qBAAe,GAAG;gBACxB,KAAI,CAAC,QAAQ,CAAC,EAAE,mBAAmB,EAAE,IAAI,EAAE,CAAC,CAAC;YAC/C,CAAC,CAAC;YAWM,kBAAY,GAAG,UAAC,kBAAyC;gBAC/D,KAAI,CAAC,QAAQ,CAAC,EAAE,sBAAsB,EAAE,KAAI,CAAC,KAAK,CAAC,sBAAsB,CAAC,MAAM,CAAC,kBAAkB,CAAC,EAAE,CAAC,CAAC;YAC1G,CAAC,CAAC;YAEM,qBAAe,GAAG,UAAC,KAA8B;gBACvD,IAAM,QAAQ,GAAG,KAAI,CAAC,KAAK,CAAC,sBAAsB,CAAC,MAAM,CAAC,UAAA,KAAK,IAAI,OAAA,KAAK,CAAC,OAAO,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC,EAA3B,CAA2B,CAAC,CAAC;gBAChG,KAAI,CAAC,QAAQ,CAAC,EAAE,sBAAsB,EAAE,QAAQ,EAAE,CAAC,CAAC;YACtD,CAAC,CAAC;YAEM,oBAAc,GAAG,UAAC,KAAa;gBACrC,IAAI,KAAK,CAAC,OAAO,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC,EAAE;oBAC7B,OAAO,IAAI,CAAC;iBACb;qBAAM,IAAI,KAAK,CAAC,MAAM,GAAG,CAAC,EAAE;oBAC3B,OAAO,KAAK,CAAC;iBACd;qBAAM;oBACL,OAAO,KAAK,CAAC;iBACd;YACH,CAAC,CAAC;YAtSA,KAAI,CAAC,KAAK,GAAG;gBACX,UAAU,EAAE,0BAAM;gBAClB,gBAAgB,EAAE,uBAAG;gBACrB,mBAAmB,EAAE,IAAI;gBACzB,sBAAsB,EAAE,EAAE;gBAC1B,mBAAmB,EAAE,KAAK;gBAC1B,eAAe,EAAE,EAAE;aACpB,CAAC;YAEF,KAAI,CAAC,gBAAgB,GAAG;gBACtB,iBAAiB,EAAE,IAAI;gBACvB,gBAAgB,EAAE;oBAChB;wBACE,UAAU,EAAE;4BACV,OAAO,CACL,6BAAK,SAAS,EAAE,MAAM,CAAC,UAAU;;gCACb,GAAG;gCACpB,KAAI,CAAC,OAAO,IAAI,KAAI,CAAC,OAAO,CAAC,YAAY,IAAI,KAAI,CAAC,OAAO,CAAC,YAAY,CAAC,CAAC,CAAC,KAAI,CAAC,OAAO,CAAC,YAAY,CAAC,KAAK,CAAC,CAAC,CAAC,EAAE,CAC1G,CACP,CAAC;wBACJ,CAAC;wBACD,UAAU,EAAE;4BACV,OAAO,KAAI,CAAC,OAAO,KAAK,SAAS,IAAI,KAAI,CAAC,OAAO,CAAC,YAAY,KAAK,IAAI,IAAI,KAAI,CAAC,OAAO,CAAC,YAAY,CAAC,KAAK,CAAC,OAAO,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,CAAC;wBAC/H,CAAC;wBACD,SAAS,EAAE;4BACT,IAAI,KAAI,CAAC,OAAO,CAAC,cAAc,CAAC,OAAO,KAAK,IAAI,EAAE;gCAChD,KAAI,CAAC,OAAO,CAAC,cAAc,CAAC,OAAO,CAAC,sBAAsB,EAAE,CAAC;6BAC9D;wBACH,CAAC;wBACD,SAAS,EAAE,uBAAuB;qBACnC;oBACD;wBACE,UAAU,EAAE;4BACV,OAAO,6BAAK,SAAS,EAAE,MAAM,CAAC,UAAU,yBAA0B,CAAC;wBACrE,CAAC;wBACD,UAAU,EAAE,KAAI,CAAC,4BAA4B;qBAC9C;iBACF;gBACD,gBAAgB,EAAE;oBAChB;wBACE,UAAU,EAAE;4BACV,OAAO,6BAAK,SAAS,EAAE,MAAM,CAAC,UAAU,iBAAkB,CAAC;wBAC7D,CAAC;wBACD,UAAU,EAAE;4BACV,OAAO,CACL,KAAI,CAAC,OAAO,KAAK,SAAS;gCAC1B,KAAI,CAAC,OAAO,CAAC,cAAc,KAAK,SAAS;gCACzC,KAAI,CAAC,OAAO,CAAC,cAAc,CAAC,OAAO,KAAK,IAAI;gCAC5C,KAAI,CAAC,OAAO,CAAC,cAAc,CAAC,OAAO,CAAC,WAAW,CAAC,MAAM,KAAK,CAAC,CAC7D,CAAC;wBACJ,CAAC;qBACF;oBACD;wBACE,UAAU,EAAE;4BACV,OAAO,6BAAK,SAAS,EAAE,MAAM,CAAC,UAAU,sBAAuB,CAAC;wBAClE,CAAC;wBACD,SAAS,EAAE;4BACT,KAAI,CAAC,QAAQ,CAAC,EAAE,mBAAmB,EAAE,KAAK,EAAE,CAAC,CAAC;wBAChD,CAAC;wBACD,UAAU,EAAE;4BACV,OAAO,KAAI,CAAC,KAAK,CAAC,mBAAmB,IAAI,CAAC,KAAI,CAAC,4BAA4B,EAAE,CAAC;wBAChF,CAAC;wBACD,SAAS,EAAE,aAAa;qBACzB;iBACF;gBACD,qBAAqB,EAAE;oBACrB,OAAO,CAAC,KAAI,CAAC,4BAA4B,EAAE,CAAC;gBAC9C,CAAC;aACF,CAAC;YAEF,KAAI,CAAC,oBAAoB,GAAG;gBAC1B,gBAAgB,EAAE,IAAI,iCAAgB,EAAiB;gBACvD,oBAAoB,EAAE,KAAI,CAAC,gBAAgB;gBAC3C,eAAe,EAAE,KAAI,CAAC,gBAAgB;gBACtC,sBAAsB,EAAE,KAAI,CAAC,gBAAgB;gBAC7C,GAAG,EAAE,QAAQ;gBACb,kBAAkB,EAAE,KAAI,CAAC,mBAAmB;gBAC5C,eAAe,EAAE,KAAI,CAAC,cAAc;gBACpC,qBAAqB,EAAE,KAAI,CAAC,uBAAuB;gBACnD,gBAAgB,EAAE,KAAI,CAAC,uBAAuB;gBAC9C,cAAc,EAAE,KAAI,CAAC,eAAe;gBACpC,mBAAmB,EAAE;oBACnB,OAAO,CAAC,GAAG,CAAC,wBAAwB,CAAC,CAAC;gBACxC,CAAC;gBACD,kBAAkB,EAAE;oBAClB,OAAO,CAAC,GAAG,CAAC,uBAAuB,CAAC,CAAC;gBACvC,CAAC;aACF,CAAC;YAEF,KAAI,CAAC,uBAAuB,GAAG;gBAC7B,WAAW,EAAE,KAAI,CAAC,YAAY;gBAC9B,aAAa,EAAE,KAAI,CAAC,aAAa;gBACjC,kBAAkB,EAAE,QAAQ;gBAC5B,gBAAgB,EAAE,WAAW;gBAC7B,gBAAgB,EAAE,MAAM;gBACxB,kBAAkB,EAAE,KAAI,CAAC,mBAAmB;gBAC5C,sBAAsB,EAAE,qCAAoB;gBAC5C,mBAAmB,EAAE,KAAI,CAAC,oBAAoB;aAC/C,CAAC;YAEF,KAAI,CAAC,eAAe,GAAG;gBACrB,8BAA8B,EAAE,KAAI,CAAC,+BAA+B;gBACpE,YAAY,EAAE,qCAAyB,CAAC,GAAG;aAC5C,CAAC;;QACJ,CAAC;QAEM,iDAAM,GAAb;YACE,OAAO,CACL;gBACG,IAAI,CAAC,qBAAqB,EAAE;gBAC7B,oBAAC,eAAM,IAAC,KAAK,EAAC,sBAAsB,EAAC,cAAc,EAAE,KAAK,EAAE,QAAQ,EAAE,IAAI,CAAC,0BAA0B,GAAI;gBACzG,oBAAC,sBAAa,IAAC,IAAI,EAAC,WAAW,EAAC,OAAO,EAAE,IAAI,CAAC,wBAAwB,GAAI,CACtE,CACP,CAAC;QACJ,CAAC;QAEO,gEAAqB,GAA7B;YACE,OAAO,CACL,oBAAC,qCAAoB,IACnB,aAAa,EAAE,IAAI,CAAC,KAAK,CAAC,mBAAmB,CAAC,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,sBAAsB,CAAC,CAAC,CAAC,SAAS,EAC7F,eAAe,EAAE,IAAI,CAAC,KAAK,CAAC,mBAAmB,CAAC,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,eAAe,CAAC,CAAC,CAAC,SAAS,EACxF,WAAW,EAAE,IAAI,CAAC,KAAK,CAAC,mBAAmB,CAAC,CAAC,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC,CAAC,SAAS,EAC3E,cAAc,EAAE,IAAI,CAAC,KAAK,CAAC,mBAAmB,CAAC,CAAC,CAAC,IAAI,CAAC,eAAe,CAAC,CAAC,CAAC,SAAS,EACjF,mBAAmB,EAAE,IAAI,CAAC,oBAAoB,EAC9C,sBAAsB,EAAE,IAAI,CAAC,uBAAuB,EACpD,sBAAsB,EAAE,qCAAoB,EAC5C,qBAAqB,EAAE,sCAAkB,EACzC,SAAS,EAAE,iBAAiB,EAC5B,GAAG,EAAE,QAAQ,EACb,UAAU,EAAE;oBACV,MAAM,EAAE,UAAC,EAAsC,IAAK,OAAA,OAAO,CAAC,GAAG,CAAC,eAAe,CAAC,EAA5B,CAA4B;oBAChF,OAAO,EAAE,UAAC,EAAsC,IAAK,OAAA,OAAO,CAAC,GAAG,CAAC,gBAAgB,CAAC,EAA7B,CAA6B;oBAClF,YAAY,EAAE,eAAe;iBAC9B,EACD,YAAY,EAAE,IAAI,CAAC,gBAAgB,EACnC,eAAe,EAAE,IAAI,CAAC,aAAa,EAAE,EACrC,cAAc,EAAE,IAAI,CAAC,eAAe,GACpC,CACH,CAAC;QACJ,CAAC;QAMO,wDAAa,GAArB;YACE,OAAO,kDAAwB,IAAI,UAAW,CAAC;QACjD,CAAC;QAEO,8DAAmB,GAA3B,UAA4B,IAA2B;YACrD,OAAO,IAAI,CAAC,IAAc,CAAC;QAC7B,CAAC;QAqEO,uDAAY,GAApB,UAAqB,KAA8B;YACjD,IAAI,QAAQ,GAAG,EAAE,CAAC;YAClB,KAAK,CAAC,OAAO,CAAC,UAAC,IAA2B,EAAE,KAAa;gBACvD,QAAQ,IAAI,IAAI,CAAC,IAAI,CAAC;gBAEtB,IAAI,KAAK,GAAG,KAAK,CAAC,MAAM,GAAG,CAAC,EAAE;oBAC5B,QAAQ,IAAI,IAAI,CAAC;iBAClB;YACH,CAAC,CAAC,CAAC;YAEH,OAAO,QAAQ,CAAC;QAClB,CAAC;QAcO,+DAAoB,GAA5B,UAA6B,OAAsB,EAAE,QAAyB;YAC5E,IAAI,CAAC,QAAQ,IAAI,CAAC,QAAQ,CAAC,MAAM,IAAI,QAAQ,CAAC,MAAM,KAAK,CAAC,EAAE;gBAC1D,OAAO,KAAK,CAAC;aACd;YACD,OAAO,QAAQ,CAAC,MAAM,CAAC,UAAC,IAAmB,IAAK,OAAA,IAAI,CAAC,IAAI,KAAK,OAAO,CAAC,IAAI,EAA1B,CAA0B,CAAC,CAAC,MAAM,GAAG,CAAC,CAAC;QACzF,CAAC;QAEO,gEAAqB,GAA7B,UAA8B,UAAkB;YAAhD,iBAEC;YADC,OAAO,IAAI,CAAC,KAAK,CAAC,UAAU,CAAC,MAAM,CAAC,UAAC,IAAmB,IAAK,OAAA,KAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,IAAc,EAAE,UAAU,CAAC,EAAxD,CAAwD,CAAC,CAAC;QACzH,CAAC;QAEO,6DAAkB,GAA1B,UAA2B,IAAY,EAAE,UAAkB;YACzD,OAAO,IAAI,CAAC,WAAW,EAAE,CAAC,OAAO,CAAC,UAAU,CAAC,WAAW,EAAE,CAAC,KAAK,CAAC,CAAC;QACpE,CAAC;QAEO,4DAAiB,GAAzB,UAA0B,QAAyB,EAAE,aAA8B;YAAnF,iBAEC;YADC,OAAO,QAAQ,CAAC,MAAM,CAAC,UAAC,OAAsB,IAAK,OAAA,CAAC,KAAI,CAAC,oBAAoB,CAAC,OAAO,EAAE,aAAa,CAAC,EAAlD,CAAkD,CAAC,CAAC;QACzG,CAAC;QAMO,2DAAgB,GAAxB,UAAyB,OAAsB;YAC7C,OAAO,OAAO,CAAC,IAAc,CAAC;QAChC,CAAC;QAEO,mEAAwB,GAAhC,UAAiC,OAAwB;YACvD,kCAAkC;YAClC,OAAO,IAAI,OAAO,CAAkB,UAAC,OAAY,EAAE,MAAW,IAAK,OAAA,UAAU,CAAC,cAAM,OAAA,OAAO,CAAC,OAAO,CAAC,EAAhB,CAAgB,EAAE,GAAG,CAAC,EAAvC,CAAuC,CAAC,CAAC;QAC9G,CAAC;QAqBO,iEAAsB,GAA9B,UAA+B,IAA2B;YACxD,QAAQ,IAAI,CAAC,IAAI,EAAE;gBACjB,KAAK,WAAW;oBACd,OAAO,4BAAQ,CAAC;gBAClB,KAAK,WAAW;oBACd,OAAO,4BAAQ,CAAC;gBAClB;oBACE,OAAO,EAAE,CAAC;aACb;QACH,CAAC;QAEO,0EAA+B,GAAvC;YACE,OAAO,IAAI,CAAC;QACd,CAAC;QACH,uCAAC;IAAD,CAAC,AAhUD,CAAsD,KAAK,CAAC,SAAS,GAgUpE;IAhUY,4EAAgC","sourcesContent":["import * as React from 'react';\r\n\r\nimport { IPersonaProps } from 'office-ui-fabric-react/lib/Persona';\r\nimport { ExtendedPeoplePicker } from 'office-ui-fabric-react/lib/ExtendedPicker';\r\nimport { PrimaryButton } from 'office-ui-fabric-react/lib/Button';\r\nimport {\r\n  SuggestionsStore,\r\n  FloatingPeoplePicker,\r\n  IBaseFloatingPickerProps,\r\n  IBaseFloatingPickerSuggestionProps\r\n} from 'office-ui-fabric-react/lib/FloatingPicker';\r\nimport { ISelectedPeopleProps, SelectedPeopleList, IExtendedPersonaProps } from 'office-ui-fabric-react/lib/SelectedItemsList';\r\nimport { Toggle } from 'office-ui-fabric-react/lib/Toggle';\r\nimport { IFocusZoneProps, FocusZoneTabbableElements } from 'office-ui-fabric-react/lib/FocusZone';\r\n// Helper imports to generate data for this particular examples. Not exported by any package.\r\nimport { people, mru, groupOne, groupTwo } from './PeopleExampleData';\r\n\r\nimport * as stylesImport from './ExtendedPeoplePicker.Basic.Example.scss';\r\n// tslint:disable-next-line:no-any\r\nconst styles: any = stylesImport;\r\n\r\nexport interface IPeoplePickerExampleState {\r\n  peopleList: IPersonaProps[];\r\n  mostRecentlyUsed: IPersonaProps[];\r\n  searchMoreAvailable: boolean;\r\n  currentlySelectedItems: IExtendedPersonaProps[];\r\n  suggestionItems: IPersonaProps[];\r\n  controlledComponent: boolean;\r\n}\r\n\r\nexport class ExtendedPeoplePickerBasicExample extends React.Component<{}, IPeoplePickerExampleState> {\r\n  private _picker: ExtendedPeoplePicker;\r\n  private _floatingPickerProps: IBaseFloatingPickerProps<IPersonaProps>;\r\n  private _selectedItemsListProps: ISelectedPeopleProps;\r\n  private _focusZoneProps: IFocusZoneProps;\r\n  private _suggestionProps: IBaseFloatingPickerSuggestionProps;\r\n\r\n  constructor(props: {}) {\r\n    super(props);\r\n\r\n    this.state = {\r\n      peopleList: people,\r\n      mostRecentlyUsed: mru,\r\n      searchMoreAvailable: true,\r\n      currentlySelectedItems: [],\r\n      controlledComponent: false,\r\n      suggestionItems: []\r\n    };\r\n\r\n    this._suggestionProps = {\r\n      showRemoveButtons: true,\r\n      headerItemsProps: [\r\n        {\r\n          renderItem: () => {\r\n            return (\r\n              <div className={styles.headerItem}>\r\n                Use this address:{' '}\r\n                {this._picker && this._picker.inputElement && this._picker.inputElement ? this._picker.inputElement.value : ''}\r\n              </div>\r\n            );\r\n          },\r\n          shouldShow: () => {\r\n            return this._picker !== undefined && this._picker.inputElement !== null && this._picker.inputElement.value.indexOf('@') > -1;\r\n          },\r\n          onExecute: () => {\r\n            if (this._picker.floatingPicker.current !== null) {\r\n              this._picker.floatingPicker.current.forceResolveSuggestion();\r\n            }\r\n          },\r\n          ariaLabel: 'Use the typed address'\r\n        },\r\n        {\r\n          renderItem: () => {\r\n            return <div className={styles.headerItem}>Suggested Contacts</div>;\r\n          },\r\n          shouldShow: this._shouldShowSuggestedContacts\r\n        }\r\n      ],\r\n      footerItemsProps: [\r\n        {\r\n          renderItem: () => {\r\n            return <div className={styles.footerItem}>No results</div>;\r\n          },\r\n          shouldShow: () => {\r\n            return (\r\n              this._picker !== undefined &&\r\n              this._picker.floatingPicker !== undefined &&\r\n              this._picker.floatingPicker.current !== null &&\r\n              this._picker.floatingPicker.current.suggestions.length === 0\r\n            );\r\n          }\r\n        },\r\n        {\r\n          renderItem: () => {\r\n            return <div className={styles.footerItem}>Search for more</div>;\r\n          },\r\n          onExecute: () => {\r\n            this.setState({ searchMoreAvailable: false });\r\n          },\r\n          shouldShow: () => {\r\n            return this.state.searchMoreAvailable && !this._shouldShowSuggestedContacts();\r\n          },\r\n          ariaLabel: 'Search more'\r\n        }\r\n      ],\r\n      shouldSelectFirstItem: () => {\r\n        return !this._shouldShowSuggestedContacts();\r\n      }\r\n    };\r\n\r\n    this._floatingPickerProps = {\r\n      suggestionsStore: new SuggestionsStore<IPersonaProps>(),\r\n      onResolveSuggestions: this._onFilterChanged,\r\n      getTextFromItem: this._getTextFromItem,\r\n      pickerSuggestionsProps: this._suggestionProps,\r\n      key: 'normal',\r\n      onRemoveSuggestion: this._onRemoveSuggestion,\r\n      onValidateInput: this._validateInput,\r\n      onZeroQuerySuggestion: this._returnMostRecentlyUsed,\r\n      showForceResolve: this._shouldShowForceResolve,\r\n      onInputChanged: this._onInputChanged,\r\n      onSuggestionsHidden: () => {\r\n        console.log('FLOATINGPICKER: hidden');\r\n      },\r\n      onSuggestionsShown: () => {\r\n        console.log('FLOATINGPICKER: shown');\r\n      }\r\n    };\r\n\r\n    this._selectedItemsListProps = {\r\n      onCopyItems: this._onCopyItems,\r\n      onExpandGroup: this._onExpandItem,\r\n      removeMenuItemText: 'Remove',\r\n      copyMenuItemText: 'Copy name',\r\n      editMenuItemText: 'Edit',\r\n      getEditingItemText: this._getEditingItemText,\r\n      onRenderFloatingPicker: FloatingPeoplePicker,\r\n      floatingPickerProps: this._floatingPickerProps\r\n    };\r\n\r\n    this._focusZoneProps = {\r\n      shouldInputLoseFocusOnArrowKey: this._shouldInputLoseFocusOnArrowKey,\r\n      handleTabKey: FocusZoneTabbableElements.all\r\n    };\r\n  }\r\n\r\n  public render(): JSX.Element {\r\n    return (\r\n      <div>\r\n        {this._renderExtendedPicker()}\r\n        <Toggle label=\"Controlled component\" defaultChecked={false} onChange={this._toggleControlledComponent} />\r\n        <PrimaryButton text=\"Set focus\" onClick={this._onSetFocusButtonClicked} />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  private _renderExtendedPicker(): JSX.Element {\r\n    return (\r\n      <ExtendedPeoplePicker\r\n        selectedItems={this.state.controlledComponent ? this.state.currentlySelectedItems : undefined}\r\n        suggestionItems={this.state.controlledComponent ? this.state.suggestionItems : undefined}\r\n        onItemAdded={this.state.controlledComponent ? this._onItemAdded : undefined}\r\n        onItemsRemoved={this.state.controlledComponent ? this._onItemsRemoved : undefined}\r\n        floatingPickerProps={this._floatingPickerProps}\r\n        selectedItemsListProps={this._selectedItemsListProps}\r\n        onRenderFloatingPicker={FloatingPeoplePicker}\r\n        onRenderSelectedItems={SelectedPeopleList}\r\n        className={'ms-PeoplePicker'}\r\n        key={'normal'}\r\n        inputProps={{\r\n          onBlur: (ev: React.FocusEvent<HTMLInputElement>) => console.log('onBlur called'),\r\n          onFocus: (ev: React.FocusEvent<HTMLInputElement>) => console.log('onFocus called'),\r\n          'aria-label': 'People Picker'\r\n        }}\r\n        componentRef={this._setComponentRef}\r\n        headerComponent={this._renderHeader()}\r\n        focusZoneProps={this._focusZoneProps}\r\n      />\r\n    );\r\n  }\r\n\r\n  private _toggleControlledComponent = (ev: React.MouseEvent<HTMLElement>, toggleState: boolean): void => {\r\n    this.setState({ controlledComponent: toggleState });\r\n  };\r\n\r\n  private _renderHeader(): JSX.Element {\r\n    return <div data-is-focusable={true}>TO:</div>;\r\n  }\r\n\r\n  private _getEditingItemText(item: IExtendedPersonaProps): string {\r\n    return item.text as string;\r\n  }\r\n\r\n  private _setComponentRef = (component: ExtendedPeoplePicker): void => {\r\n    this._picker = component;\r\n  };\r\n\r\n  private _onSetFocusButtonClicked = (): void => {\r\n    if (this._picker) {\r\n      this._picker.focus();\r\n    }\r\n  };\r\n\r\n  private _onExpandItem = (item: IExtendedPersonaProps): void => {\r\n    if (this.state.controlledComponent) {\r\n      const { currentlySelectedItems } = this.state;\r\n      const indexToRemove = currentlySelectedItems.indexOf(item);\r\n      const newItems = currentlySelectedItems;\r\n      newItems.splice(indexToRemove, 1, ...this._getExpandedGroupItems(item));\r\n      this.setState({ currentlySelectedItems: newItems });\r\n    } else {\r\n      if (this._picker.selectedItemsList.current) {\r\n        // tslint:disable-next-line:no-any\r\n        (this._picker.selectedItemsList.current as SelectedPeopleList).replaceItem(item, this._getExpandedGroupItems(item as any));\r\n      }\r\n    }\r\n  };\r\n\r\n  private _onRemoveSuggestion = (item: IPersonaProps): void => {\r\n    const { peopleList, mostRecentlyUsed: mruState } = this.state;\r\n    const indexPeopleList: number = peopleList.indexOf(item);\r\n    const indexMostRecentlyUsed: number = mruState.indexOf(item);\r\n\r\n    if (indexPeopleList >= 0) {\r\n      const newPeople: IPersonaProps[] = peopleList.slice(0, indexPeopleList).concat(peopleList.slice(indexPeopleList + 1));\r\n      this.setState({ peopleList: newPeople });\r\n    }\r\n\r\n    if (indexMostRecentlyUsed >= 0) {\r\n      const newSuggestedPeople: IPersonaProps[] = mruState\r\n        .slice(0, indexMostRecentlyUsed)\r\n        .concat(mruState.slice(indexMostRecentlyUsed + 1));\r\n      this.setState({ mostRecentlyUsed: newSuggestedPeople });\r\n    }\r\n  };\r\n\r\n  private _onFilterChanged = (filterText: string, currentPersonas: IPersonaProps[]): Promise<IPersonaProps[]> | null => {\r\n    const { controlledComponent } = this.state;\r\n    let filteredPersonas: IPersonaProps[] = [];\r\n    if (filterText) {\r\n      filteredPersonas = this._filterPersonasByText(filterText);\r\n      filteredPersonas = this._removeDuplicates(filteredPersonas, currentPersonas);\r\n    }\r\n\r\n    if (controlledComponent) {\r\n      this.setState({ suggestionItems: filteredPersonas });\r\n    }\r\n    return controlledComponent ? null : this._convertResultsToPromise(filteredPersonas);\r\n  };\r\n\r\n  private _returnMostRecentlyUsed = (currentPersonas: IPersonaProps[]): IPersonaProps[] | Promise<IPersonaProps[]> | null => {\r\n    const { controlledComponent } = this.state;\r\n    let { mostRecentlyUsed } = this.state;\r\n    mostRecentlyUsed = this._removeDuplicates(mostRecentlyUsed, this._picker.items);\r\n    if (controlledComponent) {\r\n      this.setState({ suggestionItems: mostRecentlyUsed });\r\n    }\r\n    return controlledComponent ? null : this._convertResultsToPromise(mostRecentlyUsed);\r\n  };\r\n\r\n  private _onCopyItems(items: IExtendedPersonaProps[]): string {\r\n    let copyText = '';\r\n    items.forEach((item: IExtendedPersonaProps, index: number) => {\r\n      copyText += item.text;\r\n\r\n      if (index < items.length - 1) {\r\n        copyText += ', ';\r\n      }\r\n    });\r\n\r\n    return copyText;\r\n  }\r\n\r\n  private _shouldShowForceResolve = (): boolean => {\r\n    return Boolean(\r\n      this._picker.floatingPicker.current &&\r\n        this._validateInput(this._picker.floatingPicker.current.inputText) &&\r\n        this._picker.floatingPicker.current.suggestions.length === 0\r\n    );\r\n  };\r\n\r\n  private _shouldShowSuggestedContacts = (): boolean => {\r\n    return this._picker !== undefined && this._picker.inputElement !== null && this._picker.inputElement.value === '';\r\n  };\r\n\r\n  private _listContainsPersona(persona: IPersonaProps, personas: IPersonaProps[]): boolean {\r\n    if (!personas || !personas.length || personas.length === 0) {\r\n      return false;\r\n    }\r\n    return personas.filter((item: IPersonaProps) => item.text === persona.text).length > 0;\r\n  }\r\n\r\n  private _filterPersonasByText(filterText: string): IPersonaProps[] {\r\n    return this.state.peopleList.filter((item: IPersonaProps) => this._doesTextStartWith(item.text as string, filterText));\r\n  }\r\n\r\n  private _doesTextStartWith(text: string, filterText: string): boolean {\r\n    return text.toLowerCase().indexOf(filterText.toLowerCase()) === 0;\r\n  }\r\n\r\n  private _removeDuplicates(personas: IPersonaProps[], possibleDupes: IPersonaProps[]): IPersonaProps[] {\r\n    return personas.filter((persona: IPersonaProps) => !this._listContainsPersona(persona, possibleDupes));\r\n  }\r\n\r\n  private _onInputChanged = (): void => {\r\n    this.setState({ searchMoreAvailable: true });\r\n  };\r\n\r\n  private _getTextFromItem(persona: IPersonaProps): string {\r\n    return persona.text as string;\r\n  }\r\n\r\n  private _convertResultsToPromise(results: IPersonaProps[]): Promise<IPersonaProps[]> {\r\n    // tslint:disable-next-line:no-any\r\n    return new Promise<IPersonaProps[]>((resolve: any, reject: any) => setTimeout(() => resolve(results), 150));\r\n  }\r\n\r\n  private _onItemAdded = (selectedSuggestion: IExtendedPersonaProps) => {\r\n    this.setState({ currentlySelectedItems: this.state.currentlySelectedItems.concat(selectedSuggestion) });\r\n  };\r\n\r\n  private _onItemsRemoved = (items: IExtendedPersonaProps[]): void => {\r\n    const newItems = this.state.currentlySelectedItems.filter(value => items.indexOf(value) === -1);\r\n    this.setState({ currentlySelectedItems: newItems });\r\n  };\r\n\r\n  private _validateInput = (input: string): boolean => {\r\n    if (input.indexOf('@') !== -1) {\r\n      return true;\r\n    } else if (input.length > 1) {\r\n      return false;\r\n    } else {\r\n      return false;\r\n    }\r\n  };\r\n\r\n  private _getExpandedGroupItems(item: IExtendedPersonaProps): IExtendedPersonaProps[] {\r\n    switch (item.text) {\r\n      case 'Group One':\r\n        return groupOne;\r\n      case 'Group Two':\r\n        return groupTwo;\r\n      default:\r\n        return [];\r\n    }\r\n  }\r\n\r\n  private _shouldInputLoseFocusOnArrowKey(): boolean {\r\n    return true;\r\n  }\r\n}\r\n"]}