{"version":3,"file":"Announced.LazyLoading.Example.js","sourceRoot":"../src/","sources":["components/Announced/examples/Announced.LazyLoading.Example.tsx"],"names":[],"mappings":"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","sourcesContent":["import * as React from 'react';\r\nimport { Announced } from '../Announced';\r\nimport { createArray, createRef } from 'office-ui-fabric-react/lib/Utilities';\r\nimport { Image } from 'office-ui-fabric-react/lib/Image';\r\nimport { FocusZone } from 'office-ui-fabric-react/lib/FocusZone';\r\nimport { Text } from 'office-ui-fabric-react/lib/Text';\r\nimport { Stack } from 'office-ui-fabric-react/lib/Stack';\r\nimport { Toggle } from 'office-ui-fabric-react/lib/Toggle';\r\nimport { ProgressIndicator } from 'office-ui-fabric-react/lib/ProgressIndicator';\r\nimport { Async } from 'office-ui-fabric-react/lib/Utilities';\r\nimport './Announced.Example.scss';\r\n\r\nconst DELAY = 10;\r\n\r\nexport interface IAnnouncedLazyLoadingExampleState {\r\n  photos: { url: string; width: number; height: number }[];\r\n  total: number;\r\n  announced?: JSX.Element;\r\n  percentComplete: number;\r\n  loading: boolean;\r\n  complete: boolean;\r\n  timeSinceLastAnnounce: number;\r\n}\r\n\r\nexport interface IAnnouncedLazyLoadingExampleProps {}\r\n\r\nexport class AnnouncedLazyLoadingExample extends React.Component<IAnnouncedLazyLoadingExampleProps, IAnnouncedLazyLoadingExampleState> {\r\n  private _root = createRef<HTMLElement>();\r\n  private timer: number;\r\n  private increaseTotal: number;\r\n  private _async: Async;\r\n\r\n  constructor(props: {}) {\r\n    super(props);\r\n\r\n    this._async = new Async(this);\r\n\r\n    this.state = {\r\n      photos: this._createPhotos(),\r\n      total: 0,\r\n      announced: undefined,\r\n      percentComplete: 0,\r\n      loading: false,\r\n      complete: false,\r\n      timeSinceLastAnnounce: 0\r\n    };\r\n\r\n    this._renderPhotos = this._renderPhotos.bind(this);\r\n    this._renderAnnounced = this._renderAnnounced.bind(this);\r\n    this._onToggleChange = this._onToggleChange.bind(this);\r\n\r\n    this.increaseTotal = this._async.setInterval(() => {\r\n      if (this.state.loading && this.state.total < this.state.photos.length) {\r\n        this.setState({ total: this.state.total + 1 });\r\n      } else if (this.state.total === this.state.photos.length && this.state.complete !== true) {\r\n        this.setState({ complete: true, announced: undefined });\r\n      }\r\n    }, 2000);\r\n\r\n    this.timer = this._async.setInterval(() => {\r\n      if (this.state.loading && !this.state.complete) {\r\n        this.setState({ timeSinceLastAnnounce: this.state.timeSinceLastAnnounce + 1 });\r\n\r\n        if (this.state.timeSinceLastAnnounce === DELAY || this.state.percentComplete === 1) {\r\n          this.setState({\r\n            announced: <Announced message={`${this.state.total} of ${this.state.photos.length} photos loaded`} />,\r\n            timeSinceLastAnnounce: 0\r\n          });\r\n        }\r\n      }\r\n    }, 1000);\r\n  }\r\n\r\n  public render(): JSX.Element {\r\n    const { percentComplete } = this.state;\r\n\r\n    return (\r\n      <Stack gap={10}>\r\n        <Text>\r\n          Turn on Narrator and check the toggle to start loading photos. Announced should announce the number of photos loaded every 10\r\n          seconds, as that is the delay chosen for this example.\r\n        </Text>\r\n        <Toggle label=\"Check to start loading photos\" onText=\"Start/Resume\" offText=\"Pause\" onChange={this._onToggleChange} />\r\n        <ProgressIndicator label={percentComplete < 1 ? 'Loading photos' : 'Finished loading photos'} percentComplete={percentComplete} />\r\n        {this._renderAnnounced()}\r\n        <FocusZone as=\"ul\" className=\"ms-AnnouncedExamples-photoList\">\r\n          {this._renderPhotos()}\r\n        </FocusZone>\r\n      </Stack>\r\n    );\r\n  }\r\n\r\n  public componentWillUnmount(): void {\r\n    clearTimeout(this.timer);\r\n    clearTimeout(this.increaseTotal);\r\n  }\r\n\r\n  public componentDidUpdate(): void {\r\n    const percentComplete = this.state.total / this.state.photos.length;\r\n    if (percentComplete !== this.state.percentComplete && this.state.percentComplete < 1) {\r\n      this.setState({ percentComplete: percentComplete });\r\n    }\r\n  }\r\n\r\n  private _onToggleChange(): void {\r\n    this.setState({ loading: !this.state.loading });\r\n  }\r\n\r\n  private _renderAnnounced(): JSX.Element | undefined {\r\n    const { announced } = this.state;\r\n    return announced;\r\n  }\r\n\r\n  private _createPhotos(): { url: string; width: number; height: number }[] {\r\n    const width = 100;\r\n    const height = 100;\r\n\r\n    const result = createArray(30, () => {\r\n      return {\r\n        url: `http://placehold.it/${width}x${height}`,\r\n        width: width,\r\n        height: height\r\n      };\r\n    });\r\n    return result;\r\n  }\r\n\r\n  private _renderPhotos(): JSX.Element[] {\r\n    const result = this.state.photos.map((photo: { url: string; width: number; height: number }, index: number) => (\r\n      <ul\r\n        key={index}\r\n        className=\"ms-AnnouncedExamples-photoCell\"\r\n        aria-posinset={index + 1}\r\n        aria-setsize={this.state.photos.length}\r\n        aria-label=\"Photo\"\r\n        data-is-focusable={true}\r\n        ref={this._root}\r\n      >\r\n        {this.state.total > index ? <Image src={photo.url} width={photo.width} height={photo.height} /> : <div />}\r\n      </ul>\r\n    ));\r\n\r\n    return result;\r\n  }\r\n}\r\n"]}