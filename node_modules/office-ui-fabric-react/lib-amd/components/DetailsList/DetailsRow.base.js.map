{"version":3,"file":"DetailsRow.base.js","sourceRoot":"../src/","sources":["components/DetailsList/DetailsRow.base.tsx"],"names":[],"mappings":"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","sourcesContent":["import * as React from 'react';\r\nimport * as ReactDOM from 'react-dom';\r\nimport { BaseComponent, IDisposable, assign, css, shallowCompare, getNativeProps, divProperties } from '../../Utilities';\r\nimport { IColumn, CheckboxVisibility } from './DetailsList.types';\r\nimport { DetailsRowCheck } from './DetailsRowCheck';\r\nimport { GroupSpacer } from '../GroupedList/GroupSpacer';\r\nimport { DetailsRowFields } from './DetailsRowFields';\r\nimport { FocusZone, FocusZoneDirection, IFocusZone } from '../../FocusZone';\r\nimport { SelectionMode, SELECTION_CHANGE } from '../../utilities/selection/interfaces';\r\nimport { CollapseAllVisibility } from '../../GroupedList';\r\nimport { IDragDropOptions } from './../../utilities/dragdrop/interfaces';\r\nimport { IDetailsRowBaseProps } from './DetailsRow.types';\r\nimport { IDetailsRowCheckProps } from './DetailsRowCheck.types';\r\nimport { IDetailsRowStyleProps, IDetailsRowStyles } from './DetailsRow.types';\r\nimport { classNamesFunction } from '../../Utilities';\r\n\r\nconst getClassNames = classNamesFunction<IDetailsRowStyleProps, IDetailsRowStyles>();\r\n\r\nexport interface IDetailsRowSelectionState {\r\n  isSelected: boolean;\r\n  isSelectionModal: boolean;\r\n}\r\n\r\nexport interface IDetailsRowState {\r\n  selectionState?: IDetailsRowSelectionState;\r\n  columnMeasureInfo?: {\r\n    index: number;\r\n    column: IColumn;\r\n    onMeasureDone: (measuredWidth: number) => void;\r\n  };\r\n  isDropping?: boolean;\r\n  groupNestingDepth?: number;\r\n}\r\n\r\nconst DEFAULT_DROPPING_CSS_CLASS = 'is-dropping';\r\n\r\nconst NO_COLUMNS: IColumn[] = [];\r\n\r\nexport class DetailsRowBase extends BaseComponent<IDetailsRowBaseProps, IDetailsRowState> {\r\n  private _root: HTMLElement | undefined;\r\n  private _cellMeasurer = React.createRef<HTMLSpanElement>();\r\n  private _focusZone = React.createRef<IFocusZone>();\r\n  private _droppingClassNames: string;\r\n  private _hasMounted: boolean;\r\n  private _dragDropSubscription: IDisposable;\r\n\r\n  constructor(props: IDetailsRowBaseProps) {\r\n    super(props);\r\n\r\n    this.state = {\r\n      selectionState: this._getSelectionState(props),\r\n      columnMeasureInfo: undefined,\r\n      isDropping: false,\r\n      groupNestingDepth: props.groupNestingDepth\r\n    };\r\n\r\n    this._droppingClassNames = '';\r\n\r\n    this._updateDroppingState = this._updateDroppingState.bind(this);\r\n    this._onToggleSelection = this._onToggleSelection.bind(this);\r\n  }\r\n\r\n  public componentDidMount(): void {\r\n    const { dragDropHelper } = this.props;\r\n\r\n    if (dragDropHelper) {\r\n      this._dragDropSubscription = dragDropHelper.subscribe(this._root as HTMLElement, this._events, this._getRowDragDropOptions());\r\n    }\r\n\r\n    this._events.on(this.props.selection, SELECTION_CHANGE, this._onSelectionChanged);\r\n\r\n    if (this.props.onDidMount && this.props.item) {\r\n      // If the item appears later, we should wait for it before calling this method.\r\n      this._hasMounted = true;\r\n      this.props.onDidMount(this);\r\n    }\r\n  }\r\n\r\n  public componentDidUpdate(previousProps: IDetailsRowBaseProps) {\r\n    const state = this.state;\r\n    const { item, onDidMount } = this.props;\r\n    const { columnMeasureInfo } = state;\r\n\r\n    if (\r\n      this.props.itemIndex !== previousProps.itemIndex ||\r\n      this.props.item !== previousProps.item ||\r\n      this.props.dragDropHelper !== previousProps.dragDropHelper\r\n    ) {\r\n      if (this._dragDropSubscription) {\r\n        this._dragDropSubscription.dispose();\r\n        delete this._dragDropSubscription;\r\n      }\r\n\r\n      if (this.props.dragDropHelper) {\r\n        this._dragDropSubscription = this.props.dragDropHelper.subscribe(\r\n          this._root as HTMLElement,\r\n          this._events,\r\n          this._getRowDragDropOptions()\r\n        );\r\n      }\r\n    }\r\n\r\n    if (columnMeasureInfo && columnMeasureInfo.index >= 0 && this._cellMeasurer.current) {\r\n      const newWidth = this._cellMeasurer.current.getBoundingClientRect().width;\r\n\r\n      columnMeasureInfo.onMeasureDone(newWidth);\r\n\r\n      this.setState({\r\n        columnMeasureInfo: undefined\r\n      });\r\n    }\r\n\r\n    if (item && onDidMount && !this._hasMounted) {\r\n      this._hasMounted = true;\r\n      onDidMount(this);\r\n    }\r\n  }\r\n\r\n  public componentWillUnmount(): void {\r\n    const { item, onWillUnmount } = this.props;\r\n\r\n    // Only call the onWillUnmount callback if we have an item.\r\n    if (onWillUnmount && item) {\r\n      onWillUnmount(this);\r\n    }\r\n\r\n    if (this._dragDropSubscription) {\r\n      this._dragDropSubscription.dispose();\r\n      delete this._dragDropSubscription;\r\n    }\r\n  }\r\n\r\n  public componentWillReceiveProps(newProps: IDetailsRowBaseProps): void {\r\n    this.setState({\r\n      selectionState: this._getSelectionState(newProps),\r\n      groupNestingDepth: newProps.groupNestingDepth\r\n    });\r\n  }\r\n\r\n  public shouldComponentUpdate(nextProps: IDetailsRowBaseProps, nextState: IDetailsRowState): boolean {\r\n    if (this.props.useReducedRowRenderer) {\r\n      if (this.state.selectionState) {\r\n        const newSelectionState = this._getSelectionState(nextProps);\r\n        if (this.state.selectionState.isSelected !== newSelectionState.isSelected) {\r\n          return true;\r\n        }\r\n      }\r\n      return shallowCompare(this.props, nextProps);\r\n    } else {\r\n      return true;\r\n    }\r\n  }\r\n\r\n  public render(): JSX.Element {\r\n    const {\r\n      className,\r\n      columns = NO_COLUMNS,\r\n      dragDropEvents,\r\n      item,\r\n      itemIndex,\r\n      onRenderCheck = this._onRenderCheck,\r\n      onRenderItemColumn,\r\n      selectionMode,\r\n      viewport,\r\n      checkboxVisibility,\r\n      getRowAriaLabel,\r\n      getRowAriaDescribedBy,\r\n      checkButtonAriaLabel,\r\n      checkboxCellClassName,\r\n      /** Alias rowFieldsAs as RowFields and default to DetailsRowFields if rowFieldsAs does not exist */\r\n      rowFieldsAs: RowFields = DetailsRowFields,\r\n      selection,\r\n      indentWidth,\r\n      shimmer,\r\n      compact,\r\n      theme,\r\n      styles,\r\n      cellsByColumn\r\n    } = this.props;\r\n    const { columnMeasureInfo, isDropping, groupNestingDepth } = this.state;\r\n    const { isSelected = false, isSelectionModal = false } = this.state.selectionState as IDetailsRowSelectionState;\r\n    const isDraggable = Boolean(dragDropEvents && dragDropEvents.canDrag && dragDropEvents.canDrag(item));\r\n    const droppingClassName = isDropping ? (this._droppingClassNames ? this._droppingClassNames : DEFAULT_DROPPING_CSS_CLASS) : '';\r\n    const ariaLabel = getRowAriaLabel ? getRowAriaLabel(item) : undefined;\r\n    const ariaDescribedBy = getRowAriaDescribedBy ? getRowAriaDescribedBy(item) : undefined;\r\n    const canSelect = !!selection && selection.canSelectItem!(item, itemIndex);\r\n    const isContentUnselectable = selectionMode === SelectionMode.multiple;\r\n    const showCheckbox = selectionMode !== SelectionMode.none && checkboxVisibility !== CheckboxVisibility.hidden;\r\n    const ariaSelected = selectionMode === SelectionMode.none ? undefined : isSelected;\r\n\r\n    const classNames = getClassNames(styles, {\r\n      theme: theme!,\r\n      isSelected,\r\n      canSelect: !isContentUnselectable,\r\n      anySelected: isSelectionModal,\r\n      checkboxCellClassName,\r\n      droppingClassName,\r\n      className,\r\n      compact\r\n    });\r\n\r\n    const rowFields = (\r\n      <RowFields\r\n        rowClassNames={classNames}\r\n        cellsByColumn={cellsByColumn}\r\n        columns={columns}\r\n        item={item}\r\n        itemIndex={itemIndex}\r\n        columnStartIndex={showCheckbox ? 1 : 0}\r\n        onRenderItemColumn={onRenderItemColumn}\r\n        shimmer={shimmer}\r\n      />\r\n    );\r\n    // Rendering Shimmer Animation outside the focus zone\r\n    if (shimmer) {\r\n      return (\r\n        <div className={css(showCheckbox && classNames.shimmerLeftBorder, !compact && classNames.shimmerBottomBorder)}>{rowFields}</div>\r\n      );\r\n    }\r\n\r\n    return (\r\n      <FocusZone\r\n        {...getNativeProps(this.props, divProperties)}\r\n        direction={FocusZoneDirection.horizontal}\r\n        ref={this._onRootRef}\r\n        componentRef={this._focusZone}\r\n        role=\"row\"\r\n        aria-label={ariaLabel}\r\n        ariaDescribedBy={ariaDescribedBy}\r\n        className={css(classNames.root)}\r\n        data-is-focusable={true}\r\n        data-selection-index={itemIndex}\r\n        data-item-index={itemIndex}\r\n        aria-rowindex={itemIndex + 1}\r\n        data-is-draggable={isDraggable}\r\n        draggable={isDraggable}\r\n        data-automationid=\"DetailsRow\"\r\n        style={{ minWidth: viewport ? viewport.width : 0 }}\r\n        aria-selected={ariaSelected}\r\n        allowFocusRoot={true}\r\n      >\r\n        {showCheckbox && (\r\n          <div role=\"gridcell\" aria-colindex={1} data-selection-toggle={true} className={classNames.checkCell}>\r\n            {onRenderCheck({\r\n              selected: isSelected,\r\n              anySelected: isSelectionModal,\r\n              title: checkButtonAriaLabel,\r\n              canSelect,\r\n              compact,\r\n              className: classNames.check,\r\n              theme,\r\n              isVisible: checkboxVisibility === CheckboxVisibility.always\r\n            })}\r\n          </div>\r\n        )}\r\n\r\n        <GroupSpacer\r\n          indentWidth={indentWidth}\r\n          count={groupNestingDepth! - (this.props.collapseAllVisibility === CollapseAllVisibility.hidden ? 1 : 0)}\r\n        />\r\n\r\n        {item && rowFields}\r\n        {columnMeasureInfo && (\r\n          <span role=\"presentation\" className={css(classNames.cellMeasurer, classNames.cell)} ref={this._cellMeasurer}>\r\n            <RowFields\r\n              rowClassNames={classNames}\r\n              columns={[columnMeasureInfo.column]}\r\n              item={item}\r\n              itemIndex={itemIndex}\r\n              columnStartIndex={(showCheckbox ? 1 : 0) + columns.length}\r\n              onRenderItemColumn={onRenderItemColumn}\r\n            />\r\n          </span>\r\n        )}\r\n\r\n        <span role=\"checkbox\" className={css(classNames.checkCover)} aria-checked={isSelected} data-selection-toggle={true} />\r\n      </FocusZone>\r\n    );\r\n  }\r\n\r\n  /**\r\n   * measure cell at index. and call the call back with the measured cell width when finish measure\r\n   *\r\n   * @param index - The cell index\r\n   * @param onMeasureDone - The call back function when finish measure\r\n   */\r\n  public measureCell(index: number, onMeasureDone: (width: number) => void): void {\r\n    const { columns = NO_COLUMNS } = this.props;\r\n    const column = assign({}, columns[index]) as IColumn;\r\n\r\n    column.minWidth = 0;\r\n    column.maxWidth = 999999;\r\n\r\n    delete column.calculatedWidth;\r\n\r\n    this.setState({\r\n      columnMeasureInfo: {\r\n        index,\r\n        column,\r\n        onMeasureDone\r\n      }\r\n    });\r\n  }\r\n\r\n  public focus(forceIntoFirstElement: boolean = false): boolean {\r\n    return !!this._focusZone.current && this._focusZone.current.focus(forceIntoFirstElement);\r\n  }\r\n\r\n  protected _onRenderCheck(props: IDetailsRowCheckProps) {\r\n    return <DetailsRowCheck {...props} />;\r\n  }\r\n\r\n  private _getSelectionState(props: IDetailsRowBaseProps): IDetailsRowSelectionState {\r\n    const { itemIndex, selection } = props;\r\n\r\n    return {\r\n      isSelected: !!selection && selection.isIndexSelected(itemIndex),\r\n      isSelectionModal: !!selection && !!selection.isModal && selection.isModal()\r\n    };\r\n  }\r\n\r\n  private _onSelectionChanged(): void {\r\n    const selectionState = this._getSelectionState(this.props);\r\n\r\n    if (!shallowCompare(selectionState, this.state.selectionState)) {\r\n      this.setState({\r\n        selectionState: selectionState\r\n      });\r\n    }\r\n  }\r\n\r\n  private _onToggleSelection(): void {\r\n    const { selection } = this.props;\r\n\r\n    if (selection && this.props.itemIndex > -1) {\r\n      selection.toggleIndexSelected(this.props.itemIndex);\r\n    }\r\n  }\r\n\r\n  private _onRootRef = (focusZone: FocusZone): void => {\r\n    if (focusZone) {\r\n      // Need to resolve the actual DOM node, not the component. The element itself will be used for drag/drop and focusing.\r\n      this._root = ReactDOM.findDOMNode(focusZone) as HTMLElement;\r\n    } else {\r\n      this._root = undefined;\r\n    }\r\n  };\r\n\r\n  private _getRowDragDropOptions(): IDragDropOptions {\r\n    const { item, itemIndex, dragDropEvents, eventsToRegister } = this.props;\r\n    const options = {\r\n      eventMap: eventsToRegister,\r\n      selectionIndex: itemIndex,\r\n      context: { data: item, index: itemIndex },\r\n      canDrag: dragDropEvents!.canDrag,\r\n      canDrop: dragDropEvents!.canDrop,\r\n      onDragStart: dragDropEvents!.onDragStart,\r\n      updateDropState: this._updateDroppingState,\r\n      onDrop: dragDropEvents!.onDrop,\r\n      onDragEnd: dragDropEvents!.onDragEnd\r\n    };\r\n\r\n    return options;\r\n  }\r\n\r\n  /**\r\n   * update isDropping state based on the input value, which is used to change style during drag and drop\r\n   *\r\n   * when change to true, that means drag enter. we will add default dropping class name\r\n   * or the custom dropping class name (return result from onDragEnter) to the root elemet.\r\n   *\r\n   * when change to false, that means drag leave. we will remove the dropping class name from root element.\r\n   *\r\n   * @param newValue - New isDropping state value\r\n   * @param event - The event trigger dropping state change which can be dragenter, dragleave etc\r\n   */\r\n  private _updateDroppingState(newValue: boolean, event: DragEvent): void {\r\n    const { selectionState, isDropping } = this.state;\r\n    const { dragDropEvents, item } = this.props;\r\n\r\n    if (!newValue) {\r\n      if (dragDropEvents!.onDragLeave) {\r\n        dragDropEvents!.onDragLeave!(item, event);\r\n      }\r\n    } else {\r\n      if (dragDropEvents!.onDragEnter) {\r\n        this._droppingClassNames = dragDropEvents!.onDragEnter!(item, event);\r\n      }\r\n    }\r\n\r\n    if (isDropping !== newValue) {\r\n      this.setState({ selectionState: selectionState, isDropping: newValue });\r\n    }\r\n  }\r\n}\r\n"]}