{"version":3,"file":"DetailsList.base.js","sourceRoot":"../src/","sources":["components/DetailsList/DetailsList.base.tsx"],"names":[],"mappings":"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","sourcesContent":["import * as React from 'react';\r\n\r\nimport { BaseComponent, KeyCodes, assign, elementContains, getRTLSafeKeyCode, IRenderFunction, classNamesFunction } from '../../Utilities';\r\nimport {\r\n  CheckboxVisibility,\r\n  ColumnActionsMode,\r\n  ConstrainMode,\r\n  DetailsListLayoutMode,\r\n  IColumn,\r\n  IDetailsList,\r\n  IDetailsListProps,\r\n  IDetailsListStyles,\r\n  IDetailsListStyleProps,\r\n  IDetailsGroupRenderProps,\r\n  ColumnDragEndLocation\r\n} from '../DetailsList/DetailsList.types';\r\nimport { DetailsHeader } from '../DetailsList/DetailsHeader';\r\nimport { IDetailsHeader, SelectAllVisibility, IDetailsHeaderProps, IColumnReorderHeaderProps } from '../DetailsList/DetailsHeader.types';\r\nimport { IDetailsFooterProps } from '../DetailsList/DetailsFooter.types';\r\nimport { DetailsRowBase } from '../DetailsList/DetailsRow.base';\r\nimport { DetailsRow } from '../DetailsList/DetailsRow';\r\nimport { IDetailsRowProps } from '../DetailsList/DetailsRow.types';\r\nimport { IFocusZone, FocusZone, FocusZoneDirection } from '../../FocusZone';\r\nimport { IObjectWithKey, ISelection, Selection, SelectionMode, SelectionZone } from '../../utilities/selection/index';\r\n\r\nimport { DragDropHelper } from '../../utilities/dragdrop/DragDropHelper';\r\nimport { IGroupedList, GroupedList, IGroupDividerProps, IGroupRenderProps } from '../../GroupedList';\r\nimport { List, IListProps, ScrollToMode } from '../../List';\r\nimport { withViewport } from '../../utilities/decorators/withViewport';\r\nimport { GetGroupCount } from '../../utilities/groupedList/GroupedListUtility';\r\nimport { DEFAULT_CELL_STYLE_PROPS } from './DetailsRow.styles';\r\n// For every group level there is a GroupSpacer added. Importing this const to have the source value in one place.\r\nimport { SPACER_WIDTH as GROUP_EXPAND_WIDTH } from '../GroupedList/GroupSpacer';\r\n\r\nconst getClassNames = classNamesFunction<IDetailsListStyleProps, IDetailsListStyles>();\r\n\r\nexport interface IDetailsListState {\r\n  focusedItemIndex: number;\r\n  lastWidth?: number;\r\n  lastSelectionMode?: SelectionMode;\r\n  adjustedColumns: IColumn[];\r\n  isCollapsed?: boolean;\r\n  isSizing?: boolean;\r\n  isDropping?: boolean;\r\n  isSomeGroupExpanded?: boolean;\r\n}\r\n\r\nconst MIN_COLUMN_WIDTH = 100; // this is the global min width\r\nconst CHECKBOX_WIDTH = 40;\r\n\r\nconst DEFAULT_RENDERED_WINDOWS_AHEAD = 2;\r\nconst DEFAULT_RENDERED_WINDOWS_BEHIND = 2;\r\n\r\nconst SHIMMER_INITIAL_ITEMS = 10;\r\nconst SHIMMER_ITEMS = new Array(SHIMMER_INITIAL_ITEMS);\r\n\r\n@withViewport\r\nexport class DetailsListBase extends BaseComponent<IDetailsListProps, IDetailsListState> implements IDetailsList {\r\n  public static defaultProps = {\r\n    layoutMode: DetailsListLayoutMode.justified,\r\n    selectionMode: SelectionMode.multiple,\r\n    constrainMode: ConstrainMode.horizontalConstrained,\r\n    checkboxVisibility: CheckboxVisibility.onHover,\r\n    isHeaderVisible: true,\r\n    enableShimmer: false,\r\n    compact: false\r\n  };\r\n\r\n  // References\r\n  private _root = React.createRef<HTMLDivElement>();\r\n  private _header = React.createRef<IDetailsHeader>();\r\n  private _groupedList = React.createRef<IGroupedList>();\r\n  private _list = React.createRef<List>();\r\n  private _focusZone = React.createRef<IFocusZone>();\r\n  private _selectionZone = React.createRef<SelectionZone>();\r\n\r\n  private _selection: ISelection;\r\n  private _activeRows: { [key: string]: DetailsRowBase };\r\n  private _dragDropHelper: DragDropHelper | undefined;\r\n  private _initialFocusedIndex: number | undefined;\r\n  private _pendingForceUpdate: boolean;\r\n\r\n  private _columnOverrides: {\r\n    [key: string]: IColumn;\r\n  };\r\n\r\n  constructor(props: IDetailsListProps) {\r\n    super(props);\r\n\r\n    this._activeRows = {};\r\n    this._columnOverrides = {};\r\n    this._onColumnIsSizingChanged = this._onColumnIsSizingChanged.bind(this);\r\n    this._onColumnResized = this._onColumnResized.bind(this);\r\n    this._onColumnAutoResized = this._onColumnAutoResized.bind(this);\r\n    this._onRowDidMount = this._onRowDidMount.bind(this);\r\n    this._onRowWillUnmount = this._onRowWillUnmount.bind(this);\r\n    this._onToggleCollapse = this._onToggleCollapse.bind(this);\r\n    this._onActiveRowChanged = this._onActiveRowChanged.bind(this);\r\n    this._onBlur = this._onBlur.bind(this);\r\n    this._onHeaderKeyDown = this._onHeaderKeyDown.bind(this);\r\n    this._onContentKeyDown = this._onContentKeyDown.bind(this);\r\n    this._onRenderCell = this._onRenderCell.bind(this);\r\n    this._onGroupExpandStateChanged = this._onGroupExpandStateChanged.bind(this);\r\n    this._onColumnDragEnd = this._onColumnDragEnd.bind(this);\r\n\r\n    this.state = {\r\n      focusedItemIndex: -1,\r\n      lastWidth: 0,\r\n      adjustedColumns: this._getAdjustedColumns(props),\r\n      isSizing: false,\r\n      isDropping: false,\r\n      isCollapsed: props.groupProps && props.groupProps.isAllGroupsCollapsed,\r\n      isSomeGroupExpanded: props.groupProps && !props.groupProps.isAllGroupsCollapsed\r\n    };\r\n\r\n    this._selection = props.selection || new Selection({ onSelectionChanged: undefined, getKey: props.getKey });\r\n\r\n    if (!this.props.disableSelectionZone) {\r\n      this._selection.setItems(props.items as IObjectWithKey[], false);\r\n    }\r\n\r\n    this._dragDropHelper = props.dragDropEvents\r\n      ? new DragDropHelper({\r\n          selection: this._selection,\r\n          minimumPixelsForDrag: props.minimumPixelsForDrag\r\n        })\r\n      : undefined;\r\n    this._initialFocusedIndex = props.initialFocusedIndex;\r\n  }\r\n\r\n  public scrollToIndex(index: number, measureItem?: (itemIndex: number) => number, scrollToMode?: ScrollToMode): void {\r\n    this._list.current && this._list.current.scrollToIndex(index, measureItem, scrollToMode);\r\n    this._groupedList.current && this._groupedList.current.scrollToIndex(index, measureItem, scrollToMode);\r\n  }\r\n\r\n  public focusIndex(\r\n    index: number,\r\n    forceIntoFirstElement: boolean = false,\r\n    measureItem?: (itemIndex: number) => number,\r\n    scrollToMode?: ScrollToMode\r\n  ): void {\r\n    const item = this.props.items[index];\r\n    if (item) {\r\n      this.scrollToIndex(index, measureItem, scrollToMode);\r\n\r\n      const itemKey = this._getItemKey(item, index);\r\n      const row = this._activeRows[itemKey];\r\n      if (row) {\r\n        this._setFocusToRow(row, forceIntoFirstElement);\r\n      }\r\n    }\r\n  }\r\n\r\n  public getStartItemIndexInView(): number {\r\n    if (this._list && this._list.current) {\r\n      return this._list.current.getStartItemIndexInView();\r\n    } else if (this._groupedList && this._groupedList.current) {\r\n      return this._groupedList.current.getStartItemIndexInView();\r\n    }\r\n    return 0;\r\n  }\r\n\r\n  public componentWillUnmount(): void {\r\n    if (this._dragDropHelper) {\r\n      // TODO If the DragDropHelper was passed via props, this will dispose it, which is incorrect behavior.\r\n      this._dragDropHelper.dispose();\r\n    }\r\n  }\r\n\r\n  public componentDidUpdate(prevProps: IDetailsListProps, prevState: IDetailsListState) {\r\n    if (this._initialFocusedIndex !== undefined) {\r\n      const item = this.props.items[this._initialFocusedIndex];\r\n      if (item) {\r\n        const itemKey = this._getItemKey(item, this._initialFocusedIndex);\r\n        const row = this._activeRows[itemKey];\r\n        if (row) {\r\n          this._setFocusToRowIfPending(row);\r\n        }\r\n      }\r\n    }\r\n\r\n    if (\r\n      this.props.items !== prevProps.items &&\r\n      this.props.items.length > 0 &&\r\n      this.state.focusedItemIndex !== -1 &&\r\n      !elementContains(this._root.current, document.activeElement as HTMLElement, false)\r\n    ) {\r\n      // Item set has changed and previously-focused item is gone.\r\n      // Set focus to item at index of previously-focused item if it is in range,\r\n      // else set focus to the last item.\r\n      const index = this.state.focusedItemIndex < this.props.items.length ? this.state.focusedItemIndex : this.props.items.length - 1;\r\n      const item = this.props.items[index];\r\n      const itemKey = this._getItemKey(item, this.state.focusedItemIndex);\r\n      const row = this._activeRows[itemKey];\r\n      if (row) {\r\n        this._setFocusToRow(row);\r\n      } else {\r\n        this._initialFocusedIndex = index;\r\n      }\r\n    }\r\n    if (this.props.onDidUpdate) {\r\n      this.props.onDidUpdate(this);\r\n    }\r\n  }\r\n\r\n  public componentWillReceiveProps(newProps: IDetailsListProps): void {\r\n    const {\r\n      checkboxVisibility,\r\n      items,\r\n      setKey,\r\n      selectionMode = this._selection.mode,\r\n      columns,\r\n      viewport,\r\n      compact,\r\n      dragDropEvents\r\n    } = this.props;\r\n    const { isAllGroupsCollapsed = undefined } = this.props.groupProps || {};\r\n\r\n    const shouldResetSelection = newProps.setKey !== setKey || newProps.setKey === undefined;\r\n    let shouldForceUpdates = false;\r\n\r\n    if (newProps.layoutMode !== this.props.layoutMode) {\r\n      shouldForceUpdates = true;\r\n    }\r\n\r\n    if (shouldResetSelection) {\r\n      this._initialFocusedIndex = newProps.initialFocusedIndex;\r\n      // reset focusedItemIndex when setKey changes\r\n      this.setState({\r\n        focusedItemIndex: this._initialFocusedIndex !== undefined ? this._initialFocusedIndex : -1\r\n      });\r\n    }\r\n\r\n    if (!this.props.disableSelectionZone && newProps.items !== items) {\r\n      this._selection.setItems(newProps.items, shouldResetSelection);\r\n    }\r\n\r\n    if (\r\n      newProps.checkboxVisibility !== checkboxVisibility ||\r\n      newProps.columns !== columns ||\r\n      newProps.viewport!.width !== viewport!.width ||\r\n      newProps.compact !== compact\r\n    ) {\r\n      shouldForceUpdates = true;\r\n    }\r\n\r\n    this._adjustColumns(newProps, true);\r\n\r\n    if (newProps.selectionMode !== selectionMode) {\r\n      shouldForceUpdates = true;\r\n    }\r\n\r\n    if (isAllGroupsCollapsed === undefined && (newProps.groupProps && newProps.groupProps.isAllGroupsCollapsed !== undefined)) {\r\n      this.setState({\r\n        isCollapsed: newProps.groupProps.isAllGroupsCollapsed,\r\n        isSomeGroupExpanded: !newProps.groupProps.isAllGroupsCollapsed\r\n      });\r\n    }\r\n\r\n    if (newProps.dragDropEvents !== dragDropEvents) {\r\n      this._dragDropHelper && this._dragDropHelper.dispose();\r\n      this._dragDropHelper = newProps.dragDropEvents\r\n        ? new DragDropHelper({\r\n            selection: this._selection,\r\n            minimumPixelsForDrag: newProps.minimumPixelsForDrag\r\n          })\r\n        : undefined;\r\n      shouldForceUpdates = true;\r\n    }\r\n\r\n    if (shouldForceUpdates) {\r\n      this._pendingForceUpdate = true;\r\n    }\r\n  }\r\n\r\n  public componentWillUpdate(): void {\r\n    if (this._pendingForceUpdate) {\r\n      this._forceListUpdates();\r\n    }\r\n  }\r\n\r\n  public render(): JSX.Element {\r\n    const {\r\n      ariaLabelForListHeader,\r\n      ariaLabelForSelectAllCheckbox,\r\n      ariaLabelForSelectionColumn,\r\n      className,\r\n      checkboxVisibility,\r\n      compact,\r\n      constrainMode,\r\n      dragDropEvents,\r\n      groups,\r\n      groupProps,\r\n      indentWidth,\r\n      items,\r\n      isHeaderVisible,\r\n      layoutMode,\r\n      onItemInvoked,\r\n      onItemContextMenu,\r\n      onColumnHeaderClick,\r\n      onColumnHeaderContextMenu,\r\n      selectionMode = this._selection.mode,\r\n      selectionPreservedOnEmptyClick,\r\n      selectionZoneProps,\r\n      ariaLabel,\r\n      ariaLabelForGrid,\r\n      rowElementEventMap,\r\n      shouldApplyApplicationRole = false,\r\n      getKey,\r\n      listProps,\r\n      usePageCache,\r\n      onShouldVirtualize,\r\n      enableShimmer,\r\n      viewport,\r\n      minimumPixelsForDrag,\r\n      getGroupHeight,\r\n      styles,\r\n      theme,\r\n      cellStyleProps = DEFAULT_CELL_STYLE_PROPS\r\n    } = this.props;\r\n    const { adjustedColumns, isCollapsed, isSizing, isSomeGroupExpanded } = this.state;\r\n    const { _selection: selection, _dragDropHelper: dragDropHelper } = this;\r\n    const groupNestingDepth = this._getGroupNestingDepth();\r\n    const additionalListProps: IListProps = {\r\n      renderedWindowsAhead: isSizing ? 0 : DEFAULT_RENDERED_WINDOWS_AHEAD,\r\n      renderedWindowsBehind: isSizing ? 0 : DEFAULT_RENDERED_WINDOWS_BEHIND,\r\n      getKey,\r\n      ...listProps\r\n    };\r\n    let selectAllVisibility = SelectAllVisibility.none; // for SelectionMode.none\r\n    if (selectionMode === SelectionMode.single) {\r\n      selectAllVisibility = SelectAllVisibility.hidden;\r\n    }\r\n    if (selectionMode === SelectionMode.multiple) {\r\n      // if isCollapsedGroupSelectVisible is false, disable select all when the list has all collapsed groups\r\n      let isCollapsedGroupSelectVisible = groupProps && groupProps.headerProps && groupProps.headerProps.isCollapsedGroupSelectVisible;\r\n      if (isCollapsedGroupSelectVisible === undefined) {\r\n        isCollapsedGroupSelectVisible = true;\r\n      }\r\n      const isSelectAllVisible = isCollapsedGroupSelectVisible || !groups || isSomeGroupExpanded;\r\n      selectAllVisibility = isSelectAllVisible ? SelectAllVisibility.visible : SelectAllVisibility.hidden;\r\n    }\r\n\r\n    if (checkboxVisibility === CheckboxVisibility.hidden) {\r\n      selectAllVisibility = SelectAllVisibility.none;\r\n    }\r\n\r\n    const { onRenderDetailsHeader = this._onRenderDetailsHeader, onRenderDetailsFooter = this._onRenderDetailsFooter } = this.props;\r\n\r\n    const detailsFooterProps = this._getDetailsFooterProps();\r\n    const columnReorderProps = this._getColumnReorderProps();\r\n\r\n    const rowCount = (isHeaderVisible ? 1 : 0) + GetGroupCount(groups) + (items ? items.length : 0);\r\n\r\n    const classNames = getClassNames(styles, {\r\n      theme: theme!,\r\n      compact,\r\n      isFixed: layoutMode === DetailsListLayoutMode.fixedColumns,\r\n      isHorizontalConstrained: constrainMode === ConstrainMode.horizontalConstrained,\r\n      className\r\n    });\r\n\r\n    const list = groups ? (\r\n      <GroupedList\r\n        componentRef={this._groupedList}\r\n        groups={groups}\r\n        groupProps={groupProps ? this._getGroupProps(groupProps) : undefined}\r\n        items={items}\r\n        onRenderCell={this._onRenderCell}\r\n        selection={selection}\r\n        selectionMode={checkboxVisibility !== CheckboxVisibility.hidden ? selectionMode : SelectionMode.none}\r\n        dragDropEvents={dragDropEvents}\r\n        dragDropHelper={dragDropHelper}\r\n        eventsToRegister={rowElementEventMap}\r\n        listProps={additionalListProps}\r\n        onGroupExpandStateChanged={this._onGroupExpandStateChanged}\r\n        usePageCache={usePageCache}\r\n        onShouldVirtualize={onShouldVirtualize}\r\n        getGroupHeight={getGroupHeight}\r\n        compact={compact}\r\n      />\r\n    ) : (\r\n      <List\r\n        ref={this._list}\r\n        role=\"presentation\"\r\n        items={enableShimmer && !items.length ? SHIMMER_ITEMS : items}\r\n        onRenderCell={this._onRenderListCell(0)}\r\n        usePageCache={usePageCache}\r\n        onShouldVirtualize={onShouldVirtualize}\r\n        {...additionalListProps}\r\n      />\r\n    );\r\n\r\n    return (\r\n      // If shouldApplyApplicationRole is true, role application will be applied to make arrow keys work\r\n      // with JAWS.\r\n      <div\r\n        ref={this._root}\r\n        className={classNames.root}\r\n        data-automationid=\"DetailsList\"\r\n        data-is-scrollable=\"false\"\r\n        aria-label={ariaLabel}\r\n        {...(shouldApplyApplicationRole ? { role: 'application' } : {})}\r\n      >\r\n        <div\r\n          role=\"grid\"\r\n          aria-label={ariaLabelForGrid}\r\n          aria-rowcount={rowCount}\r\n          aria-colcount={(selectAllVisibility !== SelectAllVisibility.none ? 1 : 0) + (adjustedColumns ? adjustedColumns.length : 0)}\r\n          aria-readonly=\"true\"\r\n        >\r\n          <div onKeyDown={this._onHeaderKeyDown} role=\"presentation\" className={classNames.headerWrapper}>\r\n            {isHeaderVisible &&\r\n              onRenderDetailsHeader(\r\n                {\r\n                  componentRef: this._header,\r\n                  selectionMode: selectionMode,\r\n                  layoutMode: layoutMode!,\r\n                  selection: selection,\r\n                  columns: adjustedColumns,\r\n                  onColumnClick: onColumnHeaderClick,\r\n                  onColumnContextMenu: onColumnHeaderContextMenu,\r\n                  onColumnResized: this._onColumnResized,\r\n                  onColumnIsSizingChanged: this._onColumnIsSizingChanged,\r\n                  onColumnAutoResized: this._onColumnAutoResized,\r\n                  groupNestingDepth: groupNestingDepth,\r\n                  isAllCollapsed: isCollapsed,\r\n                  onToggleCollapseAll: this._onToggleCollapse,\r\n                  ariaLabel: ariaLabelForListHeader,\r\n                  ariaLabelForSelectAllCheckbox: ariaLabelForSelectAllCheckbox,\r\n                  ariaLabelForSelectionColumn: ariaLabelForSelectionColumn,\r\n                  selectAllVisibility: selectAllVisibility,\r\n                  collapseAllVisibility: groupProps && groupProps.collapseAllVisibility,\r\n                  viewport: viewport,\r\n                  columnReorderProps: columnReorderProps,\r\n                  minimumPixelsForDrag: minimumPixelsForDrag,\r\n                  cellStyleProps: cellStyleProps,\r\n                  checkboxVisibility,\r\n                  indentWidth\r\n                },\r\n                this._onRenderDetailsHeader\r\n              )}\r\n          </div>\r\n          <div onKeyDown={this._onContentKeyDown} role=\"presentation\" className={classNames.contentWrapper}>\r\n            <FocusZone\r\n              componentRef={this._focusZone}\r\n              className={classNames.focusZone}\r\n              direction={FocusZoneDirection.vertical}\r\n              isInnerZoneKeystroke={isRightArrow}\r\n              onActiveElementChanged={this._onActiveRowChanged}\r\n              onBlur={this._onBlur}\r\n            >\r\n              {!this.props.disableSelectionZone ? (\r\n                <SelectionZone\r\n                  ref={this._selectionZone}\r\n                  selection={selection}\r\n                  selectionPreservedOnEmptyClick={selectionPreservedOnEmptyClick}\r\n                  selectionMode={selectionMode}\r\n                  onItemInvoked={onItemInvoked}\r\n                  onItemContextMenu={onItemContextMenu}\r\n                  enterModalOnTouch={this.props.enterModalSelectionOnTouch}\r\n                  {...selectionZoneProps || {}}\r\n                >\r\n                  {list}\r\n                </SelectionZone>\r\n              ) : (\r\n                list\r\n              )}\r\n            </FocusZone>\r\n          </div>\r\n          {onRenderDetailsFooter(\r\n            {\r\n              ...detailsFooterProps\r\n            },\r\n            this._onRenderDetailsFooter\r\n          )}\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  public forceUpdate(): void {\r\n    super.forceUpdate();\r\n    this._forceListUpdates();\r\n  }\r\n\r\n  protected _onRenderRow = (props: IDetailsRowProps, defaultRender?: IRenderFunction<IDetailsRowProps>): JSX.Element => {\r\n    return <DetailsRow {...props} />;\r\n  };\r\n\r\n  private _onRenderDetailsHeader = (\r\n    detailsHeaderProps: IDetailsHeaderProps,\r\n    defaultRender?: IRenderFunction<IDetailsHeaderProps>\r\n  ): JSX.Element => {\r\n    return <DetailsHeader {...detailsHeaderProps} />;\r\n  };\r\n\r\n  private _onRenderDetailsFooter = (\r\n    detailsFooterProps: IDetailsFooterProps,\r\n    defaultRender?: IRenderFunction<IDetailsFooterProps>\r\n  ): JSX.Element | null => {\r\n    return null;\r\n  };\r\n\r\n  private _onRenderListCell = (nestingDepth: number): ((item: any, itemIndex: number) => React.ReactNode) => {\r\n    return (item: any, itemIndex: number): React.ReactNode => {\r\n      return this._onRenderCell(nestingDepth, item, itemIndex);\r\n    };\r\n  };\r\n\r\n  private _onRenderCell(nestingDepth: number, item: any, index: number): React.ReactNode {\r\n    const {\r\n      compact,\r\n      dragDropEvents,\r\n      rowElementEventMap: eventsToRegister,\r\n      onRenderMissingItem,\r\n      onRenderItemColumn,\r\n      onRenderRow = this._onRenderRow,\r\n      selectionMode = this._selection.mode,\r\n      viewport,\r\n      checkboxVisibility,\r\n      getRowAriaLabel,\r\n      getRowAriaDescribedBy,\r\n      checkButtonAriaLabel,\r\n      checkboxCellClassName,\r\n      groupProps,\r\n      useReducedRowRenderer,\r\n      indentWidth,\r\n      cellStyleProps = DEFAULT_CELL_STYLE_PROPS\r\n    } = this.props;\r\n    const collapseAllVisibility = groupProps && groupProps.collapseAllVisibility;\r\n    const selection = this._selection;\r\n    const dragDropHelper = this._dragDropHelper;\r\n    const { adjustedColumns: columns } = this.state;\r\n\r\n    const rowProps: IDetailsRowProps = {\r\n      item: item,\r\n      itemIndex: index,\r\n      compact: compact,\r\n      columns: columns,\r\n      groupNestingDepth: nestingDepth,\r\n      selectionMode: selectionMode,\r\n      selection: selection,\r\n      onDidMount: this._onRowDidMount,\r\n      onWillUnmount: this._onRowWillUnmount,\r\n      onRenderItemColumn: onRenderItemColumn,\r\n      eventsToRegister: eventsToRegister,\r\n      dragDropEvents: dragDropEvents,\r\n      dragDropHelper: dragDropHelper,\r\n      viewport: viewport,\r\n      checkboxVisibility: checkboxVisibility,\r\n      collapseAllVisibility: collapseAllVisibility,\r\n      getRowAriaLabel: getRowAriaLabel,\r\n      getRowAriaDescribedBy: getRowAriaDescribedBy,\r\n      checkButtonAriaLabel: checkButtonAriaLabel,\r\n      checkboxCellClassName: checkboxCellClassName,\r\n      useReducedRowRenderer: useReducedRowRenderer,\r\n      indentWidth,\r\n      cellStyleProps: cellStyleProps\r\n    };\r\n\r\n    if (!item) {\r\n      if (onRenderMissingItem) {\r\n        return onRenderMissingItem(index, rowProps);\r\n      }\r\n\r\n      return null;\r\n    }\r\n\r\n    return onRenderRow(rowProps, this._onRenderRow);\r\n  }\r\n\r\n  private _onGroupExpandStateChanged(isSomeGroupExpanded: boolean): void {\r\n    this.setState({ isSomeGroupExpanded: isSomeGroupExpanded });\r\n  }\r\n\r\n  private _onColumnIsSizingChanged(column: IColumn, isSizing: boolean): void {\r\n    this.setState({ isSizing: isSizing });\r\n  }\r\n\r\n  private _onHeaderKeyDown(ev: React.KeyboardEvent<HTMLElement>): void {\r\n    if (ev.which === KeyCodes.down) {\r\n      if (this._focusZone.current && this._focusZone.current.focus()) {\r\n        // select the first item in list after down arrow key event\r\n        this._selection.setIndexSelected(0, true, false);\r\n        ev.preventDefault();\r\n        ev.stopPropagation();\r\n      }\r\n    }\r\n  }\r\n\r\n  private _onContentKeyDown(ev: React.KeyboardEvent<HTMLElement>): void {\r\n    if (ev.which === KeyCodes.up && !ev.altKey) {\r\n      if (this._header.current && this._header.current.focus()) {\r\n        ev.preventDefault();\r\n        ev.stopPropagation();\r\n      }\r\n    }\r\n  }\r\n\r\n  private _getGroupNestingDepth(): number {\r\n    const { groups } = this.props;\r\n    let level = 0;\r\n    let groupsInLevel = groups;\r\n\r\n    while (groupsInLevel && groupsInLevel.length > 0) {\r\n      level++;\r\n      groupsInLevel = groupsInLevel[0].children;\r\n    }\r\n\r\n    return level;\r\n  }\r\n\r\n  private _onRowDidMount(row: DetailsRowBase): void {\r\n    const { item, itemIndex } = row.props;\r\n    const itemKey = this._getItemKey(item, itemIndex);\r\n    this._activeRows[itemKey] = row; // this is used for column auto resize\r\n\r\n    this._setFocusToRowIfPending(row);\r\n\r\n    const { onRowDidMount } = this.props;\r\n    if (onRowDidMount) {\r\n      onRowDidMount(item, itemIndex);\r\n    }\r\n  }\r\n\r\n  private _setFocusToRowIfPending(row: DetailsRowBase): void {\r\n    const { itemIndex } = row.props;\r\n    if (this._initialFocusedIndex !== undefined && itemIndex === this._initialFocusedIndex) {\r\n      this._setFocusToRow(row);\r\n      delete this._initialFocusedIndex;\r\n    }\r\n  }\r\n\r\n  private _setFocusToRow(row: DetailsRowBase, forceIntoFirstElement: boolean = false): void {\r\n    if (this._selectionZone.current) {\r\n      this._selectionZone.current.ignoreNextFocus();\r\n    }\r\n    this._async.setTimeout((): void => {\r\n      row.focus(forceIntoFirstElement);\r\n    }, 0);\r\n  }\r\n\r\n  private _onRowWillUnmount(row: DetailsRowBase): void {\r\n    const { onRowWillUnmount } = this.props;\r\n\r\n    const { item, itemIndex } = row.props;\r\n    const itemKey = this._getItemKey(item, itemIndex);\r\n    delete this._activeRows[itemKey];\r\n\r\n    if (onRowWillUnmount) {\r\n      onRowWillUnmount(item, itemIndex);\r\n    }\r\n  }\r\n\r\n  private _onToggleCollapse(collapsed: boolean): void {\r\n    this.setState({\r\n      isCollapsed: collapsed\r\n    });\r\n    if (this._groupedList.current) {\r\n      this._groupedList.current.toggleCollapseAll(collapsed);\r\n    }\r\n  }\r\n\r\n  private _onColumnDragEnd(props: { dropLocation?: ColumnDragEndLocation }, event: MouseEvent): void {\r\n    const { columnReorderOptions } = this.props;\r\n    let finalDropLocation: ColumnDragEndLocation = ColumnDragEndLocation.outside;\r\n    if (columnReorderOptions && columnReorderOptions.onDragEnd) {\r\n      if (props.dropLocation && props.dropLocation !== ColumnDragEndLocation.header) {\r\n        finalDropLocation = props.dropLocation;\r\n      } else if (this._root.current) {\r\n        const clientRect = this._root.current.getBoundingClientRect();\r\n        if (\r\n          event.clientX > clientRect.left &&\r\n          event.clientX < clientRect.right &&\r\n          event.clientY > clientRect.top &&\r\n          event.clientY < clientRect.bottom\r\n        ) {\r\n          finalDropLocation = ColumnDragEndLocation.surface;\r\n        }\r\n      }\r\n      columnReorderOptions.onDragEnd(finalDropLocation);\r\n    }\r\n  }\r\n\r\n  private _forceListUpdates(): void {\r\n    this._pendingForceUpdate = false;\r\n\r\n    if (this._groupedList.current) {\r\n      this._groupedList.current.forceUpdate();\r\n    }\r\n    if (this._list.current) {\r\n      this._list.current.forceUpdate();\r\n    }\r\n  }\r\n\r\n  private _notifyColumnsResized(): void {\r\n    this.state.adjustedColumns.forEach(column => {\r\n      if (column.onColumnResize) {\r\n        column.onColumnResize(column.currentWidth);\r\n      }\r\n    });\r\n  }\r\n\r\n  private _adjustColumns(newProps: IDetailsListProps, forceUpdate?: boolean, resizingColumnIndex?: number): void {\r\n    const adjustedColumns = this._getAdjustedColumns(newProps, forceUpdate, resizingColumnIndex);\r\n    const { width: viewportWidth } = this.props.viewport!;\r\n\r\n    if (adjustedColumns) {\r\n      this.setState(\r\n        {\r\n          adjustedColumns: adjustedColumns,\r\n          lastWidth: viewportWidth\r\n        },\r\n        this._notifyColumnsResized\r\n      );\r\n    }\r\n  }\r\n\r\n  /** Returns adjusted columns, given the viewport size and layout mode. */\r\n  private _getAdjustedColumns(newProps: IDetailsListProps, forceUpdate?: boolean, resizingColumnIndex?: number): IColumn[] {\r\n    const { items: newItems, layoutMode, selectionMode } = newProps;\r\n    let { columns: newColumns } = newProps;\r\n    let { width: viewportWidth } = newProps.viewport!;\r\n\r\n    const columns = this.props ? this.props.columns : [];\r\n    const lastWidth = this.state ? this.state.lastWidth : -1;\r\n    const lastSelectionMode = this.state ? this.state.lastSelectionMode : undefined;\r\n\r\n    if (viewportWidth !== undefined) {\r\n      if (!forceUpdate && lastWidth === viewportWidth && lastSelectionMode === selectionMode && (!columns || newColumns === columns)) {\r\n        return [];\r\n      }\r\n    } else {\r\n      viewportWidth = this.props.viewport!.width;\r\n    }\r\n\r\n    newColumns = newColumns || buildColumns(newItems, true);\r\n\r\n    let adjustedColumns: IColumn[];\r\n\r\n    if (layoutMode === DetailsListLayoutMode.fixedColumns) {\r\n      adjustedColumns = this._getFixedColumns(newColumns);\r\n\r\n      // Preserve adjusted column calculated widths.\r\n      adjustedColumns.forEach(column => {\r\n        this._rememberCalculatedWidth(column, column.calculatedWidth!);\r\n      });\r\n    } else {\r\n      if (resizingColumnIndex !== undefined) {\r\n        adjustedColumns = this._getJustifiedColumnsAfterResize(newColumns, viewportWidth, newProps, resizingColumnIndex);\r\n      } else {\r\n        adjustedColumns = this._getJustifiedColumns(newColumns, viewportWidth, newProps, 0);\r\n      }\r\n\r\n      adjustedColumns.forEach(column => {\r\n        this._getColumnOverride(column.key).currentWidth = column.calculatedWidth;\r\n      });\r\n    }\r\n\r\n    return adjustedColumns;\r\n  }\r\n\r\n  /** Builds a set of columns based on the given columns mixed with the current overrides. */\r\n  private _getFixedColumns(newColumns: IColumn[]): IColumn[] {\r\n    return newColumns.map(column => {\r\n      const newColumn: IColumn = assign({}, column, this._columnOverrides[column.key]);\r\n\r\n      if (!newColumn.calculatedWidth) {\r\n        newColumn.calculatedWidth = newColumn.maxWidth || newColumn.minWidth || MIN_COLUMN_WIDTH;\r\n      }\r\n\r\n      return newColumn;\r\n    });\r\n  }\r\n\r\n  private _getJustifiedColumnsAfterResize(\r\n    newColumns: IColumn[],\r\n    viewportWidth: number,\r\n    props: IDetailsListProps,\r\n    resizingColumnIndex: number\r\n  ): IColumn[] {\r\n    const fixedColumns = newColumns.slice(0, resizingColumnIndex);\r\n    fixedColumns.forEach(column => (column.calculatedWidth = this._getColumnOverride(column.key).currentWidth));\r\n\r\n    const fixedWidth = fixedColumns.reduce((total, column, i) => total + getPaddedWidth(column, i === 0, props), 0);\r\n\r\n    const remainingColumns = newColumns.slice(resizingColumnIndex);\r\n    const remainingWidth = viewportWidth - fixedWidth;\r\n\r\n    return [...fixedColumns, ...this._getJustifiedColumns(remainingColumns, remainingWidth, props, resizingColumnIndex)];\r\n  }\r\n\r\n  /** Builds a set of columns to fix within the viewport width. */\r\n  private _getJustifiedColumns(newColumns: IColumn[], viewportWidth: number, props: IDetailsListProps, firstIndex: number): IColumn[] {\r\n    const { selectionMode = this._selection.mode, checkboxVisibility } = props;\r\n    const rowCheckWidth = selectionMode !== SelectionMode.none && checkboxVisibility !== CheckboxVisibility.hidden ? CHECKBOX_WIDTH : 0;\r\n    const groupExpandWidth = this._getGroupNestingDepth() * GROUP_EXPAND_WIDTH;\r\n    let totalWidth = 0; // offset because we have one less inner padding.\r\n    const availableWidth = viewportWidth - (rowCheckWidth + groupExpandWidth);\r\n    const adjustedColumns: IColumn[] = newColumns.map((column, i) => {\r\n      const newColumn = {\r\n        ...column,\r\n        calculatedWidth: column.minWidth || MIN_COLUMN_WIDTH,\r\n        ...this._columnOverrides[column.key]\r\n      };\r\n\r\n      const isFirst = i + firstIndex === 0;\r\n      totalWidth += getPaddedWidth(newColumn, isFirst, props);\r\n\r\n      return newColumn;\r\n    });\r\n\r\n    let lastIndex = adjustedColumns.length - 1;\r\n\r\n    // Shrink or remove collapsable columns.\r\n    while (lastIndex > 0 && totalWidth > availableWidth) {\r\n      const column = adjustedColumns[lastIndex];\r\n\r\n      const minWidth = column.minWidth || MIN_COLUMN_WIDTH;\r\n      const overflowWidth = totalWidth - availableWidth;\r\n\r\n      if (column.calculatedWidth! - minWidth >= overflowWidth || !(column.isCollapsable || column.isCollapsible)) {\r\n        const originalWidth = column.calculatedWidth!;\r\n        column.calculatedWidth = Math.max(column.calculatedWidth! - overflowWidth, minWidth);\r\n        totalWidth -= originalWidth - column.calculatedWidth;\r\n      } else {\r\n        totalWidth -= getPaddedWidth(column, false, props);\r\n        adjustedColumns.splice(lastIndex, 1);\r\n      }\r\n      lastIndex--;\r\n    }\r\n\r\n    // Then expand columns starting at the beginning, until we've filled the width.\r\n    for (let i = 0; i < adjustedColumns.length && totalWidth < availableWidth; i++) {\r\n      const column = adjustedColumns[i];\r\n      const isLast = i === adjustedColumns.length - 1;\r\n      const overrides = this._columnOverrides[column.key];\r\n      if (overrides && overrides.calculatedWidth && !isLast) {\r\n        continue;\r\n      }\r\n\r\n      const spaceLeft = availableWidth - totalWidth;\r\n      let increment: number;\r\n      if (isLast) {\r\n        increment = spaceLeft;\r\n      } else {\r\n        const maxWidth = column.maxWidth;\r\n        const minWidth = column.minWidth || maxWidth || MIN_COLUMN_WIDTH;\r\n        increment = maxWidth ? Math.min(spaceLeft, maxWidth - minWidth) : spaceLeft;\r\n      }\r\n\r\n      column.calculatedWidth = (column.calculatedWidth as number) + increment;\r\n      totalWidth += increment;\r\n    }\r\n\r\n    return adjustedColumns;\r\n  }\r\n\r\n  private _onColumnResized(resizingColumn: IColumn, newWidth: number, resizingColumnIndex: number): void {\r\n    const newCalculatedWidth = Math.max(resizingColumn.minWidth || MIN_COLUMN_WIDTH, newWidth);\r\n    if (this.props.onColumnResize) {\r\n      this.props.onColumnResize(resizingColumn, newCalculatedWidth, resizingColumnIndex);\r\n    }\r\n\r\n    this._rememberCalculatedWidth(resizingColumn, newCalculatedWidth);\r\n\r\n    this._adjustColumns(this.props, true, resizingColumnIndex);\r\n    this._forceListUpdates();\r\n  }\r\n\r\n  private _rememberCalculatedWidth(column: IColumn, newCalculatedWidth: number): void {\r\n    const overrides = this._getColumnOverride(column.key);\r\n    overrides.calculatedWidth = newCalculatedWidth;\r\n    overrides.currentWidth = newCalculatedWidth;\r\n  }\r\n\r\n  private _getColumnOverride(key: string): IColumn {\r\n    return (this._columnOverrides[key] = this._columnOverrides[key] || {});\r\n  }\r\n\r\n  /**\r\n   * Callback function when double clicked on the details header column resizer\r\n   * which will measure the column cells of all the active rows and resize the\r\n   * column to the max cell width.\r\n   *\r\n   * @param column - double clicked column definition\r\n   * @param columnIndex - double clicked column index\r\n   * TODO: min width 100 should be changed to const value and should be consistent with the\r\n   * value used on _onSizerMove method in DetailsHeader\r\n   */\r\n  private _onColumnAutoResized(column: IColumn, columnIndex: number): void {\r\n    let max = 0;\r\n    let count = 0;\r\n    const totalCount = Object.keys(this._activeRows).length;\r\n\r\n    for (const key in this._activeRows) {\r\n      if (this._activeRows.hasOwnProperty(key)) {\r\n        const currentRow = this._activeRows[key];\r\n        currentRow.measureCell(columnIndex, (width: number) => {\r\n          max = Math.max(max, width);\r\n          count++;\r\n          if (count === totalCount) {\r\n            this._onColumnResized(column, max, columnIndex);\r\n          }\r\n        });\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Call back function when an element in FocusZone becomes active. It will translate it into item\r\n   * and call onActiveItemChanged callback if specified.\r\n   *\r\n   * @param row - element that became active in Focus Zone\r\n   * @param focus - event from Focus Zone\r\n   */\r\n  private _onActiveRowChanged(el?: HTMLElement, ev?: React.FocusEvent<HTMLElement>): void {\r\n    const { items, onActiveItemChanged } = this.props;\r\n\r\n    if (!el) {\r\n      return;\r\n    }\r\n\r\n    // Check and assign index only if the event was raised from any DetailsRow element\r\n    if (el.getAttribute('data-item-index')) {\r\n      const index = Number(el.getAttribute('data-item-index'));\r\n      if (index >= 0) {\r\n        if (onActiveItemChanged) {\r\n          onActiveItemChanged(items[index], index, ev);\r\n        }\r\n        this.setState({\r\n          focusedItemIndex: index\r\n        });\r\n      }\r\n    }\r\n  }\r\n\r\n  private _onBlur(event: React.FocusEvent<HTMLElement>): void {\r\n    this.setState({\r\n      focusedItemIndex: -1\r\n    });\r\n  }\r\n\r\n  private _getItemKey(item: any, itemIndex: number): string | number {\r\n    const { getKey } = this.props;\r\n\r\n    let itemKey: string | number | undefined = undefined;\r\n    if (item) {\r\n      itemKey = item.key;\r\n    }\r\n\r\n    if (getKey) {\r\n      itemKey = getKey(item, itemIndex);\r\n    }\r\n\r\n    if (!itemKey) {\r\n      itemKey = itemIndex;\r\n    }\r\n\r\n    return itemKey;\r\n  }\r\n\r\n  private _getDetailsFooterProps(): IDetailsFooterProps {\r\n    const { adjustedColumns: columns } = this.state;\r\n\r\n    const {\r\n      viewport,\r\n      checkboxVisibility,\r\n      indentWidth,\r\n      cellStyleProps = DEFAULT_CELL_STYLE_PROPS,\r\n      selectionMode = this._selection.mode\r\n    } = this.props;\r\n\r\n    return {\r\n      columns: columns,\r\n      groupNestingDepth: this._getGroupNestingDepth(),\r\n      selection: this._selection,\r\n      selectionMode: selectionMode,\r\n      viewport: viewport,\r\n      checkboxVisibility,\r\n      indentWidth,\r\n      cellStyleProps\r\n    };\r\n  }\r\n\r\n  private _getColumnReorderProps(): IColumnReorderHeaderProps | undefined {\r\n    const { columnReorderOptions } = this.props;\r\n    if (columnReorderOptions) {\r\n      return {\r\n        ...columnReorderOptions,\r\n        onColumnDragEnd: this._onColumnDragEnd\r\n      };\r\n    }\r\n  }\r\n\r\n  private _getGroupProps(detailsGroupProps: IDetailsGroupRenderProps): IGroupRenderProps {\r\n    const { onRenderFooter: onRenderDetailsGroupFooter, onRenderHeader: onRenderDetailsGroupHeader } = detailsGroupProps;\r\n    const { adjustedColumns: columns } = this.state;\r\n    const {\r\n      selectionMode = this._selection.mode,\r\n      viewport,\r\n      cellStyleProps = DEFAULT_CELL_STYLE_PROPS,\r\n      checkboxVisibility,\r\n      indentWidth\r\n    } = this.props;\r\n    const groupNestingDepth = this._getGroupNestingDepth();\r\n    const onRenderFooter = onRenderDetailsGroupFooter\r\n      ? (props: IGroupDividerProps, defaultRender?: IRenderFunction<IGroupDividerProps>) => {\r\n          return onRenderDetailsGroupFooter(\r\n            {\r\n              ...props,\r\n              columns: columns,\r\n              groupNestingDepth: groupNestingDepth,\r\n              indentWidth,\r\n              selection: this._selection,\r\n              selectionMode: selectionMode,\r\n              viewport: viewport,\r\n              checkboxVisibility,\r\n              cellStyleProps\r\n            },\r\n            defaultRender\r\n          );\r\n        }\r\n      : undefined;\r\n\r\n    const onRenderHeader = onRenderDetailsGroupHeader\r\n      ? (props: IGroupDividerProps, defaultRender?: IRenderFunction<IGroupDividerProps>) => {\r\n          return onRenderDetailsGroupHeader(\r\n            {\r\n              ...props,\r\n              columns: columns,\r\n              groupNestingDepth: groupNestingDepth,\r\n              indentWidth,\r\n              selection: this._selection,\r\n              selectionMode: selectionMode,\r\n              viewport: viewport,\r\n              checkboxVisibility,\r\n              cellStyleProps\r\n            },\r\n            defaultRender\r\n          );\r\n        }\r\n      : undefined;\r\n\r\n    return {\r\n      ...detailsGroupProps,\r\n      onRenderFooter,\r\n      onRenderHeader\r\n    };\r\n  }\r\n}\r\n\r\nexport function buildColumns(\r\n  items: any[],\r\n  canResizeColumns?: boolean,\r\n  onColumnClick?: (ev: React.MouseEvent<HTMLElement>, column: IColumn) => void,\r\n  sortedColumnKey?: string,\r\n  isSortedDescending?: boolean,\r\n  groupedColumnKey?: string,\r\n  isMultiline?: boolean\r\n) {\r\n  const columns: IColumn[] = [];\r\n\r\n  if (items && items.length) {\r\n    const firstItem = items[0];\r\n\r\n    for (const propName in firstItem) {\r\n      if (firstItem.hasOwnProperty(propName)) {\r\n        columns.push({\r\n          key: propName,\r\n          name: propName,\r\n          fieldName: propName,\r\n          minWidth: MIN_COLUMN_WIDTH,\r\n          maxWidth: 300,\r\n          isCollapsable: !!columns.length,\r\n          isCollapsible: !!columns.length,\r\n          isMultiline: isMultiline === undefined ? false : isMultiline,\r\n          isSorted: sortedColumnKey === propName,\r\n          isSortedDescending: !!isSortedDescending,\r\n          isRowHeader: false,\r\n          columnActionsMode: ColumnActionsMode.clickable,\r\n          isResizable: canResizeColumns,\r\n          onColumnClick: onColumnClick,\r\n          isGrouped: groupedColumnKey === propName\r\n        });\r\n      }\r\n    }\r\n  }\r\n\r\n  return columns;\r\n}\r\n\r\nfunction isRightArrow(event: React.KeyboardEvent<HTMLElement>): boolean {\r\n  return event.which === getRTLSafeKeyCode(KeyCodes.right);\r\n}\r\n\r\nfunction getPaddedWidth(column: IColumn, isFirst: boolean, props: IDetailsListProps): number {\r\n  const { cellStyleProps = DEFAULT_CELL_STYLE_PROPS } = props;\r\n\r\n  return (\r\n    column.calculatedWidth! +\r\n    cellStyleProps.cellLeftPadding +\r\n    cellStyleProps.cellRightPadding +\r\n    (column.isPadded ? cellStyleProps.cellExtraRightPadding : 0)\r\n  );\r\n}\r\n"]}