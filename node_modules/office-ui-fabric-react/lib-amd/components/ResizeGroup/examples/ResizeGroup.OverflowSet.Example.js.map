{"version":3,"file":"ResizeGroup.OverflowSet.Example.js","sourceRoot":"../src/","sources":["components/ResizeGroup/examples/ResizeGroup.OverflowSet.Example.tsx"],"names":[],"mappings":"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","sourcesContent":["import * as React from 'react';\r\nimport { BaseComponent } from 'office-ui-fabric-react/lib/Utilities';\r\nimport { CommandBarButton } from 'office-ui-fabric-react/lib/Button';\r\nimport { ResizeGroup } from 'office-ui-fabric-react/lib/ResizeGroup';\r\nimport { OverflowSet } from 'office-ui-fabric-react/lib/OverflowSet';\r\nimport { Checkbox } from 'office-ui-fabric-react/lib/Checkbox';\r\nimport { IContextualMenuItem } from 'office-ui-fabric-react/lib/ContextualMenu';\r\nimport { Dropdown, IDropdownOption } from 'office-ui-fabric-react/lib/Dropdown';\r\n\r\nimport * as stylesImport from './ResizeGroup.Example.scss';\r\nconst styles: any = stylesImport;\r\n\r\nexport interface IOverflowData {\r\n  primary: IContextualMenuItem[];\r\n  overflow: IContextualMenuItem[];\r\n  cacheKey?: string;\r\n}\r\n\r\nfunction generateData(count: number, cachingEnabled: boolean, checked: boolean): IOverflowData {\r\n  const icons = ['Add', 'Share', 'Upload'];\r\n  const dataItems = [];\r\n  let cacheKey = '';\r\n  for (let index = 0; index < count; index++) {\r\n    const item = {\r\n      key: `item${index}`,\r\n      name: `Item ${index}`,\r\n      icon: icons[index % icons.length],\r\n      checked: checked\r\n    };\r\n\r\n    cacheKey = cacheKey + item.key;\r\n    dataItems.push(item);\r\n  }\r\n\r\n  let result: IOverflowData = {\r\n    primary: dataItems,\r\n    overflow: [] as any[]\r\n  };\r\n\r\n  if (cachingEnabled) {\r\n    result = { ...result, cacheKey };\r\n  }\r\n\r\n  return result;\r\n}\r\n\r\nexport interface IResizeGroupOverflowSetExampleState {\r\n  short: boolean;\r\n  numberOfItems: number;\r\n  buttonsChecked: boolean;\r\n  cachingEnabled: boolean;\r\n  onGrowDataEnabled: boolean;\r\n}\r\n\r\nfunction computeCacheKey(primaryControls: IContextualMenuItem[]): string {\r\n  return primaryControls.reduce((acc, current) => acc + current.key, '');\r\n}\r\n\r\nexport class ResizeGroupOverflowSetExample extends BaseComponent<{}, IResizeGroupOverflowSetExampleState> {\r\n  constructor(props: {}) {\r\n    super(props);\r\n    this.state = {\r\n      short: false,\r\n      buttonsChecked: false,\r\n      cachingEnabled: false,\r\n      onGrowDataEnabled: false,\r\n      numberOfItems: 20\r\n    };\r\n  }\r\n\r\n  public render(): JSX.Element {\r\n    const { numberOfItems, cachingEnabled, buttonsChecked, short, onGrowDataEnabled } = this.state;\r\n    const dataToRender = generateData(numberOfItems, cachingEnabled, buttonsChecked);\r\n    return (\r\n      <div className={short ? styles.resizeIsShort : 'notResized'}>\r\n        <ResizeGroup\r\n          role=\"tabpanel\"\r\n          aria-label=\"Resize Group with an Overflow Set\"\r\n          data={dataToRender}\r\n          onReduceData={this._onReduceData}\r\n          onGrowData={onGrowDataEnabled ? this._onGrowData : undefined}\r\n          // tslint:disable-next-line:jsx-no-lambda\r\n          onRenderData={data => {\r\n            return (\r\n              <OverflowSet\r\n                items={data.primary}\r\n                overflowItems={data.overflow.length ? data.overflow : null}\r\n                onRenderItem={item => {\r\n                  return (\r\n                    <CommandBarButton text={item.name} iconProps={{ iconName: item.icon }} onClick={item.onClick} checked={item.checked} />\r\n                  );\r\n                }}\r\n                onRenderOverflowButton={overflowItems => {\r\n                  return <CommandBarButton menuProps={{ items: overflowItems! }} />;\r\n                }}\r\n                styles={{ root: { height: 40 } }}\r\n              />\r\n            );\r\n          }}\r\n        />\r\n        <div className={styles.settingsGroup}>\r\n          <Checkbox label=\"Enable caching\" onChange={this._onCachingEnabledChanged} checked={cachingEnabled} />\r\n          <Checkbox label=\"Set onGrowData\" onChange={this._onGrowDataEnabledChanged} checked={onGrowDataEnabled} />\r\n          <Checkbox label=\"Buttons checked\" onChange={this._onButtonsCheckedChanged} checked={buttonsChecked} />\r\n          <div className={styles.itemCountDropdown}>\r\n            <Dropdown\r\n              label=\"Number of items to render\"\r\n              selectedKey={numberOfItems.toString()}\r\n              onChange={this._onNumberOfItemsChanged}\r\n              options={[\r\n                { key: '20', text: '20' },\r\n                { key: '30', text: '30' },\r\n                { key: '40', text: '40' },\r\n                { key: '50', text: '50' },\r\n                { key: '75', text: '75' },\r\n                { key: '100', text: '100' },\r\n                { key: '200', text: '200' }\r\n              ]}\r\n            />\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  private _onReduceData = (currentData: any): any => {\r\n    if (currentData.primary.length === 0) {\r\n      return undefined;\r\n    }\r\n\r\n    const overflow = [...currentData.primary.slice(-1), ...currentData.overflow];\r\n    const primary = currentData.primary.slice(0, -1);\r\n\r\n    let cacheKey = undefined;\r\n    if (this.state.cachingEnabled) {\r\n      cacheKey = computeCacheKey(primary);\r\n    }\r\n    return { primary, overflow, cacheKey };\r\n  };\r\n\r\n  private _onGrowData = (currentData: any): any => {\r\n    if (currentData.overflow.length === 0) {\r\n      return undefined;\r\n    }\r\n\r\n    const overflow = currentData.overflow.slice(1);\r\n    const primary = [...currentData.primary, ...currentData.overflow.slice(0, 1)];\r\n\r\n    let cacheKey = undefined;\r\n    if (this.state.cachingEnabled) {\r\n      cacheKey = computeCacheKey(primary);\r\n    }\r\n    return { primary, overflow, cacheKey };\r\n  };\r\n\r\n  private _onCachingEnabledChanged = (_: React.FormEvent<HTMLElement | HTMLInputElement>, checked: boolean): void => {\r\n    this.setState({ cachingEnabled: checked });\r\n  };\r\n\r\n  private _onGrowDataEnabledChanged = (_: React.FormEvent<HTMLElement | HTMLInputElement>, checked: boolean): void => {\r\n    this.setState({ onGrowDataEnabled: checked });\r\n  };\r\n\r\n  private _onButtonsCheckedChanged = (_: React.FormEvent<HTMLElement | HTMLInputElement>, checked: boolean): void => {\r\n    this.setState({ buttonsChecked: checked });\r\n  };\r\n\r\n  private _onNumberOfItemsChanged = (event: React.FormEvent<HTMLDivElement>, option: IDropdownOption): void => {\r\n    this.setState({ numberOfItems: parseInt(option.text, 10) });\r\n  };\r\n}\r\n"]}