{"version":3,"file":"GroupHeader.base.js","sourceRoot":"../src/","sources":["components/GroupedList/GroupHeader.base.tsx"],"names":[],"mappings":"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","sourcesContent":["import * as React from 'react';\r\nimport { classNamesFunction, IClassNames, getRTL } from '../../Utilities';\r\nimport { SelectionMode } from '../../utilities/selection/index';\r\nimport { Check } from '../../Check';\r\nimport { Icon } from '../../Icon';\r\nimport { GroupSpacer } from './GroupSpacer';\r\nimport { Spinner } from '../../Spinner';\r\nimport { FocusZone, FocusZoneDirection } from '../../FocusZone';\r\nimport { IGroupHeaderStyleProps, IGroupHeaderStyles, IGroupHeaderProps } from './GroupHeader.types';\r\n\r\nconst getClassNames = classNamesFunction<IGroupHeaderStyleProps, IGroupHeaderStyles>();\r\n\r\nexport interface IGroupHeaderState {\r\n  isCollapsed: boolean;\r\n  isLoadingVisible: boolean;\r\n}\r\n\r\nexport class GroupHeaderBase extends React.Component<IGroupHeaderProps, IGroupHeaderState> {\r\n  public static defaultProps: IGroupHeaderProps = {\r\n    expandButtonProps: { 'aria-label': 'expand collapse group' }\r\n  };\r\n\r\n  private _classNames: IClassNames<IGroupHeaderStyles>;\r\n\r\n  constructor(props: IGroupHeaderProps) {\r\n    super(props);\r\n\r\n    this.state = {\r\n      isCollapsed: (this.props.group && this.props.group.isCollapsed) as boolean,\r\n      isLoadingVisible: false\r\n    };\r\n  }\r\n\r\n  public componentWillReceiveProps(newProps: IGroupHeaderProps): void {\r\n    if (newProps.group) {\r\n      const newCollapsed = newProps.group.isCollapsed;\r\n      const isGroupLoading = newProps.isGroupLoading;\r\n      const newLoadingVisible = !newCollapsed && isGroupLoading && isGroupLoading(newProps.group);\r\n\r\n      this.setState({\r\n        isCollapsed: newCollapsed || false,\r\n        isLoadingVisible: newLoadingVisible || false\r\n      });\r\n    }\r\n  }\r\n\r\n  public render(): JSX.Element | null {\r\n    const {\r\n      group,\r\n      groupLevel,\r\n      viewport,\r\n      selectionMode,\r\n      loadingText,\r\n      isSelected,\r\n      selected,\r\n      indentWidth,\r\n      onRenderTitle = this._onRenderTitle,\r\n      isCollapsedGroupSelectVisible = true,\r\n      expandButtonProps,\r\n      selectAllButtonProps,\r\n      theme,\r\n      styles,\r\n      className,\r\n      groupedListId,\r\n      compact\r\n    } = this.props;\r\n\r\n    const { isCollapsed, isLoadingVisible } = this.state;\r\n\r\n    const canSelectGroup = selectionMode === SelectionMode.multiple;\r\n    const isSelectionCheckVisible = canSelectGroup && (isCollapsedGroupSelectVisible || !(group && group.isCollapsed));\r\n    const currentlySelected = isSelected || selected;\r\n\r\n    const isRTL = getRTL();\r\n\r\n    this._classNames = getClassNames(styles, {\r\n      theme: theme!,\r\n      className,\r\n      selected: currentlySelected,\r\n      isCollapsed,\r\n      compact\r\n    });\r\n\r\n    if (!group) {\r\n      return null;\r\n    }\r\n    return (\r\n      <div\r\n        className={this._classNames.root}\r\n        style={viewport ? { minWidth: viewport.width } : {}}\r\n        onClick={this._onHeaderClick}\r\n        aria-label={group.ariaLabel || group.name}\r\n        data-is-focusable={true}\r\n      >\r\n        <FocusZone className={this._classNames.groupHeaderContainer} direction={FocusZoneDirection.horizontal}>\r\n          {isSelectionCheckVisible ? (\r\n            <button\r\n              type=\"button\"\r\n              className={this._classNames.check}\r\n              role=\"checkbox\"\r\n              aria-checked={!!currentlySelected}\r\n              data-selection-toggle={true}\r\n              onClick={this._onToggleSelectGroupClick}\r\n              {...selectAllButtonProps}\r\n            >\r\n              <Check checked={currentlySelected} />\r\n            </button>\r\n          ) : (\r\n            selectionMode !== SelectionMode.none && <GroupSpacer indentWidth={indentWidth} count={1} />\r\n          )}\r\n\r\n          <GroupSpacer indentWidth={indentWidth} count={groupLevel!} />\r\n\r\n          <div className={this._classNames.dropIcon}>\r\n            <Icon iconName=\"Tag\" />\r\n          </div>\r\n          <button\r\n            type=\"button\"\r\n            className={this._classNames.expand}\r\n            onClick={this._onToggleCollapse}\r\n            aria-expanded={group ? !group.isCollapsed : undefined}\r\n            aria-controls={group && !group.isCollapsed ? groupedListId : undefined}\r\n            {...expandButtonProps}\r\n          >\r\n            <Icon className={this._classNames.expandIsCollapsed} iconName={isRTL ? 'ChevronLeftMed' : 'ChevronRightMed'} />\r\n          </button>\r\n\r\n          {onRenderTitle(this.props, this._onRenderTitle)}\r\n\r\n          {isLoadingVisible && <Spinner label={loadingText} />}\r\n        </FocusZone>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  private _onToggleCollapse = (ev: React.MouseEvent<HTMLElement>): void => {\r\n    const { group, onToggleCollapse, isGroupLoading } = this.props;\r\n    const { isCollapsed } = this.state;\r\n\r\n    const newCollapsed = !isCollapsed;\r\n    const newLoadingVisible = !newCollapsed && isGroupLoading && isGroupLoading(group!);\r\n\r\n    this.setState({\r\n      isCollapsed: newCollapsed,\r\n      isLoadingVisible: newLoadingVisible as boolean\r\n    });\r\n    if (onToggleCollapse) {\r\n      onToggleCollapse(group!);\r\n    }\r\n\r\n    ev.stopPropagation();\r\n    ev.preventDefault();\r\n  };\r\n\r\n  private _onToggleSelectGroupClick = (ev: React.MouseEvent<HTMLElement>): void => {\r\n    const { onToggleSelectGroup, group } = this.props;\r\n\r\n    if (onToggleSelectGroup) {\r\n      onToggleSelectGroup(group!);\r\n    }\r\n\r\n    ev.preventDefault();\r\n    ev.stopPropagation();\r\n  };\r\n\r\n  private _onHeaderClick = (): void => {\r\n    const { group, onGroupHeaderClick, onToggleSelectGroup } = this.props;\r\n\r\n    if (onGroupHeaderClick) {\r\n      onGroupHeaderClick(group!);\r\n    } else if (onToggleSelectGroup) {\r\n      onToggleSelectGroup(group!);\r\n    }\r\n  };\r\n\r\n  private _onRenderTitle = (props: IGroupHeaderProps): JSX.Element | null => {\r\n    const { group } = props;\r\n\r\n    if (!group) {\r\n      return null;\r\n    }\r\n\r\n    return (\r\n      <div className={this._classNames.title}>\r\n        <span>{group.name}</span>\r\n        {\r\n          // hasMoreData flag is set when grouping is throttled by SPO server which in turn resorts to regular\r\n          // sorting to simulate grouping behaviors, in which case group count is the number of items returned\r\n          // so far. That's the reason we need to use \"+\" to show we might have more items than count\r\n          // indicates.\r\n        }\r\n        <span className={this._classNames.headerCount}>\r\n          ({group.count}\r\n          {group.hasMoreData && '+'})\r\n        </span>\r\n      </div>\r\n    );\r\n  };\r\n}\r\n"]}